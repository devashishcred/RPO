using System;
using System.Collections.Generic;
using System.Data.Entity;
using System.IO;
using System.Linq;
using System.Web;
using iTextSharp.text.pdf;
using Rpo.ApiServices.Api.Controllers.JobDocument;
using Rpo.ApiServices.Api.Enums;
using Rpo.ApiServices.Model;
using Rpo.ApiServices.Model.Models;
using Dropbox.Api;
using Dropbox.Api.Files;

namespace Rpo.ApiServices.Api.Tools
{
    /// <summary>
    /// Class Generate Job Documents.
    /// </summary>
    public partial class GenerateJobDocuments
    {
        /// <summary>
        /// Generate10s the days notice.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.( 1> 10 Day Notice)</param>
        public static void Generate10DaysNotice(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO, int idEmployee, int idJob)
        {
            string documentName = string.Empty;
            string jobDocumentFor = string.Empty;
            string documentType = string.Empty;
            var companyValue = string.Empty;
            string recipient = string.Empty;
            RpoContext rpoContext = new RpoContext();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);

            var documentFieldList = rpoContext.DocumentFields.
                Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").Include("Contact").Include("Contacts.Contact").Include("Company").Include("RfpAddress.Borough").Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - 10DAYN-62395.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Date")
                        {
                            DateTime time = DateTime.Now;
                            string format = "MM/dd/yy";
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField jobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = time.ToString(format),
                                    ActualValue = time.ToString(format)
                                };
                                rpoContext.JobDocumentFields.Add(jobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = time.ToString(format);
                                updateJobDocumentField.ActualValue = time.ToString(format);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address")
                        {
                            string txtReValue = string.Empty;
                            if (job != null && job.RfpAddress != null)
                            {
                                txtReValue = job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street + System.Environment.NewLine + "Block :" + job.RfpAddress.Block + " Lot :" + job.RfpAddress.Lot;
                            }

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = txtReValue,
                                    ActualValue = txtReValue
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = txtReValue;
                                updateJobDocumentField.ActualValue = txtReValue;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Description")
                        {
                            int tenDaysNotice_Contractor = DocumentPlaceHolderField.TenDaysNotice_Contractor.GetHashCode();
                            var contractorValue = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == tenDaysNotice_Contractor).Value;

                            int contractorId = Convert.ToInt32(contractorValue == null ? "0" : contractorValue);
                            JobContact jobContact = job != null && job.Contacts != null ? job.Contacts.Where(x => x.Id == contractorId).FirstOrDefault() : null;

                            int tenDaysNotice_AddressAdjacent = DocumentPlaceHolderField.TenDaysNotice_AddressAdjacent.GetHashCode();
                            var addressAdjacent = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == tenDaysNotice_AddressAdjacent);

                            //var companyValue = string.Empty;
                            var contractorNameValue = string.Empty;


                            string addressAdjacentValue = addressAdjacent != null && !string.IsNullOrEmpty(addressAdjacent.Value) ? " adjacent to " + addressAdjacent.Value : string.Empty;

                            if (jobContact != null)
                            {
                                contractorNameValue = jobContact.Contact != null ? jobContact.Contact.FirstName + ' ' + jobContact.Contact.LastName : string.Empty;
                            }

                            if (job != null && job.Company != null)
                            {
                                companyValue = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;

                                //companyValue = job.Company.Name;
                            }
                            else
                            {
                                companyValue = "*Individual*";
                            }


                            string description = item.StaticDescription;
                            //description = description.Replace("##Contractor##", contractorNameValue);
                            description = description.Replace("##addressadjacent##", addressAdjacentValue);
                            description = description.Replace("##Company##", companyValue);

                            if (documentType == "Demolition")
                            {
                                description = description.Replace("##CalenderDay##", "ten (10) calendar days");
                                description = description.Replace("##DocumentType##", "Demolition");
                            }
                            else if (documentType == "Excavation")
                            {
                                description = description.Replace("##CalenderDay##", "five (5) calendar days");
                                description = description.Replace("##DocumentType##", "Excavation");
                            }

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.IdField),
                                    Value = description,
                                    ActualValue = description
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = description;
                                updateJobDocumentField.ActualValue = description;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "NameSignature")
                        {
                            string txtApplicantValue = string.Empty;
                            string consultantTo = string.Empty;

                            if (job != null && job.ProjectManager != null && job.Contact != null)
                            {
                                txtApplicantValue = job.ProjectManager.FirstName + ' ' + job.ProjectManager.LastName;
                            }

                            if (job != null && job.Company != null)
                            {
                                //consultantTo = job.Company.Name;
                                consultantTo = companyValue;
                            }
                            else
                            {
                                consultantTo = "*Individual*";
                            }

                            string NameSignatureValue = txtApplicantValue + ", Consultant to " + consultantTo;

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.IdField),
                                    Value = NameSignatureValue,
                                    ActualValue = NameSignatureValue
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = NameSignatureValue;
                                updateJobDocumentField.ActualValue = NameSignatureValue;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Phone")
                        {
                            string phoneValue = item.StaticDescription == null ? "" : item.StaticDescription;

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.IdField),
                                    Value = phoneValue,
                                    ActualValue = phoneValue
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = phoneValue;
                                updateJobDocumentField.ActualValue = phoneValue;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();

                    }
                    else
                    {

                        if (item.Field.FieldName == "Create Support Document")
                        {
                            if (frontendFields.Value != null && Convert.ToBoolean(frontendFields.Value))
                            {
                                GenerateSupportDocumentForTenDaysNotice(idJobDocument, idJob, idEmployee, documentName, jobDocument.IdJobApplication, recipient);
                            }
                        }

                        else if (item.Field.FieldName == "Adjacent Address (Optional - Maximum 64 Characters)")
                        {
                            string forvalues = frontendFields.Value;
                            documentName = documentName + (!String.IsNullOrEmpty(forvalues) ? " | For: " + forvalues : string.Empty);

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Application Type")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Recipient")
                        {
                            recipient = frontendFields.Value.Split('\n') != null && frontendFields.Value.Split('\n').Count() > 0 ? frontendFields.Value.Split('\n')[0] : string.Empty;
                            documentName = documentName + (!String.IsNullOrEmpty(recipient) ? " | To: " + recipient : string.Empty);

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Type")
                        {
                            int idType = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobDocumentType jobDocumentType = rpoContext.JobDocumentTypes.Where(x => x.Id == idType).FirstOrDefault();
                            documentType = jobDocumentType != null ? jobDocumentType.Type : string.Empty;
                            documentName = documentName + (jobDocumentType != null ? jobDocumentType.Type : string.Empty);
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idType),
                                    ActualValue = documentType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idType);
                                updateJobDocumentField.ActualValue = documentType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }

            // Generate Job Document
            jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            jobDocument.DocumentDescription = documentName;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();

            GenerateJobDocument(idJobDocument);
        }

        public static void Edit10DaysNotice(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO, int idEmployee, int idJob)
        {
            string documentName = string.Empty;
            string jobDocumentFor = string.Empty;
            string documentType = string.Empty;
            var companyValue = string.Empty;
            string recipient = string.Empty;
            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            RpoContext rpoContext = new RpoContext();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);

            var documentFieldList = rpoContext.DocumentFields.
                Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").Include("Contact").Include("Contacts.Contact").Include("Company").Include("RfpAddress.Borough").Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - 10DAYN-62395.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Date")
                        {
                            DateTime time = DateTime.Now;
                            string format = "MM/dd/yy";
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField jobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = time.ToString(format),
                                    ActualValue = time.ToString(format)
                                };
                                rpoContext.JobDocumentFields.Add(jobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = time.ToString(format);
                                updateJobDocumentField.ActualValue = time.ToString(format);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address")
                        {
                            string txtReValue = string.Empty;
                            if (job != null && job.RfpAddress != null)
                            {
                                txtReValue = job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street + System.Environment.NewLine + "Block :" + job.RfpAddress.Block + " Lot :" + job.RfpAddress.Lot;
                            }

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = txtReValue,
                                    ActualValue = txtReValue
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = txtReValue;
                                updateJobDocumentField.ActualValue = txtReValue;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Description")
                        {
                            int tenDaysNotice_Contractor = DocumentPlaceHolderField.TenDaysNotice_Contractor.GetHashCode();
                            var contractorValue = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == tenDaysNotice_Contractor).Value;

                            int contractorId = Convert.ToInt32(contractorValue == null ? "0" : contractorValue);
                            JobContact jobContact = job != null && job.Contacts != null ? job.Contacts.Where(x => x.Id == contractorId).FirstOrDefault() : null;

                            int tenDaysNotice_AddressAdjacent = DocumentPlaceHolderField.TenDaysNotice_AddressAdjacent.GetHashCode();
                            var addressAdjacent = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == tenDaysNotice_AddressAdjacent);

                            //var companyValue = string.Empty;
                            var contractorNameValue = string.Empty;


                            string addressAdjacentValue = addressAdjacent != null && !string.IsNullOrEmpty(addressAdjacent.Value) ? " adjacent to " + addressAdjacent.Value : string.Empty;

                            if (jobContact != null)
                            {
                                contractorNameValue = jobContact.Contact != null ? jobContact.Contact.FirstName + ' ' + jobContact.Contact.LastName : string.Empty;
                            }

                            if (job != null && job.Company != null)
                            {
                                companyValue = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;

                                //companyValue = job.Company.Name;
                            }
                            else
                            {
                                companyValue = "*Individual*";
                            }


                            string description = item.StaticDescription;
                            //description = description.Replace("##Contractor##", contractorNameValue);
                            description = description.Replace("##addressadjacent##", addressAdjacentValue);
                            description = description.Replace("##Company##", companyValue);

                            if (documentType == "Demolition")
                            {
                                description = description.Replace("##CalenderDay##", "ten (10) calendar days");
                                description = description.Replace("##DocumentType##", "Demolition");
                            }
                            else if (documentType == "Excavation")
                            {
                                description = description.Replace("##CalenderDay##", "five (5) calendar days");
                                description = description.Replace("##DocumentType##", "Excavation");
                            }

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.IdField),
                                    Value = description,
                                    ActualValue = description
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = description;
                                updateJobDocumentField.ActualValue = description;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "NameSignature")
                        {
                            string txtApplicantValue = string.Empty;
                            string consultantTo = string.Empty;

                            if (job != null && job.ProjectManager != null && job.Contact != null)
                            {
                                txtApplicantValue = job.ProjectManager.FirstName + ' ' + job.ProjectManager.LastName;
                            }

                            if (job != null && job.Company != null)
                            {
                                //consultantTo = job.Company.Name;
                                consultantTo = companyValue;
                            }
                            else
                            {
                                consultantTo = "*Individual*";
                            }

                            string NameSignatureValue = txtApplicantValue + ", Consultant to " + consultantTo;

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.IdField),
                                    Value = NameSignatureValue,
                                    ActualValue = NameSignatureValue
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = NameSignatureValue;
                                updateJobDocumentField.ActualValue = NameSignatureValue;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Phone")
                        {
                            string phoneValue = item.StaticDescription == null ? "" : item.StaticDescription;

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.IdField),
                                    Value = phoneValue,
                                    ActualValue = phoneValue
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = phoneValue;
                                updateJobDocumentField.ActualValue = phoneValue;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();

                    }
                    else
                    {

                        if (item.Field.FieldName == "Create Support Document")
                        {
                            if (frontendFields.Value != null && Convert.ToBoolean(frontendFields.Value))
                            {
                                GenerateSupportDocumentForTenDaysNotice(idJobDocument, idJob, idEmployee, documentName, jobDocument.IdJobApplication, recipient);
                            }
                        }

                        else if (item.Field.FieldName == "Adjacent Address (Optional - Maximum 64 Characters)")
                        {
                            string forvalues = frontendFields.Value;
                            documentName = documentName + (!String.IsNullOrEmpty(forvalues) ? " | For: " + forvalues : string.Empty);

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Application Type")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Recipient")
                        {
                            recipient = frontendFields.Value.Split('\n') != null && frontendFields.Value.Split('\n').Count() > 0 ? frontendFields.Value.Split('\n')[0] : string.Empty;
                            documentName = documentName + (!String.IsNullOrEmpty(recipient) ? " | To: " + recipient : string.Empty);

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Type")
                        {
                            int idType = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobDocumentType jobDocumentType = rpoContext.JobDocumentTypes.Where(x => x.Id == idType).FirstOrDefault();
                            documentType = jobDocumentType != null ? jobDocumentType.Type : string.Empty;
                            documentName = documentName + (jobDocumentType != null ? jobDocumentType.Type : string.Empty);
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idType),
                                    ActualValue = documentType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idType);
                                updateJobDocumentField.ActualValue = documentType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }

            // Edit Job Document
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            jobDocument.DocumentDescription = documentName;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }

        /// <summary>
        /// Generate10s the days notice scanned signed.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.</param>
        public static void Generate10DaysNoticeScannedSigned(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.
                Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                    }



                    if (item.Field.FieldName == "10 Day Notice")
                    {
                        int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                        int? idjobApplication = rpoContext.JobDocuments.Where(x => x.Id == idJobApplication).Select(x => x.IdJobApplication).FirstOrDefault();
                        JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idjobApplication).FirstOrDefault();
                        JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                        string jobDescription = rpoContext.JobDocuments.Where(x => x.Id == idJobApplication).Select(x => x.DocumentDescription).FirstOrDefault();
                        // idjobApplication = jobApplication != null ? Convert.ToInt32(jobApplication.ApplicationNumber) : 0;
                        jobDocument.IdJobApplication = idjobApplication;
                        jobDocument.DocumentDescription = jobDescription;
                        if (updateJobDocumentField == null)
                        {
                            JobDocumentField JobDocumentField = new JobDocumentField
                            {
                                IdJobDocument = idJobDocument,
                                IdDocumentField = frontendFields.IdDocumentField,
                                Value = Convert.ToString(frontendFields.Value),
                                ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty
                            };
                            rpoContext.JobDocumentFields.Add(JobDocumentField);
                            rpoContext.SaveChanges();
                        }
                        else
                        {
                            updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                            updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                            rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                            rpoContext.SaveChanges();
                        }
                        //if (updateJobDocumentField == null)
                        //{
                        //    JobDocumentField JobDocumentField = new JobDocumentField
                        //    {
                        //        IdJobDocument = idJobDocument,
                        //        IdDocumentField = frontendFields.IdDocumentField,
                        //        Value = Convert.ToString(idJobApplication),
                        //        ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty
                        //    };
                        //    rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    rpoContext.SaveChanges();
                        //}
                        //else
                        //{
                        //    updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                        //    updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                        //    rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //    rpoContext.SaveChanges();
                        //}
                    }
                    else
                    {
                        JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                        if (updateJobDocumentField == null)
                        {
                            JobDocumentField JobDocumentField = new JobDocumentField
                            {
                                IdJobDocument = idJobDocument,
                                IdDocumentField = frontendFields.IdDocumentField,
                                Value = frontendFields.Value,
                                ActualValue = frontendFields.Value
                            };
                            rpoContext.JobDocumentFields.Add(JobDocumentField);
                            rpoContext.SaveChanges();
                        }
                        else
                        {
                            updateJobDocumentField.Value = frontendFields.Value;
                            updateJobDocumentField.ActualValue = frontendFields.Value;
                            rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                            rpoContext.SaveChanges();
                        }
                    }
                }
            }
        }

        /// <summary>
        /// Generates the dot contact award letter.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.</param>
        public static void GenerateDOTContactAwardLetter(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.
                Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                    }
                    else
                    {
                        JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                        if (updateJobDocumentField == null)
                        {
                            JobDocumentField JobDocumentField = new JobDocumentField
                            {
                                IdJobDocument = idJobDocument,
                                IdDocumentField = frontendFields.IdDocumentField,
                                Value = frontendFields.Value,
                                ActualValue = frontendFields.Value
                            };
                            rpoContext.JobDocumentFields.Add(JobDocumentField);
                            rpoContext.SaveChanges();
                        }
                        else
                        {
                            updateJobDocumentField.Value = frontendFields.Value;
                            updateJobDocumentField.ActualValue = frontendFields.Value;
                            rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                            rpoContext.SaveChanges();
                        }
                    }
                }
            }
        }

        /// <summary>
        /// Generates the technical report form t r5.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.</param>
        public static void GenerateTechnicalReportFormTR5(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.
                Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;


            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                   Include("Contact.ContactTitle").
                   Include("RfpAddress.Borough").
                   Include("Company.Addresses.AddressType").
                   Include("Company.Addresses.State")
                   .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();


                string firstName = string.Empty;
                string middName = string.Empty;
                string fullName = string.Empty;
                string businessCompanyName = string.Empty;
                string businessPhone = string.Empty;
                string businessAddress = string.Empty;
                string businessFax = string.Empty;
                string businessCity = string.Empty;
                string businessState = string.Empty;
                string businessZip = string.Empty;
                string contactMobilePhone = string.Empty;
                string contactEmail = string.Empty;
                string engineerLicenseType = "0";
                string licenseName = string.Empty;
                string architectLicenseType = "0";
                string registeredLandscapeArchitect = string.Empty;
                string lastName = string.Empty;

                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "topmostSubform[0].Page1[0].Name[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fullName,
                                    ActualValue = fullName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = fullName;
                                updateJobDocumentField.ActualValue = fullName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].House_No[0]")
                        {
                            string houseNumber = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = houseNumber,
                                    ActualValue = houseNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = houseNumber;
                                updateJobDocumentField.ActualValue = houseNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].Street_Name[0]")
                        {
                            string street = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = street,
                                    ActualValue = street
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = street;
                                updateJobDocumentField.ActualValue = street;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].Borough[0]")
                        {
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].Block[0]")
                        {
                            string block = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = block,
                                    ActualValue = block
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = block;
                                updateJobDocumentField.ActualValue = block;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].Lot[0]")
                        {
                            string lot = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lot,
                                    ActualValue = lot
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = lot;
                                updateJobDocumentField.ActualValue = lot;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].BIN[0]")
                        {
                            string binNumber = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = binNumber,
                                    ActualValue = binNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = binNumber;
                                updateJobDocumentField.ActualValue = binNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].CB_No[0]")
                        {
                            string comunityBoardNumber = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = comunityBoardNumber,
                                    ActualValue = comunityBoardNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = comunityBoardNumber;
                                updateJobDocumentField.ActualValue = comunityBoardNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].App_L_Name[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lastName,
                                    ActualValue = lastName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = lastName;
                                updateJobDocumentField.ActualValue = lastName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].PD_F_Name[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = firstName,
                                    ActualValue = firstName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = firstName;
                                updateJobDocumentField.ActualValue = firstName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].PD_M_I[0]")
                        {
                            if (middName != null)
                            {
                                if (middName.Length > 1)
                                {
                                    middName = middName.Substring(0, 1);
                                }
                                else
                                {
                                    middName = string.Empty;
                                }
                            }
                            else
                            {
                                middName = string.Empty;
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = middName,
                                    ActualValue = middName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = middName;
                                updateJobDocumentField.ActualValue = middName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].PD_Bus_Name[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessCompanyName,
                                    ActualValue = businessCompanyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = businessCompanyName;
                                updateJobDocumentField.ActualValue = businessCompanyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].PD_Bus_Telephone[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessPhone,
                                    ActualValue = businessPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = businessPhone;
                                updateJobDocumentField.ActualValue = businessPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].PD_Bus_Address[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessAddress,
                                    ActualValue = businessAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = businessAddress;
                                updateJobDocumentField.ActualValue = businessAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].PD_Bus_Fax[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessFax,
                                    ActualValue = businessFax
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = businessFax;
                                updateJobDocumentField.ActualValue = businessFax;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].PD_Bus_City[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessCity,
                                    ActualValue = businessCity
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = businessCity;
                                updateJobDocumentField.ActualValue = businessCity;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].PD_Bus_State[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessState,
                                    ActualValue = businessState
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = businessState;
                                updateJobDocumentField.ActualValue = businessState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].PD_Bus_Zipcode[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessZip,
                                    ActualValue = businessZip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = businessZip;
                                updateJobDocumentField.ActualValue = businessZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].PD_Bus_Mobile_Telephone[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = contactMobilePhone,
                                    ActualValue = contactMobilePhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = contactMobilePhone;
                                updateJobDocumentField.ActualValue = contactMobilePhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].Email[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = contactEmail,
                                    ActualValue = contactEmail
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = contactEmail;
                                updateJobDocumentField.ActualValue = contactEmail;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].Lic_No[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = licenseName,
                                    ActualValue = licenseName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = licenseName;
                                updateJobDocumentField.ActualValue = licenseName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].DateTimeField1[0] ")
                        {
                            DateTime time = DateTime.Now;
                            string format = "MM/dd/yy";
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].RA[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = architectLicenseType,
                                    ActualValue = architectLicenseType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = architectLicenseType;
                                updateJobDocumentField.ActualValue = architectLicenseType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].PE[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = engineerLicenseType,
                                    ActualValue = engineerLicenseType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = engineerLicenseType;
                                updateJobDocumentField.ActualValue = engineerLicenseType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }




                    }
                    else
                    {

                        if (item.Field.FieldName == "Application Type")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Applicant")
                        {
                            int Certifierid = Convert.ToInt32(frontendFields.Value);

                            JobContact jobContact = rpoContext.JobContacts.Where(x => x.Id == Certifierid).FirstOrDefault();
                            lastName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.LastName : string.Empty;
                            firstName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName : string.Empty;
                            middName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MiddleName : string.Empty;

                            fullName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;

                            Address compnayAddress = Common.GetContactAddressForJobDocument(jobContact);
                            businessCompanyName = jobContact != null && jobContact.Company != null ? jobContact.Company.Name : string.Empty;
                            businessPhone = Common.GetContactPhoneNumberForJobDocument(jobContact);
                            businessAddress = compnayAddress != null ? compnayAddress.Address1 + " " + compnayAddress.Address2 : string.Empty;
                            businessFax = string.Empty;
                            businessCity = compnayAddress != null ? compnayAddress.City : string.Empty;
                            businessState = compnayAddress != null && compnayAddress.State != null ? compnayAddress.State.Acronym : string.Empty;
                            businessZip = compnayAddress != null ? compnayAddress.ZipCode : string.Empty;
                            contactMobilePhone = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MobilePhone : string.Empty;
                            contactEmail = jobContact != null ? jobContact.Contact.Email : string.Empty;



                            string licenceTypeNumber = string.Empty;

                            var test = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                                 jobContact.Contact.ContactLicenses.Select(x => x).ToList() : null;
                            string permitTypecode = string.Empty;
                            string test1 = string.Empty;
                            if (test != null)
                            {
                                foreach (var item1 in test)
                                {

                                    permitTypecode += item1.ContactLicenseType != null ? item1.ContactLicenseType.Name + "," : string.Empty;

                                }
                            }
                            string[] permitTypecodeArr = new string[20];
                            permitTypecodeArr = permitTypecode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("Engineer"));

                            if (permitTypecodeArr.Contains("Engineer"))
                            {
                                string licenceTypeNumber1 = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            jobContact.Contact.ContactLicenses.Where(x => x.ContactLicenseType.Name == "Engineer").Select(x => x.Number).FirstOrDefault() : string.Empty;
                                engineerLicenseType = "1";
                                licenseName = licenceTypeNumber1;
                            }
                            else if (permitTypecodeArr.Contains("Architect"))
                            {
                                string licenceTypeNumber1 = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            jobContact.Contact.ContactLicenses.Where(x => x.ContactLicenseType.Name == "Architect").Select(x => x.Number).FirstOrDefault() : string.Empty;
                                architectLicenseType = "1";
                                licenseName = licenceTypeNumber1;
                            }


                            //string licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            //jobContact.Contact.ContactLicenses.Select(x => x.Number).FirstOrDefault() : string.Empty;
                            //if (!string.IsNullOrEmpty(licenceTypeNumber))
                            //{
                            //    ContactLicense contactLicenseType = rpoContext.ContactLicenses.Where(a => a.Number == licenceTypeNumber).FirstOrDefault();
                            //    ContactLicenseType LicenseType = rpoContext.ContactLicenseTypes.Where(b => b.Id == contactLicenseType.IdContactLicenseType).FirstOrDefault();
                            //    if (LicenseType.Name.ToLower() == ("Engineer").ToLower())
                            //    {
                            //        engineerLicenseType = "1";
                            //        licenseName = licenceTypeNumber;
                            //    }
                            //    else if (LicenseType.Name.ToLower() == ("Architect").ToLower())
                            //    {
                            //        architectLicenseType = "1";
                            //        licenseName = licenceTypeNumber;
                            //    }

                            //}
                            //else
                            //{
                            //    licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            //    jobContact.Contact.ContactLicenses.Select(x => x.ContactLicenseType.Name).FirstOrDefault() : string.Empty;

                            //    if (licenceTypeNumber.ToLower() == ("Engineer").ToLower())
                            //    {
                            //        engineerLicenseType = "1";
                            //    }
                            //    else if (licenceTypeNumber.ToLower() == ("Architect").ToLower())
                            //    {
                            //        architectLicenseType = "1";
                            //    }
                            //    else if (licenceTypeNumber.ToLower() == ("Registered Landscape Architect").ToLower())
                            //    {
                            //        registeredLandscapeArchitect = "Yes";
                            //    }
                            //}


                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(fullName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(fullName) ? "Applicant: " + fullName : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = lastName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);

                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = lastName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateJobDocument(idJobDocument);
        }

        public static void EditTechnicalReportFormTR5(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.
                Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;


            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                   Include("Contact.ContactTitle").
                   Include("RfpAddress.Borough").
                   Include("Company.Addresses.AddressType").
                   Include("Company.Addresses.State")
                   .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();


                string firstName = string.Empty;
                string middName = string.Empty;
                string fullName = string.Empty;
                string businessCompanyName = string.Empty;
                string businessPhone = string.Empty;
                string businessAddress = string.Empty;
                string businessFax = string.Empty;
                string businessCity = string.Empty;
                string businessState = string.Empty;
                string businessZip = string.Empty;
                string contactMobilePhone = string.Empty;
                string contactEmail = string.Empty;
                string engineerLicenseType = "0";
                string licenseName = string.Empty;
                string architectLicenseType = "0";
                string registeredLandscapeArchitect = string.Empty;
                string lastName = string.Empty;

                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "topmostSubform[0].Page1[0].Name[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fullName,
                                    ActualValue = fullName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = fullName;
                                updateJobDocumentField.ActualValue = fullName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].House_No[0]")
                        {
                            string houseNumber = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = houseNumber,
                                    ActualValue = houseNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = houseNumber;
                                updateJobDocumentField.ActualValue = houseNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].Street_Name[0]")
                        {
                            string street = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = street,
                                    ActualValue = street
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = street;
                                updateJobDocumentField.ActualValue = street;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].Borough[0]")
                        {
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].Block[0]")
                        {
                            string block = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = block,
                                    ActualValue = block
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = block;
                                updateJobDocumentField.ActualValue = block;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].Lot[0]")
                        {
                            string lot = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lot,
                                    ActualValue = lot
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = lot;
                                updateJobDocumentField.ActualValue = lot;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].BIN[0]")
                        {
                            string binNumber = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = binNumber,
                                    ActualValue = binNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = binNumber;
                                updateJobDocumentField.ActualValue = binNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].CB_No[0]")
                        {
                            string comunityBoardNumber = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = comunityBoardNumber,
                                    ActualValue = comunityBoardNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = comunityBoardNumber;
                                updateJobDocumentField.ActualValue = comunityBoardNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].App_L_Name[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lastName,
                                    ActualValue = lastName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = lastName;
                                updateJobDocumentField.ActualValue = lastName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].PD_F_Name[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = firstName,
                                    ActualValue = firstName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = firstName;
                                updateJobDocumentField.ActualValue = firstName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].PD_M_I[0]")
                        {
                            if (middName != null)
                            {
                                if (middName.Length > 1)
                                {
                                    middName = middName.Substring(0, 1);
                                }
                                else
                                {
                                    middName = string.Empty;
                                }
                            }
                            else
                            {
                                middName = string.Empty;
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = middName,
                                    ActualValue = middName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = middName;
                                updateJobDocumentField.ActualValue = middName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].PD_Bus_Name[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessCompanyName,
                                    ActualValue = businessCompanyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = businessCompanyName;
                                updateJobDocumentField.ActualValue = businessCompanyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].PD_Bus_Telephone[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessPhone,
                                    ActualValue = businessPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = businessPhone;
                                updateJobDocumentField.ActualValue = businessPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].PD_Bus_Address[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessAddress,
                                    ActualValue = businessAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = businessAddress;
                                updateJobDocumentField.ActualValue = businessAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].PD_Bus_Fax[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessFax,
                                    ActualValue = businessFax
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = businessFax;
                                updateJobDocumentField.ActualValue = businessFax;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].PD_Bus_City[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessCity,
                                    ActualValue = businessCity
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = businessCity;
                                updateJobDocumentField.ActualValue = businessCity;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].PD_Bus_State[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessState,
                                    ActualValue = businessState
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = businessState;
                                updateJobDocumentField.ActualValue = businessState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].PD_Bus_Zipcode[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessZip,
                                    ActualValue = businessZip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = businessZip;
                                updateJobDocumentField.ActualValue = businessZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].PD_Bus_Mobile_Telephone[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = contactMobilePhone,
                                    ActualValue = contactMobilePhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = contactMobilePhone;
                                updateJobDocumentField.ActualValue = contactMobilePhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].Email[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = contactEmail,
                                    ActualValue = contactEmail
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = contactEmail;
                                updateJobDocumentField.ActualValue = contactEmail;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].Lic_No[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = licenseName,
                                    ActualValue = licenseName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = licenseName;
                                updateJobDocumentField.ActualValue = licenseName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].RA[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = architectLicenseType,
                                    ActualValue = architectLicenseType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = architectLicenseType;
                                updateJobDocumentField.ActualValue = architectLicenseType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "topmostSubform[0].Page1[0].PE[0]")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = engineerLicenseType,
                                    ActualValue = engineerLicenseType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = engineerLicenseType;
                                updateJobDocumentField.ActualValue = engineerLicenseType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }




                    }
                    else
                    {

                        if (item.Field.FieldName == "Application Type")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Applicant")
                        {
                            int Certifierid = Convert.ToInt32(frontendFields.Value);

                            JobContact jobContact = rpoContext.JobContacts.Where(x => x.Id == Certifierid).FirstOrDefault();
                            lastName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.LastName : string.Empty;
                            firstName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName : string.Empty;
                            middName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MiddleName : string.Empty;

                            fullName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;

                            Address compnayAddress = Common.GetContactAddressForJobDocument(jobContact);
                            businessCompanyName = jobContact != null && jobContact.Company != null ? jobContact.Company.Name : string.Empty;
                            businessPhone = Common.GetContactPhoneNumberForJobDocument(jobContact);
                            businessAddress = compnayAddress != null ? compnayAddress.Address1 + " " + compnayAddress.Address2 : string.Empty;
                            businessFax = string.Empty;
                            businessCity = compnayAddress != null ? compnayAddress.City : string.Empty;
                            businessState = compnayAddress != null && compnayAddress.State != null ? compnayAddress.State.Acronym : string.Empty;
                            businessZip = compnayAddress != null ? compnayAddress.ZipCode : string.Empty;
                            contactMobilePhone = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MobilePhone : string.Empty;
                            contactEmail = jobContact != null ? jobContact.Contact.Email : string.Empty;



                            string licenceTypeNumber = string.Empty;

                            var test = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                                 jobContact.Contact.ContactLicenses.Select(x => x).ToList() : null;
                            string permitTypecode = string.Empty;
                            string test1 = string.Empty;
                            if (test != null)
                            {
                                foreach (var item1 in test)
                                {

                                    permitTypecode += item1.ContactLicenseType != null ? item1.ContactLicenseType.Name + "," : string.Empty;

                                }
                            }
                            string[] permitTypecodeArr = new string[20];
                            permitTypecodeArr = permitTypecode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("Engineer"));

                            if (permitTypecodeArr.Contains("Engineer"))
                            {
                                string licenceTypeNumber1 = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            jobContact.Contact.ContactLicenses.Where(x => x.ContactLicenseType.Name == "Engineer").Select(x => x.Number).FirstOrDefault() : string.Empty;
                                engineerLicenseType = "1";
                                licenseName = licenceTypeNumber1;
                            }
                            else if (permitTypecodeArr.Contains("Architect"))
                            {
                                string licenceTypeNumber1 = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            jobContact.Contact.ContactLicenses.Where(x => x.ContactLicenseType.Name == "Architect").Select(x => x.Number).FirstOrDefault() : string.Empty;
                                architectLicenseType = "1";
                                licenseName = licenceTypeNumber1;
                            }


                            //string licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            //jobContact.Contact.ContactLicenses.Select(x => x.Number).FirstOrDefault() : string.Empty;
                            //if (!string.IsNullOrEmpty(licenceTypeNumber))
                            //{
                            //    ContactLicense contactLicenseType = rpoContext.ContactLicenses.Where(a => a.Number == licenceTypeNumber).FirstOrDefault();
                            //    ContactLicenseType LicenseType = rpoContext.ContactLicenseTypes.Where(b => b.Id == contactLicenseType.IdContactLicenseType).FirstOrDefault();
                            //    if (LicenseType.Name.ToLower() == ("Engineer").ToLower())
                            //    {
                            //        engineerLicenseType = "1";
                            //        licenseName = licenceTypeNumber;
                            //    }
                            //    else if (LicenseType.Name.ToLower() == ("Architect").ToLower())
                            //    {
                            //        architectLicenseType = "1";
                            //        licenseName = licenceTypeNumber;
                            //    }

                            //}
                            //else
                            //{
                            //    licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            //    jobContact.Contact.ContactLicenses.Select(x => x.ContactLicenseType.Name).FirstOrDefault() : string.Empty;

                            //    if (licenceTypeNumber.ToLower() == ("Engineer").ToLower())
                            //    {
                            //        engineerLicenseType = "1";
                            //    }
                            //    else if (licenceTypeNumber.ToLower() == ("Architect").ToLower())
                            //    {
                            //        architectLicenseType = "1";
                            //    }
                            //    else if (licenceTypeNumber.ToLower() == ("Registered Landscape Architect").ToLower())
                            //    {
                            //        registeredLandscapeArchitect = "Yes";
                            //    }
                            //}


                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(fullName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(fullName) ? "Applicant: " + fullName : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = lastName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);

                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = lastName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }

        /// <summary>
        /// Generates the dot contact notice to proceed.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.</param>
        public static void GenerateDOTContactNoticeToProceed(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.
                Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                    }
                    else
                    {
                        JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                        if (updateJobDocumentField == null)
                        {
                            JobDocumentField JobDocumentField = new JobDocumentField
                            {
                                IdJobDocument = idJobDocument,
                                IdDocumentField = frontendFields.IdDocumentField,
                                Value = frontendFields.Value,
                                ActualValue = frontendFields.Value
                            };
                            rpoContext.JobDocumentFields.Add(JobDocumentField);
                            rpoContext.SaveChanges();
                        }
                        else
                        {
                            updateJobDocumentField.Value = frontendFields.Value;
                            updateJobDocumentField.ActualValue = frontendFields.Value;
                            rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                            rpoContext.SaveChanges();
                        }
                    }
                }
            }
        }

        /// <summary>
        /// Generates the dotocmc stipulation sheet.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.</param>
        public static void GenerateDOTOCMCStipulationSheet(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.
                Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                    }
                    else
                    {
                        JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                        if (updateJobDocumentField == null)
                        {
                            JobDocumentField JobDocumentField = new JobDocumentField
                            {
                                IdJobDocument = idJobDocument,
                                IdDocumentField = frontendFields.IdDocumentField,
                                Value = frontendFields.Value,
                                ActualValue = frontendFields.Value
                            };
                            rpoContext.JobDocumentFields.Add(JobDocumentField);
                            rpoContext.SaveChanges();
                        }
                        else
                        {
                            updateJobDocumentField.Value = frontendFields.Value;
                            updateJobDocumentField.ActualValue = frontendFields.Value;
                            rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                            rpoContext.SaveChanges();
                        }
                    }
                }
            }
        }

        public static void GenerateDOTPermitExpirationReport(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.
                Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                    }
                    else
                    {
                        if (item.Field.FieldName == "Additional Description")
                        {
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(frontendFields.Value) ? " | " : string.Empty) + (!string.IsNullOrEmpty(frontendFields.Value) ? "Optional Description: " + frontendFields.Value : string.Empty);
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
        }

        /// <summary>
        /// Generates the builder pavement application.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.</param>
        public static void GenerateBuilderPavementApplication(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contacts").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                string applicationNo = string.Empty;
                string trackingNo = string.Empty;
                string propertyApplicant = string.Empty;
                string ownerAddress = string.Empty;
                string ownerCityZip = string.Empty;
                string ownName = string.Empty;
                string ownerCompany = string.Empty;
                string applicantAddress = string.Empty;
                string applicantCityZip = string.Empty;
                string applicantPhone = string.Empty;

                string optType = string.Empty;

                string fee = string.Empty;
                string linearFeet = string.Empty;

                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);

                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - BPA-62436.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "optType")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = optType,
                                    ActualValue = optType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = optType;
                                updateJobDocumentField.ActualValue = optType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "Address")
                        {
                            string addressDetails = job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = addressDetails,
                                    ActualValue = addressDetails

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = addressDetails;
                                updateJobDocumentField.ActualValue = addressDetails;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Borough")
                        {
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Block")
                        {
                            string block = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = block,
                                    ActualValue = block

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = block;
                                updateJobDocumentField.ActualValue = block;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            string lot = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lot,
                                    ActualValue = lot

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = lot;
                                updateJobDocumentField.ActualValue = lot;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "LDN")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner_Name")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownName + " - " + ownerCompany,
                                    ActualValue = ownName + " - " + ownerCompany

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownName + " - " + ownerCompany;
                                updateJobDocumentField.ActualValue = ownName + " - " + ownerCompany;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner_Address")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerAddress,
                                    ActualValue = ownerAddress

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerAddress;
                                updateJobDocumentField.ActualValue = ownerAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner_CSZ")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerCityZip,
                                    ActualValue = ownerCityZip

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerCityZip;
                                updateJobDocumentField.ActualValue = ownerCityZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "optPC")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "AppNo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicationNo,
                                    ActualValue = applicationNo

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicationNo;
                                updateJobDocumentField.ActualValue = applicationNo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "HAppNo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = trackingNo,
                                    ActualValue = trackingNo

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = trackingNo;
                                updateJobDocumentField.ActualValue = trackingNo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Rate")
                        {
                            double rate = Convert.ToDouble(fee) * Convert.ToDouble(linearFeet);
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = rate.ToString(),
                                    ActualValue = rate.ToString()

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = rate.ToString();
                                updateJobDocumentField.ActualValue = rate.ToString();
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Applicant_Address")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantAddress,
                                    ActualValue = applicantAddress

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantAddress;
                                updateJobDocumentField.ActualValue = applicantAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Applicant_CSZ")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCityZip,
                                    ActualValue = applicantCityZip

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCityZip;
                                updateJobDocumentField.ActualValue = applicantCityZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Applicant_Phone")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantPhone,
                                    ActualValue = applicantPhone

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantPhone;
                                updateJobDocumentField.ActualValue = applicantPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();

                    }
                    else
                    {
                        if (item.Field.FieldName == "Applicant")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.Include("Contact.Company.Addresses.AddressType").Include("Contact.Addresses.AddressType").FirstOrDefault(x => x.Id == applicantId);
                            propertyApplicant = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName + " - " + (jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty) : string.Empty;

                            Address jobContactAddress = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;
                            if (jobContactAddress == null)
                            {
                                jobContactAddress = jobContact.Contact.Addresses.FirstOrDefault(x => x.IsMainAddress == true);
                            }

                            applicantAddress = jobContactAddress != null ? jobContactAddress.Address1 + " " + jobContactAddress.Address2 : string.Empty;
                            applicantCityZip = jobContactAddress != null ? jobContactAddress.City + (jobContactAddress.State != null ? " " + jobContactAddress.State.Acronym : string.Empty) + " " + jobContactAddress.ZipCode : string.Empty;
                            string WorkPhone = jobContact != null && jobContact.Contact != null ? jobContact.Contact.WorkPhone : string.Empty;
                            if (WorkPhone != null || WorkPhone != "")
                            {
                                applicantPhone = WorkPhone + " -" + jobContact.Contact.WorkPhoneExt;
                            }
                            else { applicantPhone = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MobilePhone : string.Empty; }

                            Contact owner = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact : null;
                            Address owddress = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Addresses != null ? job.RfpAddress.OwnerContact.Addresses.FirstOrDefault(x => x.IsMainAddress == true) : null;

                            ownName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty;

                            ownerAddress = owddress != null ? owddress.Address1 + " " + owddress.Address2 : string.Empty;
                            ownerCityZip = owddress != null ? owddress.City + (owddress.State != null ? " " + owddress.State.Acronym : string.Empty) + " " + owddress.ZipCode : string.Empty;

                            ownerCompany = owner != null && owner.Company != null ? owner.Company.Name : string.Empty;


                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(applicantId),
                                    ActualValue = propertyApplicant
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(applicantId);
                                updateJobDocumentField.ActualValue = propertyApplicant;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Application Type")
                        {

                            int applicantionId = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplications = rpoContext.JobApplications.Include("JobApplicationType").FirstOrDefault(x => x.Id == applicantionId);

                            if (jobApplications != null && jobApplications.JobApplicationType != null && jobApplications.JobApplicationType.IdParent == ApplicationType.DOT.GetHashCode())
                            {
                                trackingNo = jobApplications.ApplicationNumber;
                            }
                            else
                            {
                                applicationNo = jobApplications.ApplicationNumber;
                            }

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(applicantionId),
                                    ActualValue = applicationNo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(applicantionId);
                                updateJobDocumentField.ActualValue = applicationNo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Type")
                        {
                            int applicantionId = Convert.ToInt32(frontendFields.Value);
                            JobDocumentType jobDocumentType = rpoContext.JobDocumentTypes.FirstOrDefault(x => x.Id == applicantionId);

                            documentDescription = documentDescription + (jobDocumentType != null ? jobDocumentType.Type + " " : string.Empty);

                            if (jobDocumentType != null && jobDocumentType.Type.ToLower() == "Certification for C of O".ToLower())
                            {
                                optType = "Yes";
                            }
                            if (jobDocumentType != null && jobDocumentType.Type.ToLower() == "Distinctive SideWalk only".ToLower())
                            {
                                optType = "Yes";
                            }


                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "LinearFeet")
                        {
                            linearFeet = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Fee")
                        {
                            fee = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }

            // Generate Job Document
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();

            GenerateJobDocument(idJobDocument);
        }

        /// <summary>
        /// Generates the drawings.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.</param>
        public static void GenerateDrawings(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.
                Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int idApplication = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idApplication).FirstOrDefault();

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idApplication),
                                    ActualValue = jobApplication.ApplicationNumber,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idApplication);
                                updateJobDocumentField.ActualValue = jobApplication.ApplicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                            rpoContext.SaveChanges();
                        }
                        else if (item.Field.FieldName == "Additional Description")
                        {
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(frontendFields.Value) ? " | " : string.Empty) + (!string.IsNullOrEmpty(frontendFields.Value) ? "Additional Description: " + frontendFields.Value : string.Empty);
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }


                        else if (item.Field.FieldName == "DOT Work Type(s)")
                        {
                            // int idJobworkpermitType = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string workTypes = frontendFields.Value;
                            List<int> workTypesLst = !string.IsNullOrEmpty(workTypes) ? (workTypes.Split(',') != null && workTypes.Split(',').Any() ? workTypes.Split(',').Select(x => int.Parse(x)).ToList() : new List<int>()) : new List<int>();

                            string permitType = string.Empty;
                            string permitTypeCode = string.Empty;
                            string[] permitTypecodeArr = new string[5];
                            var jobApplicationWorkPermitType = rpoContext.JobApplicationWorkPermitTypes
                                                                        .Include("JobWorkType")
                                                                        .Where(x => workTypesLst.Contains(x.Id))
                                                                        .Select(x => new
                                                                        {
                                                                            Permittype = x.PermitType != null && x.PermitType != "" ? x.PermitType : x.JobWorkType.Description,
                                                                            PermitTypeCode = x.Code,
                                                                            Fees = x.PermitType != null && x.PermitType != "" ? x.RenewalFee : x.EstimatedCost
                                                                        }).ToList();

                            permitType = jobApplicationWorkPermitType != null ? String.Join(",", jobApplicationWorkPermitType.Select(x => x.Permittype)) : string.Empty;
                            permitTypeCode = jobApplicationWorkPermitType != null ? String.Join(",", jobApplicationWorkPermitType.Select(x => x.PermitTypeCode)) : string.Empty;

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(permitType) ? "Work Type(s): " + permitType : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = workTypes,
                                    ActualValue = permitType,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = workTypes;
                                updateJobDocumentField.ActualValue = permitType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }

                }
            }
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            //GenerateJobDocument(idJobDocument);
        }

        /// <summary>
        /// Generates the miscellaneous.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.</param>
        public static void GenerateMiscellaneous(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.
                Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            string documentName = string.Empty;
            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = idJobApplication != 0 ? Convert.ToString(idJobApplication) : null,
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = idJobApplication != 0 ? Convert.ToString(idJobApplication) : null;
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Additional Description")
                        {
                            documentDescription = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }

                }
                jobDocument.DocumentDescription = documentDescription;
                jobDocument.JobDocumentFor = jobDocumentFor;
                rpoContext.SaveChanges();
            }
        }

        /// <summary>
        /// Generates the asbestos assessment report.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.</param>
        public static void GenerateAsbestosAssessmentReport(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.
                Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;

                            jobDocument.IdJobApplication = idJobApplication;
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }

            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
        }

        /// <summary>
        /// Container Information Form
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.(28> Container Information Form)</param>
        public static void GenerateRequestforContainerInformationForm(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
               Where(x => x.IdJobDocument == idJobDocument).ToList();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                JobContact jobContact = new JobContact();
                JobApplication jobApplication = new JobApplication();
                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            string jobFileInfo = job != null ? job.JobNumber + " - CIF-81360.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "JobNumber")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty,
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "Applicant_Address")
                        {
                            var AddressofOwner = Common.GetContactAddressForJobDocument(jobContact);
                            //jobContact != null && jobContact.Contact != null && jobContact.Contact.Addresses != null ? jobContact.Contact.Addresses.FirstOrDefault(x => x.IsMainAddress == true) : null;


                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = AddressofOwner != null ? AddressofOwner.Address1 + " " + AddressofOwner.Address2 + " " + AddressofOwner.City + " " + (AddressofOwner.State != null ? AddressofOwner.State.Acronym : string.Empty) + " " + AddressofOwner.ZipCode : string.Empty,
                                    ActualValue = AddressofOwner != null ? AddressofOwner.Address1 + " " + AddressofOwner.Address2 + " " + AddressofOwner.City + " " + (AddressofOwner.State != null ? AddressofOwner.State.Acronym : string.Empty) + " " + AddressofOwner.ZipCode : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = AddressofOwner != null ? AddressofOwner.Address1 + " " + AddressofOwner.Address2 + " " + AddressofOwner.City + " " + (AddressofOwner.State != null ? AddressofOwner.State.Acronym : string.Empty) + " " + AddressofOwner.ZipCode : string.Empty;
                                updateJobDocumentField.ActualValue = AddressofOwner != null ? AddressofOwner.Address1 + " " + AddressofOwner.Address2 + " " + AddressofOwner.City + " " + (AddressofOwner.State != null ? AddressofOwner.State.Acronym : string.Empty) + " " + AddressofOwner.ZipCode : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Phone")
                        {
                            string telephone = Common.GetContactPhoneNumberForJobDocument(jobContact);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = telephone,
                                    ActualValue = telephone,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = telephone;
                                updateJobDocumentField.ActualValue = telephone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "Phone24")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobContact != null && jobContact.Contact != null ? jobContact.Contact.WorkPhone : string.Empty,
                                    ActualValue = jobContact != null && jobContact.Contact != null ? jobContact.Contact.WorkPhone : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobContact != null && jobContact.Contact != null ? jobContact.Contact.WorkPhone : string.Empty;
                                updateJobDocumentField.ActualValue = jobContact != null && jobContact.Contact != null ? jobContact.Contact.WorkPhone : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "Lic_No")
                        {
                            var licence = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null ? jobContact.Contact.ContactLicenses.FirstOrDefault() : null;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = licence != null ? licence.Number : string.Empty,
                                    ActualValue = licence != null ? licence.Number : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = licence != null ? licence.Number : string.Empty;
                                updateJobDocumentField.ActualValue = licence != null ? licence.Number : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }

                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();

                            // JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Applicant")
                        {
                            int idJobApplicant = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;

                            jobContact = rpoContext.JobContacts.Include("Contact.Addresses.State").Include("Contact.ContactLicenses").Where(x => x.Id == idJobApplicant).FirstOrDefault();

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(applicantName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplicant),
                                    ActualValue = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName + (jobContact.Company != null ? " - " + jobContact.Company.Name : string.Empty) : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplicant);
                                updateJobDocumentField.ActualValue = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName + (jobContact.Company != null ? " - " + jobContact.Company.Name : string.Empty) : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PermitNo")
                        {
                            documentDescription = "Sanitation Dump Permit#: " + frontendFields.Value;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }

            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            //test
            GenerateJobDocument(idJobDocument);
        }

        public static void EditRequestforContainerInformationForm(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            var jobDocumentFieldList = rpoContext.JobDocumentFields.
               Where(x => x.IdJobDocument == idJobDocument).ToList();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                JobContact jobContact = new JobContact();
                JobApplication jobApplication = new JobApplication();
                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            string jobFileInfo = job != null ? job.JobNumber + " - CIF-81360.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "JobNumber")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty,
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "Applicant_Address")
                        {
                            var AddressofOwner = Common.GetContactAddressForJobDocument(jobContact);
                            //jobContact != null && jobContact.Contact != null && jobContact.Contact.Addresses != null ? jobContact.Contact.Addresses.FirstOrDefault(x => x.IsMainAddress == true) : null;


                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = AddressofOwner != null ? AddressofOwner.Address1 + " " + AddressofOwner.Address2 + " " + AddressofOwner.City + " " + (AddressofOwner.State != null ? AddressofOwner.State.Acronym : string.Empty) + " " + AddressofOwner.ZipCode : string.Empty,
                                    ActualValue = AddressofOwner != null ? AddressofOwner.Address1 + " " + AddressofOwner.Address2 + " " + AddressofOwner.City + " " + (AddressofOwner.State != null ? AddressofOwner.State.Acronym : string.Empty) + " " + AddressofOwner.ZipCode : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = AddressofOwner != null ? AddressofOwner.Address1 + " " + AddressofOwner.Address2 + " " + AddressofOwner.City + " " + (AddressofOwner.State != null ? AddressofOwner.State.Acronym : string.Empty) + " " + AddressofOwner.ZipCode : string.Empty;
                                updateJobDocumentField.ActualValue = AddressofOwner != null ? AddressofOwner.Address1 + " " + AddressofOwner.Address2 + " " + AddressofOwner.City + " " + (AddressofOwner.State != null ? AddressofOwner.State.Acronym : string.Empty) + " " + AddressofOwner.ZipCode : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Phone")
                        {
                            string telephone = Common.GetContactPhoneNumberForJobDocument(jobContact);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = telephone,
                                    ActualValue = telephone,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = telephone;
                                updateJobDocumentField.ActualValue = telephone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "Phone24")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobContact != null && jobContact.Contact != null ? jobContact.Contact.WorkPhone : string.Empty,
                                    ActualValue = jobContact != null && jobContact.Contact != null ? jobContact.Contact.WorkPhone : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobContact != null && jobContact.Contact != null ? jobContact.Contact.WorkPhone : string.Empty;
                                updateJobDocumentField.ActualValue = jobContact != null && jobContact.Contact != null ? jobContact.Contact.WorkPhone : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "Lic_No")
                        {
                            var licence = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null ? jobContact.Contact.ContactLicenses.FirstOrDefault() : null;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = licence != null ? licence.Number : string.Empty,
                                    ActualValue = licence != null ? licence.Number : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = licence != null ? licence.Number : string.Empty;
                                updateJobDocumentField.ActualValue = licence != null ? licence.Number : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }

                        }

                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();

                            // JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Applicant")
                        {
                            int idJobApplicant = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;

                            jobContact = rpoContext.JobContacts.Include("Contact.Addresses.State").Include("Contact.ContactLicenses").Where(x => x.Id == idJobApplicant).FirstOrDefault();

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(applicantName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplicant),
                                    ActualValue = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName + (jobContact.Company != null ? " - " + jobContact.Company.Name : string.Empty) : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField && x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(idJobApplicant);
                                updateJobDocumentField.ActualValue = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName + (jobContact.Company != null ? " - " + jobContact.Company.Name : string.Empty) : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PermitNo")
                        {
                            documentDescription = "Sanitation Dump Permit#: " + frontendFields.Value;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            //test
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }

        public static void GenerateNotificationOfStagingOutriggerBeamUse(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
               Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                JobContact jobContact = new JobContact();

                string sriFax = string.Empty;
                string sriPhone = string.Empty;
                string sriZip = string.Empty;
                string sriState = string.Empty;
                string sriCity = string.Empty;
                string sriAddress = string.Empty;
                string sriBusinessName = string.Empty;
                string sriLicenceName = string.Empty;
                string sriMiddelName = string.Empty;
                string sriFirstName = string.Empty;
                string sriLastName = string.Empty;
                Address ownerAddress = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Addresses != null ? job.RfpAddress.OwnerContact.Addresses.FirstOrDefault(x => x.IsMainAddress == true) : null;

                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {

                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            string jobFileInfo = job != null ? job.JobNumber + " - CD5- Notification of staging and outrigger beam use.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }


                        else if (item.Field.FieldName == "Borough")
                        {
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "House No")
                        {
                            string houseNumber = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = houseNumber,
                                    ActualValue = houseNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = houseNumber;
                                updateJobDocumentField.ActualValue = houseNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street Name")
                        {
                            string streetName = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = streetName,
                                    ActualValue = streetName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = streetName;
                                updateJobDocumentField.ActualValue = streetName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Special Space Name")
                        {
                            string specialPlaceName = job != null ? job.SpecialPlace : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = specialPlaceName,
                                    ActualValue = specialPlaceName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = specialPlaceName;
                                updateJobDocumentField.ActualValue = specialPlaceName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "No. Of Stories")
                        {
                            string stories = job != null && job.RfpAddress != null ? job.RfpAddress.Stories.ToString() : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = stories,
                                    ActualValue = stories
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = stories;
                                updateJobDocumentField.ActualValue = stories;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Describe & scretch Equipment 1")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Describe & scretch Equipment 2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Describe & scretch Equipment 3")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Describe & scretch Equipment 4")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Describe & scretch Equipment 5")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Describe & scretch Equipment 6")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Describe & scretch Equipment 7")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Describe & scretch Equipment 8")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Expected Start Date")
                        {
                            DateTime date = DateTime.Today;
                            string format = "MM/dd/yy";
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = date.ToString(format),
                                    ActualValue = date.ToString(format)
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = date.ToString(format);
                                updateJobDocumentField.ActualValue = date.ToString(format);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Duration of Job")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SRI Last Name")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = sriLastName,
                                    ActualValue = sriLastName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = sriLastName;
                                updateJobDocumentField.ActualValue = sriLastName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SRI First Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = sriFirstName,
                                    ActualValue = sriFirstName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = sriFirstName;
                                updateJobDocumentField.ActualValue = sriFirstName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SRI Middle Initial")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = sriMiddelName,
                                    ActualValue = sriMiddelName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = sriMiddelName;
                                updateJobDocumentField.ActualValue = sriMiddelName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SRI Licence No")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = sriLicenceName,
                                    ActualValue = sriLicenceName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = sriLicenceName;
                                updateJobDocumentField.ActualValue = sriLicenceName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SRI Business Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = sriBusinessName,
                                    ActualValue = sriBusinessName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = sriBusinessName;
                                updateJobDocumentField.ActualValue = sriBusinessName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SRI Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = sriAddress,
                                    ActualValue = sriAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = sriAddress;
                                updateJobDocumentField.ActualValue = sriAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SRI City")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = sriCity,
                                    ActualValue = sriCity
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = sriCity;
                                updateJobDocumentField.ActualValue = sriCity;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SRI State")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = sriState,
                                    ActualValue = sriState
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = sriState;
                                updateJobDocumentField.ActualValue = sriState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SRI Zip")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = sriZip,
                                    ActualValue = sriZip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = sriZip;
                                updateJobDocumentField.ActualValue = sriZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SRI Phone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = sriPhone,
                                    ActualValue = sriPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = sriPhone;
                                updateJobDocumentField.ActualValue = sriPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SRI Fax")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = sriFax,
                                    ActualValue = sriFax
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = sriFax;
                                updateJobDocumentField.ActualValue = sriFax;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OW Last Name")
                        {

                            string owLastName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.LastName : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = owLastName,
                                    ActualValue = owLastName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = owLastName;
                                updateJobDocumentField.ActualValue = owLastName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OW First Name")
                        {
                            string owFirstName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = owFirstName,
                                    ActualValue = owFirstName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = owFirstName;
                                updateJobDocumentField.ActualValue = owFirstName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OW Middle Initial")
                        {
                            string owMiddelName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.MiddleName : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = owMiddelName,
                                    ActualValue = owMiddelName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = owMiddelName;
                                updateJobDocumentField.ActualValue = owMiddelName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        //else if (item.Field.FieldName == "OW Licence No")
                        //{
                        //    ContactLicense ownerLicense = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.ContactLicenses != null ? job.RfpAddress.OwnerContact.ContactLicenses.FirstOrDefault() : null;
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = ownerLicense!=null? ownerLicense.Number:string.Empty,
                        //            ActualValue = ownerLicense != null ? ownerLicense.Number : string.Empty
                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //        rpoContext.SaveChanges();
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = ownerLicense != null ? ownerLicense.Number : string.Empty;
                        //        updateJobDocumentField.ActualValue = ownerLicense != null ? ownerLicense.Number : string.Empty;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        else if (item.Field.FieldName == "OW Business Name")
                        {
                            Contact owner = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact : null;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = owner != null && owner.Company != null ? owner.Company.Name : string.Empty,
                                    ActualValue = owner != null && owner.Company != null ? owner.Company.Name : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = owner != null && owner.Company != null ? owner.Company.Name : string.Empty;
                                updateJobDocumentField.ActualValue = owner != null && owner.Company != null ? owner.Company.Name : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OW Address")
                        {
                            string ownerAdd = ownerAddress != null ? ownerAddress.Address1 + " " + ownerAddress.Address2 : string.Empty;
                            if (string.IsNullOrEmpty(ownerAdd))
                            {

                                Contact contact = job.RfpAddress.OwnerContact;
                                string companyName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Company != null ? job.RfpAddress.OwnerContact.Company.Name : string.Empty;
                                Address jobcompanyAddress = Common.GetContactAddressForJobDocument(contact);
                                ownerAdd = jobcompanyAddress != null ? jobcompanyAddress.Address1 + " " + jobcompanyAddress.Address2 : string.Empty;
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerAdd,
                                    ActualValue = ownerAdd
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerAdd;
                                updateJobDocumentField.ActualValue = ownerAdd;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OW City")
                        {
                            string ownerCity = ownerAddress != null ? ownerAddress.City : string.Empty;
                            if (string.IsNullOrEmpty(ownerCity))
                            {

                                Contact contact = job.RfpAddress.OwnerContact;
                                string companyName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Company != null ? job.RfpAddress.OwnerContact.Company.Name : string.Empty;
                                Address jobcompanyAddress = Common.GetContactAddressForJobDocument(contact);
                                ownerCity = jobcompanyAddress != null ? jobcompanyAddress.City : string.Empty;
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerCity,
                                    ActualValue = ownerCity
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerCity;
                                updateJobDocumentField.ActualValue = ownerCity;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OW State")
                        {
                            string ownerState = ownerAddress != null && ownerAddress.State != null ? ownerAddress.State.Acronym : string.Empty;
                            if (string.IsNullOrEmpty(ownerState))
                            {

                                Contact contact = job.RfpAddress.OwnerContact;
                                string companyName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Company != null ? job.RfpAddress.OwnerContact.Company.Name : string.Empty;
                                Address jobcompanyAddress = Common.GetContactAddressForJobDocument(contact);
                                ownerState = jobcompanyAddress != null ? jobcompanyAddress.State.Acronym : string.Empty;
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerState,
                                    ActualValue = ownerState
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerState;
                                updateJobDocumentField.ActualValue = ownerState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OW Zip")
                        {
                            string ownerZip = ownerAddress != null ? ownerAddress.ZipCode : string.Empty;
                            if (string.IsNullOrEmpty(ownerZip))
                            {

                                Contact contact = job.RfpAddress.OwnerContact;
                                string companyName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Company != null ? job.RfpAddress.OwnerContact.Company.Name : string.Empty;
                                Address jobcompanyAddress = Common.GetContactAddressForJobDocument(contact);
                                ownerZip = jobcompanyAddress != null ? jobcompanyAddress.ZipCode : string.Empty;
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerZip,
                                    ActualValue = ownerZip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerZip;
                                updateJobDocumentField.ActualValue = ownerZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OW Phone")
                        {
                            string ownerWorkPhone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;

                            //string ownerZip = ownerAddress != null ? ownerAddress.ZipCode : string.Empty;
                            if (string.IsNullOrEmpty(ownerWorkPhone))
                            {

                                Contact contact = job.RfpAddress.OwnerContact;
                                string companyName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Company != null ? job.RfpAddress.OwnerContact.Company.Name : string.Empty;
                                Address jobcompanyAddress = Common.GetContactAddressForJobDocument(contact);
                                ownerWorkPhone = jobcompanyAddress != null ? jobcompanyAddress.Phone : string.Empty;
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerWorkPhone,
                                    ActualValue = ownerWorkPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerWorkPhone;
                                updateJobDocumentField.ActualValue = ownerWorkPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OW Fax")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Date")
                        {
                            DateTime date = DateTime.Today;
                            string format = "MM/dd/yy";

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = date.ToString(format),
                                    ActualValue = date.ToString(format)
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = date.ToString(format);
                                updateJobDocumentField.ActualValue = date.ToString(format);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }

                    else
                    {
                        if (item.Field.FieldName == "Applicant")
                        {
                            int idJobApplicant = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;

                            jobContact = rpoContext.JobContacts.Where(x => x.Id == idJobApplicant).FirstOrDefault();

                            sriLastName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.LastName : string.Empty;
                            sriFirstName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName : string.Empty;
                            sriMiddelName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MiddleName : string.Empty;

                            string contactDetails = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;

                            Address compnayAddress = jobContact != null && jobContact.Company != null && jobContact.Company.Addresses != null ? jobContact.Company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;
                            sriBusinessName = jobContact != null && jobContact.Company != null ? jobContact.Company.Name : string.Empty;
                            sriPhone = compnayAddress != null ? compnayAddress.Phone : string.Empty;
                            sriAddress = compnayAddress != null ? compnayAddress.Address1 + " " + compnayAddress.Address2 : string.Empty;
                            sriFax = string.Empty;
                            sriCity = compnayAddress != null ? compnayAddress.City : string.Empty;
                            sriState = compnayAddress != null && compnayAddress.State != null ? compnayAddress.State.Acronym : string.Empty;
                            sriZip = compnayAddress != null ? compnayAddress.ZipCode : string.Empty;


                            ContactLicense contactLicNumber = jobContact != null ? jobContact.Contact.ContactLicenses.FirstOrDefault() : null;
                            sriLicenceName = contactLicNumber != null ? contactLicNumber.Number : string.Empty;

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(applicantName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplicant),
                                    ActualValue = contactDetails
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplicant);
                                updateJobDocumentField.ActualValue = contactDetails;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Job Description")
                        {
                            documentDescription = "Job Description: " + frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }

            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();

            GenerateJobDocument(idJobDocument);
        }


        public static void EditNotificationOfStagingOutriggerBeamUse(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            var jobDocumentFieldList = rpoContext.JobDocumentFields.
               Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                JobContact jobContact = new JobContact();

                string sriFax = string.Empty;
                string sriPhone = string.Empty;
                string sriZip = string.Empty;
                string sriState = string.Empty;
                string sriCity = string.Empty;
                string sriAddress = string.Empty;
                string sriBusinessName = string.Empty;
                string sriLicenceName = string.Empty;
                string sriMiddelName = string.Empty;
                string sriFirstName = string.Empty;
                string sriLastName = string.Empty;
                Address ownerAddress = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Addresses != null ? job.RfpAddress.OwnerContact.Addresses.FirstOrDefault(x => x.IsMainAddress == true) : null;

                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            string jobFileInfo = job != null ? job.JobNumber + " - CD5- Notification of staging and outrigger beam use.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Borough")
                        {
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "House No")
                        {
                            string houseNumber = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = houseNumber,
                                    ActualValue = houseNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = houseNumber;
                                updateJobDocumentField.ActualValue = houseNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street Name")
                        {
                            string streetName = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = streetName,
                                    ActualValue = streetName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = streetName;
                                updateJobDocumentField.ActualValue = streetName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Special Space Name")
                        {
                            string specialPlaceName = job != null ? job.SpecialPlace : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = specialPlaceName,
                                    ActualValue = specialPlaceName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = specialPlaceName;
                                updateJobDocumentField.ActualValue = specialPlaceName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "No. Of Stories")
                        {
                            string stories = job != null && job.RfpAddress != null ? job.RfpAddress.Stories.ToString() : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = stories,
                                    ActualValue = stories
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = stories;
                                updateJobDocumentField.ActualValue = stories;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Expected Start Date")
                        {
                            DateTime date = DateTime.Today;
                            string format = "MM/dd/yy";
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = date.ToString(format),
                                    ActualValue = date.ToString(format)
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = date.ToString(format);
                                updateJobDocumentField.ActualValue = date.ToString(format);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SRI Last Name")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = sriLastName,
                                    ActualValue = sriLastName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = sriLastName;
                                updateJobDocumentField.ActualValue = sriLastName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SRI First Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = sriFirstName,
                                    ActualValue = sriFirstName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = sriFirstName;
                                updateJobDocumentField.ActualValue = sriFirstName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SRI Middle Initial")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = sriMiddelName,
                                    ActualValue = sriMiddelName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = sriMiddelName;
                                updateJobDocumentField.ActualValue = sriMiddelName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SRI Licence No")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = sriLicenceName,
                                    ActualValue = sriLicenceName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = sriLicenceName;
                                updateJobDocumentField.ActualValue = sriLicenceName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SRI Business Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = sriBusinessName,
                                    ActualValue = sriBusinessName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = sriBusinessName;
                                updateJobDocumentField.ActualValue = sriBusinessName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SRI Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = sriAddress,
                                    ActualValue = sriAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = sriAddress;
                                updateJobDocumentField.ActualValue = sriAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SRI City")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = sriCity,
                                    ActualValue = sriCity
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = sriCity;
                                updateJobDocumentField.ActualValue = sriCity;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SRI State")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = sriState,
                                    ActualValue = sriState
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = sriState;
                                updateJobDocumentField.ActualValue = sriState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SRI Zip")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = sriZip,
                                    ActualValue = sriZip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = sriZip;
                                updateJobDocumentField.ActualValue = sriZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SRI Phone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = sriPhone,
                                    ActualValue = sriPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = sriPhone;
                                updateJobDocumentField.ActualValue = sriPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SRI Fax")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = sriFax,
                                    ActualValue = sriFax
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = sriFax;
                                updateJobDocumentField.ActualValue = sriFax;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OW Last Name")
                        {

                            string owLastName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.LastName : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = owLastName,
                                    ActualValue = owLastName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = owLastName;
                                updateJobDocumentField.ActualValue = owLastName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OW First Name")
                        {
                            string owFirstName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = owFirstName,
                                    ActualValue = owFirstName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = owFirstName;
                                updateJobDocumentField.ActualValue = owFirstName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OW Middle Initial")
                        {
                            string owMiddelName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.MiddleName : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = owMiddelName,
                                    ActualValue = owMiddelName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = owMiddelName;
                                updateJobDocumentField.ActualValue = owMiddelName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        //else if (item.Field.FieldName == "OW Licence No")
                        //{
                        //    ContactLicense ownerLicense = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.ContactLicenses != null ? job.RfpAddress.OwnerContact.ContactLicenses.FirstOrDefault() : null;
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = ownerLicense!=null? ownerLicense.Number:string.Empty,
                        //            ActualValue = ownerLicense != null ? ownerLicense.Number : string.Empty
                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //        rpoContext.SaveChanges();
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = ownerLicense != null ? ownerLicense.Number : string.Empty;
                        //        updateJobDocumentField.ActualValue = ownerLicense != null ? ownerLicense.Number : string.Empty;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        else if (item.Field.FieldName == "OW Business Name")
                        {
                            Contact owner = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact : null;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = owner != null && owner.Company != null ? owner.Company.Name : string.Empty,
                                    ActualValue = owner != null && owner.Company != null ? owner.Company.Name : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = owner != null && owner.Company != null ? owner.Company.Name : string.Empty;
                                updateJobDocumentField.ActualValue = owner != null && owner.Company != null ? owner.Company.Name : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OW Address")
                        {
                            string owneradd = ownerAddress != null ? ownerAddress.Address1 + " " + ownerAddress.Address2 : string.Empty;
                            if (string.IsNullOrEmpty(owneradd))
                            {

                                Contact contact = job.RfpAddress.OwnerContact;
                                string companyName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Company != null ? job.RfpAddress.OwnerContact.Company.Name : string.Empty;
                                Address jobcompanyAddress = Common.GetContactAddressForJobDocument(contact);
                                owneradd = jobcompanyAddress != null ? jobcompanyAddress.Address1 + " " + jobcompanyAddress.Address2 : string.Empty;
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = owneradd,
                                    ActualValue = owneradd
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = owneradd;
                                updateJobDocumentField.ActualValue = owneradd;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OW City")
                        {
                            string ownercity = ownerAddress != null ? ownerAddress.City : string.Empty;
                            if (string.IsNullOrEmpty(ownercity))
                            {

                                Contact contact = job.RfpAddress.OwnerContact;
                                string companyName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Company != null ? job.RfpAddress.OwnerContact.Company.Name : string.Empty;
                                Address jobcompanyAddress = Common.GetContactAddressForJobDocument(contact);
                                ownercity = jobcompanyAddress != null ? jobcompanyAddress.City : string.Empty;
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownercity,
                                    ActualValue = ownercity
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = ownercity;
                                updateJobDocumentField.ActualValue = ownercity;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OW State")
                        {
                            string ownerstate = ownerAddress != null && ownerAddress.State != null ? ownerAddress.State.Acronym : string.Empty;
                            if (string.IsNullOrEmpty(ownerstate))
                            {

                                Contact contact = job.RfpAddress.OwnerContact;
                                string companyName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Company != null ? job.RfpAddress.OwnerContact.Company.Name : string.Empty;
                                Address jobcompanyAddress = Common.GetContactAddressForJobDocument(contact);
                                ownerstate = jobcompanyAddress != null ? jobcompanyAddress.State.Acronym : string.Empty;
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerstate,
                                    ActualValue = ownerstate
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = ownerstate;
                                updateJobDocumentField.ActualValue = ownerstate;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OW Zip")
                        {
                            string ownerzip = ownerAddress != null ? ownerAddress.ZipCode : string.Empty;
                            if (string.IsNullOrEmpty(ownerzip))
                            {

                                Contact contact = job.RfpAddress.OwnerContact;
                                string companyName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Company != null ? job.RfpAddress.OwnerContact.Company.Name : string.Empty;
                                Address jobcompanyAddress = Common.GetContactAddressForJobDocument(contact);
                                ownerzip = jobcompanyAddress != null ? jobcompanyAddress.ZipCode : string.Empty;
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerzip,
                                    ActualValue = ownerzip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = ownerzip;
                                updateJobDocumentField.ActualValue = ownerzip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OW Phone")
                        {
                            string ownerWorkPhone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;

                            // string ownerzip = ownerAddress != null ? ownerAddress.ZipCode : string.Empty;
                            if (string.IsNullOrEmpty(ownerWorkPhone))
                            {

                                Contact contact = job.RfpAddress.OwnerContact;
                                string companyName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Company != null ? job.RfpAddress.OwnerContact.Company.Name : string.Empty;
                                Address jobcompanyAddress = Common.GetContactAddressForJobDocument(contact);
                                ownerWorkPhone = jobcompanyAddress != null ? jobcompanyAddress.Phone : string.Empty;
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerWorkPhone,
                                    ActualValue = ownerWorkPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = ownerWorkPhone;
                                updateJobDocumentField.ActualValue = ownerWorkPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Date")
                        {
                            DateTime date = DateTime.Today;
                            string format = "MM/dd/yy";

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = date.ToString(format),
                                    ActualValue = date.ToString(format)
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = date.ToString(format);
                                updateJobDocumentField.ActualValue = date.ToString(format);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }

                    else
                    {
                        if (item.Field.FieldName == "Applicant")
                        {
                            int idJobApplicant = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;

                            jobContact = rpoContext.JobContacts.Where(x => x.Id == idJobApplicant).FirstOrDefault();

                            sriLastName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.LastName : string.Empty;
                            sriFirstName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName : string.Empty;
                            sriMiddelName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MiddleName : string.Empty;

                            string contactDetails = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;

                            Address compnayAddress = jobContact != null && jobContact.Company != null && jobContact.Company.Addresses != null ? jobContact.Company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;
                            sriBusinessName = jobContact != null && jobContact.Company != null ? jobContact.Company.Name : string.Empty;
                            sriPhone = compnayAddress != null ? compnayAddress.Phone : string.Empty;
                            sriAddress = compnayAddress != null ? compnayAddress.Address1 + " " + compnayAddress.Address2 : string.Empty;
                            sriFax = string.Empty;
                            sriCity = compnayAddress != null ? compnayAddress.City : string.Empty;
                            sriState = compnayAddress != null && compnayAddress.State != null ? compnayAddress.State.Acronym : string.Empty;
                            sriZip = compnayAddress != null ? compnayAddress.ZipCode : string.Empty;


                            ContactLicense contactLicNumber = jobContact != null ? jobContact.Contact.ContactLicenses.FirstOrDefault() : null;
                            sriLicenceName = contactLicNumber != null ? contactLicNumber.Number : string.Empty;

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(applicantName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplicant),
                                    ActualValue = contactDetails
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(idJobApplicant);
                                updateJobDocumentField.ActualValue = contactDetails;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Job Description")
                        {
                            documentDescription = "Job Description: " + frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }

            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }

        /// <summary>
        /// Generates the permit document.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.</param>
        public static void GeneratePermitDocument(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.
                Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                JobApplicationWorkPermitType jobApplicationWorkPermitType = new JobApplicationWorkPermitType();
                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;

                            jobDocument.IdJobApplication = idJobApplication;
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();

                            jobDocument.TrackingNumber = jobApplication.ApplicationNumber;

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "WorkPermit")
                        {
                            int idJobApplicationWorkPermitType = Convert.ToInt32(frontendFields.Value);
                            jobApplicationWorkPermitType = rpoContext.JobApplicationWorkPermitTypes.Include("JobApplication.JobApplicationType.Parent").Include("JobWorkType").FirstOrDefault(x => x.Id == idJobApplicationWorkPermitType);

                            jobDocument.IdJobApplicationWorkPermitType = idJobApplicationWorkPermitType;
                            jobDocument.PermitNumber = jobApplicationWorkPermitType.PermitNumber;


                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            documentDescription = !string.IsNullOrEmpty(jobApplicationWorkPermitType.Code) ? "Work/Permit type :" + jobApplicationWorkPermitType.Code : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }

                //JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
                //string documentName = string.Empty;
                if (jobApplicationWorkPermitType != null && jobApplicationWorkPermitType.JobApplication != null
                    && jobApplicationWorkPermitType.JobApplication.JobApplicationType != null
                    && jobApplicationWorkPermitType.JobApplication.JobApplicationType.IdParent != null
                    && jobApplicationWorkPermitType.JobApplication.JobApplicationType.IdParent == ApplicationType.DOT.GetHashCode())
                {
                    documentDescription = string.Empty;
                    documentDescription =
                            //(!string.IsNullOrEmpty(jobApplicationWorkPermitType.JobApplication.ApplicationNumber) ? "Tracking# :" + jobApplicationWorkPermitType.JobApplication.ApplicationNumber + ", " : string.Empty)
                            (!string.IsNullOrEmpty(jobApplicationWorkPermitType.PermitNumber) ? "Permit# :" + jobApplicationWorkPermitType.PermitNumber + ", " : string.Empty)
                            + (!string.IsNullOrEmpty(jobApplicationWorkPermitType.PermitType) ? "WorkPermit :" + jobApplicationWorkPermitType.PermitType + ", " : string.Empty)
                            + (jobApplicationWorkPermitType.JobApplication != null && (!string.IsNullOrEmpty(jobApplicationWorkPermitType.JobApplication.StreetWorkingOn) || !string.IsNullOrEmpty(jobApplicationWorkPermitType.JobApplication.StreetFrom) || !string.IsNullOrEmpty(jobApplicationWorkPermitType.JobApplication.StreetTo)) ? ("Location :" + (jobApplicationWorkPermitType.JobApplication != null ? jobApplicationWorkPermitType.JobApplication.StreetWorkingOn : string.Empty) + " | " + (jobApplicationWorkPermitType.JobApplication != null ? jobApplicationWorkPermitType.JobApplication.StreetFrom : string.Empty) + " | " + (jobApplicationWorkPermitType.JobApplication != null ? jobApplicationWorkPermitType.JobApplication.StreetTo : string.Empty)) : string.Empty);
                }

                //else if (jobApplicationWorkPermitType != null
                //        && jobApplicationWorkPermitType.JobWorkType != null
                //        && jobApplicationWorkPermitType.JobWorkType.Description != null
                //        && jobApplicationWorkPermitType.JobApplication != null
                //        && jobApplicationWorkPermitType.JobApplication.JobApplicationType != null
                //    && jobApplicationWorkPermitType.JobApplication.JobApplicationType.IdParent != null
                //    && jobApplicationWorkPermitType.JobApplication.JobApplicationType.IdParent == ApplicationType.DOB.GetHashCode())
                //{
                //    documentDescription = (!string.IsNullOrEmpty(jobApplicationWorkPermitType.JobWorkType.Description) ? "Work/Permit type :" + jobApplicationWorkPermitType.JobWorkType.Description + ", " : string.Empty)
                //    + (!string.IsNullOrEmpty(jobApplicationWorkPermitType.JobApplication.ApplicationNumber) ? ", Application# :" + jobApplicationWorkPermitType.JobApplication.ApplicationNumber : string.Empty);
                //}

                //if (jobDocument != null && !string.IsNullOrEmpty(documentDescription))
                //{
                //    jobDocument.DocumentDescription = documentDescription;
                //}

                jobDocument.DocumentDescription = documentDescription;
                jobDocument.JobDocumentFor = jobDocumentFor;
                rpoContext.SaveChanges();
            }
        }

        public static void GenerateDEPPermitDocument(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.
                Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                JobApplicationWorkPermitType jobApplicationWorkPermitType = new JobApplicationWorkPermitType();
                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;

                            jobDocument.IdJobApplication = idJobApplication;
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();

                            jobDocument.TrackingNumber = jobApplication.ApplicationNumber;

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "WorkPermit")
                        {
                            int idJobApplicationWorkPermitType = Convert.ToInt32(frontendFields.Value);
                            jobApplicationWorkPermitType = rpoContext.JobApplicationWorkPermitTypes.Include("JobApplication.JobApplicationType.Parent").Include("JobWorkType").FirstOrDefault(x => x.Id == idJobApplicationWorkPermitType);

                            jobDocument.IdJobApplicationWorkPermitType = idJobApplicationWorkPermitType;
                            jobDocument.PermitNumber = jobApplicationWorkPermitType.PermitNumber;


                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            //documentDescription = !string.IsNullOrEmpty(jobApplicationWorkPermitType.Code) ? "Work/Permit type :" + jobApplicationWorkPermitType.Code : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Optional Description")
                        {

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);

                            documentDescription = documentDescription + (!string.IsNullOrWhiteSpace(frontendFields.Value) ? "Optional Description: " + frontendFields.Value : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }

                //JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
                //string documentName = string.Empty;
                if (jobApplicationWorkPermitType != null && jobApplicationWorkPermitType.JobApplication != null
                    && jobApplicationWorkPermitType.JobApplication.JobApplicationType != null
                    && jobApplicationWorkPermitType.JobApplication.JobApplicationType.IdParent != null
                    && jobApplicationWorkPermitType.JobApplication.JobApplicationType.IdParent == ApplicationType.DEP.GetHashCode())
                {
                    //documentDescription = string.Empty;
                    //documentDescription =
                    //        //(!string.IsNullOrEmpty(jobApplicationWorkPermitType.JobApplication.ApplicationNumber) ? "Tracking# :" + jobApplicationWorkPermitType.JobApplication.ApplicationNumber + ", " : string.Empty)
                    //        (!string.IsNullOrEmpty(jobApplicationWorkPermitType.PermitNumber) ? "Permit# :" + jobApplicationWorkPermitType.PermitNumber + ", " : string.Empty)
                    //        + (!string.IsNullOrEmpty(jobApplicationWorkPermitType.PermitType) ? "WorkPermit :" + jobApplicationWorkPermitType.PermitType + ", " : string.Empty)
                    //        + (jobApplicationWorkPermitType.JobApplication != null && (!string.IsNullOrEmpty(jobApplicationWorkPermitType.JobApplication.StreetWorkingOn) || !string.IsNullOrEmpty(jobApplicationWorkPermitType.JobApplication.StreetFrom) || !string.IsNullOrEmpty(jobApplicationWorkPermitType.JobApplication.StreetTo)) ? ("Location :" + (jobApplicationWorkPermitType.JobApplication != null ? jobApplicationWorkPermitType.JobApplication.StreetWorkingOn : string.Empty) + " | " + (jobApplicationWorkPermitType.JobApplication != null ? jobApplicationWorkPermitType.JobApplication.StreetFrom : string.Empty) + " | " + (jobApplicationWorkPermitType.JobApplication != null ? jobApplicationWorkPermitType.JobApplication.StreetTo : string.Empty)) : string.Empty);



                    documentDescription = documentDescription + (jobApplicationWorkPermitType.JobWorkType != null && jobApplicationWorkPermitType.JobWorkType.JobApplicationType != null ? " | Application: " + jobApplicationWorkPermitType.JobWorkType.JobApplicationType.Description : string.Empty)
                        + (jobApplicationWorkPermitType.JobApplication != null && (!string.IsNullOrEmpty(jobApplicationWorkPermitType.JobApplication.StreetWorkingOn) || !string.IsNullOrEmpty(jobApplicationWorkPermitType.JobApplication.StreetFrom) || !string.IsNullOrEmpty(jobApplicationWorkPermitType.JobApplication.StreetTo)) ? ((jobApplicationWorkPermitType.JobApplication != null ? ", " + jobApplicationWorkPermitType.JobApplication.StreetWorkingOn : string.Empty) + " | " + (jobApplicationWorkPermitType.JobApplication != null ? jobApplicationWorkPermitType.JobApplication.StreetFrom : string.Empty) + " | " + (jobApplicationWorkPermitType.JobApplication != null ? jobApplicationWorkPermitType.JobApplication.StreetTo : string.Empty)) : string.Empty)
                        + (jobApplicationWorkPermitType.JobWorkType != null ? " | Work/Permit type: " + jobApplicationWorkPermitType.JobWorkType.Description : string.Empty)
                        + (!string.IsNullOrEmpty(jobApplicationWorkPermitType.PermitNumber) ? ", " + jobApplicationWorkPermitType.PermitNumber : string.Empty)
                        + ((jobApplicationWorkPermitType.Expires != null ? ", " + " Expires :" + Convert.ToDateTime(jobApplicationWorkPermitType.Expires).ToString("MM/dd/yyyy") : string.Empty));


                }



                jobDocument.DocumentDescription = documentDescription;
                jobDocument.JobDocumentFor = jobDocumentFor;
                rpoContext.SaveChanges();
            }
        }

        /// <summary>
        /// Generates the scanned dep registration for demolition form a R300.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.</param>
        public static void GenerateScannedDEPRegistrationForDemolitionFormAR300(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.
                Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            //string documentName = string.Empty;
            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();

                            //documentName = jobApplication != null && !string.IsNullOrEmpty(jobApplication.FloorWorking) ? "FL: " + jobApplication.FloorWorking : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Applicant")
                        {
                            int idJobApplicant = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobContact jobContact = rpoContext.JobContacts.Include("Contact").Where(x => x.Id == idJobApplicant).FirstOrDefault();

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty); JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }


            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
        }

        /// <summary>
        /// Generates the application for certificate of operation.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.</param>
        public static void GenerateApplicationForCertificateOfOperation(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.
                Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;

                            jobDocument.IdJobApplication = idJobApplication;
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Additional Description")
                        {
                            documentDescription = !string.IsNullOrEmpty(frontendFields.Value) ? "Additional Description: " + frontendFields.Value : string.Empty;

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }

            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
        }

        /// <summary>
        /// Generates a i162402.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.( 5> Additional Information Form AI-1)</param>
        public static void GenerateAI162402(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            ///Verified By Prajesh
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").Include("Contact").Include("RfpAddress.Borough").Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                foreach (DocumentField item in documentFieldList)
                {

                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - AI1-62402.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Sheet")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "1",
                                    ActualValue = "1"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = "1";
                                updateJobDocumentField.ActualValue = "1";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Of")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "1",
                                    ActualValue = "1"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = "1";
                                updateJobDocumentField.ActualValue = "1";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "DocNo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "",
                                    ActualValue = ""
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = "";
                                updateJobDocumentField.ActualValue = "";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "HouseNo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Boro")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Block")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Bin")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CB")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OPTPw1")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "No",  // You Can set Yes Or No
                                    ActualValue = "No"  // You Can set Yes Or No
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = "No";
                                updateJobDocumentField.ActualValue = "No";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OPTA1Con")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "",  // You Can set Yes Or No,
                                    ActualValue = ""
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = "";
                                updateJobDocumentField.ActualValue = "";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SignatureDate")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "",
                                    ActualValue = ""
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = "";
                                updateJobDocumentField.ActualValue = "";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Description")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = item.StaticDescription,
                                    ActualValue = item.StaticDescription
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = item.StaticDescription;
                                updateJobDocumentField.ActualValue = item.StaticDescription;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;

                            jobDocument.IdJobApplication = idJobApplication;
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Applicant")
                        {
                            int idJobApplicant = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobContact jobContact = rpoContext.JobContacts.Include("Contact").Where(x => x.Id == idJobApplicant).FirstOrDefault();
                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(applicantName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplicant),
                                    ActualValue = applicantName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplicant);
                                updateJobDocumentField.ActualValue = applicantName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {

                            if (item.Field.FieldName == "Additional Description" && !string.IsNullOrEmpty(frontendFields.Value))
                            {
                                documentDescription = documentDescription + " | Additional Description: " + frontendFields.Value;
                            }

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }


            // Generate Job Document
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();

            GenerateJobDocument(idJobDocument);
        }

        public static void EditAI162402(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            ///Verified By Prajesh
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").Include("Contact").Include("RfpAddress.Borough").Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                foreach (DocumentField item in documentFieldList)
                {

                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - AI1-62402.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Sheet")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "1",
                                    ActualValue = "1"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = "1";
                                updateJobDocumentField.ActualValue = "1";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Of")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "1",
                                    ActualValue = "1"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = "1";
                                updateJobDocumentField.ActualValue = "1";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "HouseNo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Boro")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Block")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Bin")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CB")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;

                            jobDocument.IdJobApplication = idJobApplication;
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Applicant")
                        {
                            int idJobApplicant = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobContact jobContact = rpoContext.JobContacts.Include("Contact").Where(x => x.Id == idJobApplicant).FirstOrDefault();
                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(applicantName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplicant),
                                    ActualValue = applicantName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(idJobApplicant);
                                updateJobDocumentField.ActualValue = applicantName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {

                            if (item.Field.FieldName == "Additional Description" && !string.IsNullOrEmpty(frontendFields.Value))
                            {
                                documentDescription = documentDescription + " | Additional Description: " + frontendFields.Value;
                            }

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }

            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            // Generate Job Document
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();

            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }

        /// <summary>
        /// es the Certificate of Correction.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.(4> Certificate of Correction)</param>

        public static void GenerateCertificateOfCorrection(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                string companynamePersonPerformed = string.Empty;
                string companyAddressPersonPerformed = string.Empty;
                string contactLicensePersonPerformed = string.Empty;
                string certifierAddress = string.Empty;

                string architectEngineer = "No";
                string contractor = "No";


                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - AEU2-62401.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BoroughZip")
                        {
                            var jobCompanyAddresses = job.Company != null ? job.Company.Addresses.FirstOrDefault() : null;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description + (jobCompanyAddresses != null && jobCompanyAddresses.State != null ? ' ' + jobCompanyAddresses.State.Acronym : string.Empty) + ' ' + job.RfpAddress.ZipCode : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description + (jobCompanyAddresses != null && jobCompanyAddresses.State != null ? ' ' + jobCompanyAddresses.State.Acronym : string.Empty) + ' ' + job.RfpAddress.ZipCode : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description + (jobCompanyAddresses != null && jobCompanyAddresses.State != null ? ' ' + jobCompanyAddresses.State.Acronym : string.Empty) + ' ' + job.RfpAddress.ZipCode : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description + (jobCompanyAddresses != null && jobCompanyAddresses.State != null ? ' ' + jobCompanyAddresses.State.Acronym : string.Empty) + ' ' + job.RfpAddress.ZipCode : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "State")
                        {
                            var jobCompanyAddresses = job.Company != null ? job.Company.Addresses.FirstOrDefault() : null;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobCompanyAddresses != null && jobCompanyAddresses.State != null ? jobCompanyAddresses.State.Acronym : string.Empty,
                                    ActualValue = jobCompanyAddresses != null && jobCompanyAddresses.State != null ? jobCompanyAddresses.State.Acronym : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobCompanyAddresses != null && jobCompanyAddresses.State != null ? jobCompanyAddresses.State.Acronym : string.Empty;
                                updateJobDocumentField.ActualValue = jobCompanyAddresses != null && jobCompanyAddresses.State != null ? jobCompanyAddresses.State.Acronym : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "County")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.County : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.County : string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.County : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.County : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }


                        else if (item.Field.FieldName == "Respondent")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty, //static Respondent
                                    ActualValue = string.Empty //static Respondent

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Officer")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "", //static Officer
                                    ActualValue = "" //static Officer

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Respondent_Managing_Agent")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "", // static Respondent_Managing_Agent
                                    ActualValue = "" // static Respondent_Managing_Agent

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "",  // static Owner  
                                    ActualValue = ""  // static Owner  

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PlaceofOccurence_Managing_Agent")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "", // static PlaceofOccurence_Managing_Agent
                                    ActualValue = "" // static PlaceofOccurence_Managing_Agent

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Partner")
                        {

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "", // static Partner
                                    ActualValue = "" // static Partner
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ContractorOrAgent")
                        {

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "", // static ContractorOrAgent
                                    ActualValue = "" // static ContractorOrAgent

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CertifierAddress")
                        {
                            //var jobCompanyAddresses = job.Company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault();
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);

                            //= (job.Company != null ? job.Company.Name + " " : string.Empty) + (jobCompanyAddresses != null ? jobCompanyAddresses.Address1 + " " + jobCompanyAddresses.Address2 + " " + jobCompanyAddresses.City + " " + jobCompanyAddresses.State.Acronym + " " + jobCompanyAddresses.ZipCode : string.Empty);
                            certifierAddress = certifierAddress;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = certifierAddress,
                                    ActualValue = certifierAddress

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = certifierAddress;
                                updateJobDocumentField.ActualValue = certifierAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CompletionDate")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "",// Set as Blank
                                    ActualValue = "" // Set as Blank

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Myself")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "",  // static Myself  
                                    ActualValue = ""  // static Myself  

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "MyEmployee")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "", // static MyEmployee
                                    ActualValue = "" // static MyEmployee

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Contractor")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = contractor,
                                    ActualValue = contractor

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = contractor;
                                updateJobDocumentField.ActualValue = contractor;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ArchitectEngineer")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = architectEngineer,
                                    ActualValue = architectEngineer

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = architectEngineer;
                                updateJobDocumentField.ActualValue = architectEngineer;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Company")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);

                            companynamePersonPerformed = companynamePersonPerformed;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companynamePersonPerformed,
                                    ActualValue = companynamePersonPerformed
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = companynamePersonPerformed;
                                updateJobDocumentField.ActualValue = companynamePersonPerformed;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "ApplicantAddress")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            companyAddressPersonPerformed = companyAddressPersonPerformed;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyAddressPersonPerformed,
                                    ActualValue = companyAddressPersonPerformed
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = companyAddressPersonPerformed;
                                updateJobDocumentField.ActualValue = companyAddressPersonPerformed;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lic_No")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = contactLicensePersonPerformed,
                                    ActualValue = contactLicensePersonPerformed
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = contactLicensePersonPerformed;
                                updateJobDocumentField.ActualValue = contactLicensePersonPerformed;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Date")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                    else
                    {

                        if (item.Field.FieldName == "Certifier")
                        {
                            int idJobApplicant = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            Contact contact = rpoContext.Contacts.Include("Company.Addresses").Include("Addresses").Where(x => x.Id == idJobApplicant).FirstOrDefault();

                            Company company = contact.Company;
                            Address companyAddress = Common.GetContactAddressForJobDocument(contact);
                            //company != null && company.Addresses != null ? company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;

                            //ContactLicense contactLicense = contact.ContactLicenses.FirstOrDefault();

                            //if (companyAddress == null)
                            //{
                            //    companyAddress = contact != null && contact.Addresses != null ? contact.Addresses.FirstOrDefault(x => x.IsMainAddress == true) : null;
                            //}

                            certifierAddress = company != null ? contact.Company.Name + ", " : string.Empty;
                            string certifierCompanyAddress = companyAddress != null ? companyAddress.Address1 + " " + companyAddress.Address2 + " " + companyAddress.City + (companyAddress.State != null ? " " + companyAddress.State.Acronym : string.Empty) + " " + companyAddress.ZipCode : string.Empty;
                            certifierAddress = certifierAddress + certifierCompanyAddress;

                            string certifierName = contact != null ? contact.FirstName + " " + contact.LastName : string.Empty;
                            //documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(certifierName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(certifierName) ? "Certifier: " + certifierName : string.Empty);
                            documentDescription = "Certifier Name: " + certifierName;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplicant),
                                    ActualValue = contact != null ? contact.FirstName + " " + contact.LastName : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplicant);
                                updateJobDocumentField.ActualValue = contact != null ? contact.FirstName + " " + contact.LastName : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Person Who Performed Work")
                        {
                            int certifierid = Convert.ToInt32(frontendFields.Value);
                            Contact contact = rpoContext.Contacts.Include("Company.Addresses").Include("Addresses").Where(x => x.Id == certifierid).FirstOrDefault();

                            Company company = contact.Company;
                            Address companyAddress = Common.GetContactAddressForJobDocument(contact);

                            //company != null && company.Addresses != null ? company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;
                            //if (companyAddress == null)
                            //{
                            //    companyAddress = contact != null && contact.Addresses != null ? contact.Addresses.FirstOrDefault(x => x.IsMainAddress == true) : null;
                            //}

                            companynamePersonPerformed = company != null ? contact.Company.Name : string.Empty;


                            if (company != null && company.CompanyTypes != null && company.CompanyTypes.Where(x => x.ItemName == "General Contractor").Any())
                            {

                                contactLicensePersonPerformed = company.TrackingNumber;
                                contractor = "Yes";
                            }
                            else
                            {
                                ContactLicense contactLicense = contact.ContactLicenses.FirstOrDefault(x => x.ContactLicenseType.Name == "Engineer" || x.ContactLicenseType.Name == "Architect");
                                contactLicensePersonPerformed = contactLicense != null ? contactLicense.Number : string.Empty;
                                architectEngineer = "Yes";
                            }

                            companyAddressPersonPerformed = companyAddress != null ? companyAddress.Address1 + " " + companyAddress.Address2 + " " + companyAddress.City + (companyAddress.State != null ? " " + companyAddress.State.Acronym : string.Empty) + " " + companyAddress.ZipCode : string.Empty;

                            string personWhoPerformedWorkName = contact != null ? contact.FirstName + " " + contact.LastName : string.Empty;
                            //documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(personWhoPerformedWorkName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(personWhoPerformedWorkName) ? "Person Who Performed Work: " + personWhoPerformedWorkName : string.Empty);

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(personWhoPerformedWorkName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(personWhoPerformedWorkName) ? "Person Who Performed Work: " + personWhoPerformedWorkName : string.Empty);
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(certifierid),
                                    ActualValue = contact != null ? contact.FirstName + " " + contact.LastName : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(certifierid);
                                updateJobDocumentField.ActualValue = contact != null ? contact.FirstName + " " + contact.LastName : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Violation #")
                        {
                            int violationId = Convert.ToInt32(frontendFields.Value);
                            JobViolation jobViolation = rpoContext.JobViolations.Where(x => x.Id == violationId).FirstOrDefault();

                            jobDocument.IdJobViolation = violationId;

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = jobViolation.SummonsNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = jobViolation.SummonsNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Optional Description")
                        {
                            //documentDescription = "Optional Additional Description: " + frontendFields.Value;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(documentDescription) ? " | " : string.Empty) + (!string.IsNullOrEmpty(documentDescription) ? "Optional Additional Description: " + frontendFields.Value : string.Empty);
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }


                    }
                }
            }

            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();

            // Generate Job Document
            GenerateJobDocument(idJobDocument);
        }

        public static void EditCertificateOfCorrection(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                string companynamePersonPerformed = string.Empty;
                string companyAddressPersonPerformed = string.Empty;
                string contactLicensePersonPerformed = string.Empty;
                string certifierAddress = string.Empty;

                string architectEngineer = "No";
                string contractor = "No";


                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - AEU2-62401.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BoroughZip")
                        {
                            var jobCompanyAddresses = job.Company != null ? job.Company.Addresses.FirstOrDefault() : null;

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description + (jobCompanyAddresses != null && jobCompanyAddresses.State != null ? ' ' + jobCompanyAddresses.State.Acronym : string.Empty) + ' ' + job.RfpAddress.ZipCode : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description + (jobCompanyAddresses != null && jobCompanyAddresses.State != null ? ' ' + jobCompanyAddresses.State.Acronym : string.Empty) + ' ' + job.RfpAddress.ZipCode : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description + (jobCompanyAddresses != null && jobCompanyAddresses.State != null ? ' ' + jobCompanyAddresses.State.Acronym : string.Empty) + ' ' + job.RfpAddress.ZipCode : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description + (jobCompanyAddresses != null && jobCompanyAddresses.State != null ? ' ' + jobCompanyAddresses.State.Acronym : string.Empty) + ' ' + job.RfpAddress.ZipCode : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "State")
                        {
                            var jobCompanyAddresses = job.Company != null ? job.Company.Addresses.FirstOrDefault() : null;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobCompanyAddresses != null && jobCompanyAddresses.State != null ? jobCompanyAddresses.State.Acronym : string.Empty,
                                    ActualValue = jobCompanyAddresses != null && jobCompanyAddresses.State != null ? jobCompanyAddresses.State.Acronym : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobCompanyAddresses != null && jobCompanyAddresses.State != null ? jobCompanyAddresses.State.Acronym : string.Empty;
                                updateJobDocumentField.ActualValue = jobCompanyAddresses != null && jobCompanyAddresses.State != null ? jobCompanyAddresses.State.Acronym : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "County")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.County : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.County : string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.County : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.County : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CertifierAddress")
                        {
                            //var jobCompanyAddresses = job.Company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault();
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);

                            //= (job.Company != null ? job.Company.Name + " " : string.Empty) + (jobCompanyAddresses != null ? jobCompanyAddresses.Address1 + " " + jobCompanyAddresses.Address2 + " " + jobCompanyAddresses.City + " " + jobCompanyAddresses.State.Acronym + " " + jobCompanyAddresses.ZipCode : string.Empty);
                            certifierAddress = certifierAddress;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = certifierAddress,
                                    ActualValue = certifierAddress

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = certifierAddress;
                                updateJobDocumentField.ActualValue = certifierAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }



                        else if (item.Field.FieldName == "Contractor")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = contractor,
                                    ActualValue = contractor

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = contractor;
                                updateJobDocumentField.ActualValue = contractor;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ArchitectEngineer")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = architectEngineer,
                                    ActualValue = architectEngineer

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = architectEngineer;
                                updateJobDocumentField.ActualValue = architectEngineer;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Company")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);

                            companynamePersonPerformed = companynamePersonPerformed;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companynamePersonPerformed,
                                    ActualValue = companynamePersonPerformed
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = companynamePersonPerformed;
                                updateJobDocumentField.ActualValue = companynamePersonPerformed;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "ApplicantAddress")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            companyAddressPersonPerformed = companyAddressPersonPerformed;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyAddressPersonPerformed,
                                    ActualValue = companyAddressPersonPerformed
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = companyAddressPersonPerformed;
                                updateJobDocumentField.ActualValue = companyAddressPersonPerformed;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lic_No")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = contactLicensePersonPerformed,
                                    ActualValue = contactLicensePersonPerformed
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = contactLicensePersonPerformed;
                                updateJobDocumentField.ActualValue = contactLicensePersonPerformed;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                    else
                    {

                        if (item.Field.FieldName == "Certifier")
                        {
                            int idJobApplicant = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            Contact contact = rpoContext.Contacts.Include("Company.Addresses").Include("Addresses").Where(x => x.Id == idJobApplicant).FirstOrDefault();

                            Company company = contact.Company;
                            Address companyAddress = Common.GetContactAddressForJobDocument(contact);
                            //company != null && company.Addresses != null ? company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;

                            //ContactLicense contactLicense = contact.ContactLicenses.FirstOrDefault();

                            //if (companyAddress == null)
                            //{
                            //    companyAddress = contact != null && contact.Addresses != null ? contact.Addresses.FirstOrDefault(x => x.IsMainAddress == true) : null;
                            //}

                            certifierAddress = company != null ? contact.Company.Name + ", " : string.Empty;
                            string certifierCompanyAddress = companyAddress != null ? companyAddress.Address1 + " " + companyAddress.Address2 + " " + companyAddress.City + (companyAddress.State != null ? " " + companyAddress.State.Acronym : string.Empty) + " " + companyAddress.ZipCode : string.Empty;
                            certifierAddress = certifierAddress + certifierCompanyAddress;

                            string certifierName = contact != null ? contact.FirstName + " " + contact.LastName : string.Empty;
                            //documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(certifierName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(certifierName) ? "Certifier: " + certifierName : string.Empty);
                            documentDescription = "Certifier Name: " + certifierName;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplicant),
                                    ActualValue = contact != null ? contact.FirstName + " " + contact.LastName : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(idJobApplicant);
                                updateJobDocumentField.ActualValue = contact != null ? contact.FirstName + " " + contact.LastName : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Person Who Performed Work")
                        {
                            int certifierid = Convert.ToInt32(frontendFields.Value);
                            Contact contact = rpoContext.Contacts.Include("Company.Addresses").Include("Addresses").Where(x => x.Id == certifierid).FirstOrDefault();

                            Company company = contact.Company;
                            Address companyAddress = Common.GetContactAddressForJobDocument(contact);

                            //company != null && company.Addresses != null ? company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;
                            //if (companyAddress == null)
                            //{
                            //    companyAddress = contact != null && contact.Addresses != null ? contact.Addresses.FirstOrDefault(x => x.IsMainAddress == true) : null;
                            //}

                            companynamePersonPerformed = company != null ? contact.Company.Name : string.Empty;


                            if (company != null && company.CompanyTypes != null && company.CompanyTypes.Where(x => x.ItemName == "General Contractor").Any())
                            {

                                contactLicensePersonPerformed = company.TrackingNumber;
                                contractor = "Yes";
                            }
                            else
                            {
                                ContactLicense contactLicense = contact.ContactLicenses.FirstOrDefault(x => x.ContactLicenseType.Name == "Engineer" || x.ContactLicenseType.Name == "Architect");
                                contactLicensePersonPerformed = contactLicense != null ? contactLicense.Number : string.Empty;
                                architectEngineer = "Yes";
                            }

                            companyAddressPersonPerformed = companyAddress != null ? companyAddress.Address1 + " " + companyAddress.Address2 + " " + companyAddress.City + (companyAddress.State != null ? " " + companyAddress.State.Acronym : string.Empty) + " " + companyAddress.ZipCode : string.Empty;

                            string personWhoPerformedWorkName = contact != null ? contact.FirstName + " " + contact.LastName : string.Empty;
                            //documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(personWhoPerformedWorkName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(personWhoPerformedWorkName) ? "Person Who Performed Work: " + personWhoPerformedWorkName : string.Empty);

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(personWhoPerformedWorkName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(personWhoPerformedWorkName) ? "Person Who Performed Work: " + personWhoPerformedWorkName : string.Empty);
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(certifierid),
                                    ActualValue = contact != null ? contact.FirstName + " " + contact.LastName : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(certifierid);
                                updateJobDocumentField.ActualValue = contact != null ? contact.FirstName + " " + contact.LastName : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Violation #")
                        {
                            int violationId = Convert.ToInt32(frontendFields.Value);
                            JobViolation jobViolation = rpoContext.JobViolations.Where(x => x.Id == violationId).FirstOrDefault();

                            jobDocument.IdJobViolation = violationId;

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = jobViolation.SummonsNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = jobViolation.SummonsNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Optional Description")
                        {
                            //documentDescription = "Optional Additional Description: " + frontendFields.Value;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(documentDescription) ? " | " : string.Empty) + (!string.IsNullOrEmpty(documentDescription) ? "Optional Additional Description: " + frontendFields.Value : string.Empty);
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }


                    }
                }
            }
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();

            // Edit Job Document
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }
        /// <summary>
        /// Generates a  Notice for Proposed Boiler Installation.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.( 3> Notice for Proposed Boiler Installation)</param>
        public static void GenerateNoticeforProposedBoilerInstallation(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            //string documentName = string.Empty;
            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").Include("Contact")
                    .Include("RfpAddress.Borough")
                    .Include("RfpAddress.OwnerContact")
                    .Include("Company.Addresses.AddressType")
                    .Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                string telephoneThird = string.Empty;
                string addressThird = string.Empty;
                string oilBurnerInstaller = "No";
                string masterPlumber = "No";
                string architechOrEngineer = "No";

                foreach (DocumentField item in documentFieldList)
                {

                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - 900A-76289.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Day")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Month")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Year")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Print Name Of PE")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "High Pressure")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Low Pressure")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Steam")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Hot Water")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Commercial")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Mixed Use")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Multiple Dwelling")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Num Res. Units")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "House & Street")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string houseAndStreet = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty;
                            houseAndStreet = houseAndStreet;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = houseAndStreet,
                                    ActualValue = houseAndStreet
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = houseAndStreet;
                                updateJobDocumentField.ActualValue = houseAndStreet;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Borough")
                        {
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Store or Floor")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner")
                        {
                            string owner = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty;
                            owner = owner;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = owner,
                                    ActualValue = owner
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = owner;
                                updateJobDocumentField.ActualValue = owner;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Telephone")
                        {
                            string telephone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;
                            if (telephone == null || telephone == "")
                            {
                                telephone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.MobilePhone : string.Empty;
                            }
                            //string telephone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = telephone,
                                    ActualValue = telephone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = telephone;
                                updateJobDocumentField.ActualValue = telephone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address")
                        {
                            Contact contact = job.RfpAddress.OwnerContact;
                            string companyName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Company != null ? job.RfpAddress.OwnerContact.Company.Name : string.Empty;

                            // Company company = contact.Company;
                            // string companyName = company != null ? company.Name + ", " : string.Empty;
                            Address jobcompanyAddress = Common.GetContactAddressForJobDocument(contact);

                            //if (jobcompanyAddress == null)
                            //{
                            //    jobcompanyAddress = contact.Addresses.FirstOrDefault(x => x.IsMainAddress == true);
                            //}

                            string companyAddress = jobcompanyAddress != null ? jobcompanyAddress.Address1 + " " + jobcompanyAddress.Address2 + " " + jobcompanyAddress.City + (jobcompanyAddress.State != null ? " " + jobcompanyAddress.State.Acronym : string.Empty) + " " + jobcompanyAddress.ZipCode : string.Empty;

                            companyAddress = companyName + companyAddress;
                            companyAddress = companyAddress;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyAddress,
                                    ActualValue = companyAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = companyAddress;
                                updateJobDocumentField.ActualValue = companyAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lessee or Occupant")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Telephone Second")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address Second")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }


                        else if (item.Field.FieldName == "Num Of Boiler Installed")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Modular")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Boiler Manufacturer")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Model Num Units")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BTU Hr Input")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Operating Gauge Pressure")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BTU Hr Output")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Pressure Setting RV")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Water Tube")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Fire Tube")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Fire Coil")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Cast Iron")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Oil")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Gas")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "MEA Approv. Num")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Bur. Manufacturer")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Model Number")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Oil Burner Installer")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = oilBurnerInstaller,
                                    ActualValue = oilBurnerInstaller
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = oilBurnerInstaller;
                                updateJobDocumentField.ActualValue = oilBurnerInstaller;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Master Plumber")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = masterPlumber,
                                    ActualValue = masterPlumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = masterPlumber;
                                updateJobDocumentField.ActualValue = masterPlumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Arch. Or Eng.")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = architechOrEngineer,
                                    ActualValue = architechOrEngineer
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = architechOrEngineer;
                                updateJobDocumentField.ActualValue = architechOrEngineer;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Print Name")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Day2")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Month2")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Year2")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Telephone Third")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = telephoneThird,
                                    ActualValue = telephoneThird
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = telephoneThird;
                                updateJobDocumentField.ActualValue = telephoneThird;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address Third")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = addressThird,
                                    ActualValue = addressThird
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = addressThird;
                                updateJobDocumentField.ActualValue = addressThird;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();

                    }
                    else
                    {
                        if (item.Field.FieldName == "Applicant")
                        {
                            int idJobApplicant = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobContact jobContact = rpoContext.JobContacts.Include("Contact").Where(x => x.Id == idJobApplicant).FirstOrDefault();

                            telephoneThird = Common.GetContactPhoneNumberForJobDocument(jobContact);

                            Address address = Common.GetContactAddressForJobDocument(jobContact);
                            if (address != null && jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null)
                            {
                                addressThird = jobContact.Contact.Company.Name + " " + address.Address1 + " " + address.Address2 + " " + address.City +
                                    " " + address.State.Acronym + " " + address.ZipCode;
                            }
                            else if (address != null)
                            {
                                addressThird = address.Address1 + " " + address.Address2 + " " + address.City +
                                    " " + address.State.Acronym + " " + address.ZipCode;
                            }
                            else
                            {
                                addressThird = string.Empty;
                            }
                            //}
                            //else
                            //{
                            //    addressThird = "*INDIVIDUAL*";
                            //}

                            addressThird = addressThird;

                            string applicationtName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicationtName) ? "Applicant: " + applicationtName : string.Empty);

                            var contactLicenses = jobContact != null && jobContact.Contact != null ? jobContact.Contact.ContactLicenses : null;

                            if (contactLicenses.Where(x => x.ContactLicenseType.Name == "Oil Burner Installer").Any())
                            {
                                oilBurnerInstaller = "Yes";
                            }
                            else if (contactLicenses.Where(x => x.ContactLicenseType.Name == "Master Plumber").Any())
                            {
                                masterPlumber = "Yes";
                            }
                            else if (contactLicenses.Where(x => x.ContactLicenseType.Name == "Architect" || x.ContactLicenseType.Name == "Engineer").Any())
                            {
                                architechOrEngineer = "Yes";
                            }

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplicant),
                                    ActualValue = applicationtName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplicant);
                                updateJobDocumentField.ActualValue = applicationtName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Application Type")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();

                            //documentName = jobApplication != null && !string.IsNullOrEmpty(jobApplication.FloorWorking) ? "FL: " + jobApplication.FloorWorking : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);

                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }

                    }
                }
            }


            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            // Generate Job Document
            GenerateJobDocument(idJobDocument);
        }

        public static void EditNoticeforProposedBoilerInstallation(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            //string documentName = string.Empty;
            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").Include("Contact")
                    .Include("RfpAddress.Borough")
                    .Include("RfpAddress.OwnerContact")
                    .Include("Company.Addresses.AddressType")
                    .Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                string telephoneThird = string.Empty;
                string addressThird = string.Empty;
                string oilBurnerInstaller = "No";
                string masterPlumber = "No";
                string architechOrEngineer = "No";

                foreach (DocumentField item in documentFieldList)
                {

                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - 900A-76289.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "House & Street")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string houseAndStreet = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty;
                            houseAndStreet = houseAndStreet;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = houseAndStreet,
                                    ActualValue = houseAndStreet
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = houseAndStreet;
                                updateJobDocumentField.ActualValue = houseAndStreet;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Borough")
                        {
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Owner")
                        {
                            string owner = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty;
                            owner = owner;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = owner,
                                    ActualValue = owner
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = owner;
                                updateJobDocumentField.ActualValue = owner;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Telephone")
                        {
                            string telephone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;
                            if (telephone == null || telephone == "")
                            {
                                telephone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.MobilePhone : string.Empty;
                            }
                            //string telephone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = telephone,
                                    ActualValue = telephone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = telephone;
                                updateJobDocumentField.ActualValue = telephone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address")
                        {
                            Contact contact = job.RfpAddress.OwnerContact;
                            string companyName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Company != null ? job.RfpAddress.OwnerContact.Company.Name : string.Empty;

                            // Company company = contact.Company;
                            // string companyName = company != null ? company.Name + ", " : string.Empty;
                            Address jobcompanyAddress = Common.GetContactAddressForJobDocument(contact);

                            //if (jobcompanyAddress == null)
                            //{
                            //    jobcompanyAddress = contact.Addresses.FirstOrDefault(x => x.IsMainAddress == true);
                            //}

                            string companyAddress = jobcompanyAddress != null ? jobcompanyAddress.Address1 + " " + jobcompanyAddress.Address2 + " " + jobcompanyAddress.City + (jobcompanyAddress.State != null ? " " + jobcompanyAddress.State.Acronym : string.Empty) + " " + jobcompanyAddress.ZipCode : string.Empty;

                            companyAddress = companyName + companyAddress;
                            companyAddress = companyAddress;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyAddress,
                                    ActualValue = companyAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = companyAddress;
                                updateJobDocumentField.ActualValue = companyAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }


                        else if (item.Field.FieldName == "Oil Burner Installer")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = oilBurnerInstaller,
                                    ActualValue = oilBurnerInstaller
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = oilBurnerInstaller;
                                updateJobDocumentField.ActualValue = oilBurnerInstaller;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Master Plumber")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = masterPlumber,
                                    ActualValue = masterPlumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = masterPlumber;
                                updateJobDocumentField.ActualValue = masterPlumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Arch. Or Eng.")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = architechOrEngineer,
                                    ActualValue = architechOrEngineer
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = architechOrEngineer;
                                updateJobDocumentField.ActualValue = architechOrEngineer;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Telephone Third")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = telephoneThird,
                                    ActualValue = telephoneThird
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = telephoneThird;
                                updateJobDocumentField.ActualValue = telephoneThird;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address Third")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = addressThird,
                                    ActualValue = addressThird
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = addressThird;
                                updateJobDocumentField.ActualValue = addressThird;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();

                    }
                    else
                    {
                        if (item.Field.FieldName == "Applicant")
                        {
                            int idJobApplicant = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobContact jobContact = rpoContext.JobContacts.Include("Contact").Where(x => x.Id == idJobApplicant).FirstOrDefault();

                            telephoneThird = Common.GetContactPhoneNumberForJobDocument(jobContact);

                            Address address = Common.GetContactAddressForJobDocument(jobContact);
                            if (address != null && jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null)
                            {
                                addressThird = jobContact.Contact.Company.Name + " " + address.Address1 + " " + address.Address2 + " " + address.City +
                                    " " + address.State.Acronym + " " + address.ZipCode;
                            }
                            else if (address != null)
                            {
                                addressThird = address.Address1 + " " + address.Address2 + " " + address.City +
                                    " " + address.State.Acronym + " " + address.ZipCode;
                            }
                            else
                            {
                                addressThird = string.Empty;
                            }
                            //}
                            //else
                            //{
                            //    addressThird = "*INDIVIDUAL*";
                            //}

                            addressThird = addressThird;

                            string applicationtName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicationtName) ? "Applicant: " + applicationtName : string.Empty);

                            var contactLicenses = jobContact != null && jobContact.Contact != null ? jobContact.Contact.ContactLicenses : null;

                            if (contactLicenses.Where(x => x.ContactLicenseType.Name == "Oil Burner Installer").Any())
                            {
                                oilBurnerInstaller = "Yes";
                            }
                            else if (contactLicenses.Where(x => x.ContactLicenseType.Name == "Master Plumber").Any())
                            {
                                masterPlumber = "Yes";
                            }
                            else if (contactLicenses.Where(x => x.ContactLicenseType.Name == "Architect" || x.ContactLicenseType.Name == "Engineer").Any())
                            {
                                architechOrEngineer = "Yes";
                            }

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplicant),
                                    ActualValue = applicationtName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(idJobApplicant);
                                updateJobDocumentField.ActualValue = applicationtName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Application Type")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();

                            //documentName = jobApplication != null && !string.IsNullOrEmpty(jobApplication.FloorWorking) ? "FL: " + jobApplication.FloorWorking : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);

                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }

                    }
                }
            }

            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            // Generate Job Document
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }


        /// <summary>
        /// Generates a  Additional Information Form AI-1 for Final Survey.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.( 8> Additional Information Form AI-1 for Final Survey)</param>
        public static void GenerateAI1forFinalSurvey(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").Include("Contact").Include("RfpAddress.Borough").Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();
                foreach (DocumentField item in documentFieldList)
                {

                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);


                    if (frontendFields == null)
                    {

                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - AI1FS-62407.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Sheet")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "1",
                                    ActualValue = "1"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = "1";
                                updateJobDocumentField.ActualValue = "1";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        if (item.Field.FieldName == "Of")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "1",
                                    ActualValue = "1"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = "1";
                                updateJobDocumentField.ActualValue = "1";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        if (item.Field.FieldName == "DocNo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "HouseNo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Street")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Boro")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Block")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Lot")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Bin")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "CB")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "OPTPw1")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "No",  // You Can set Yes Or No
                                    ActualValue = "No"  // You Can set Yes Or No
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = "No";
                                updateJobDocumentField.ActualValue = "No";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "OPTA1Con")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "",  // You Can set Yes Or No
                                    ActualValue = ""  // You Can set Yes Or No
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "SignatureDate")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "",
                                    ActualValue = ""
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Description")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = item.StaticDescription,
                                    ActualValue = item.StaticDescription
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = item.StaticDescription;
                                updateJobDocumentField.ActualValue = item.StaticDescription;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();

                    }
                    else
                    {
                        if (item.Field.FieldName == "Applicant")
                        {
                            int idJobApplicant = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobContact jobContact = rpoContext.JobContacts.Include("Contact").Where(x => x.Id == idJobApplicant).FirstOrDefault();

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(applicantName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplicant),
                                    ActualValue = applicantName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplicant);
                                updateJobDocumentField.ActualValue = applicantName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Job Number")
                        {

                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            jobDocument.IdJobApplication = idJobApplication;

                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (item.Field.FieldName == "Additional Description" && !string.IsNullOrEmpty(frontendFields.Value))
                            {
                                documentDescription = documentDescription + " | Additional Description: " + frontendFields.Value;
                            }
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }

                    }
                }
            }

            // Generate Job Document
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();

            GenerateJobDocument(idJobDocument);
        }

        public static void EditAI1forFinalSurvey(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").Include("Contact").Include("RfpAddress.Borough").Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();
                foreach (DocumentField item in documentFieldList)
                {

                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);


                    if (frontendFields == null)
                    {

                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - AI1FS-62407.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Sheet")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "1",
                                    ActualValue = "1"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = "1";
                                updateJobDocumentField.ActualValue = "1";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        if (item.Field.FieldName == "Of")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "1",
                                    ActualValue = "1"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = "1";
                                updateJobDocumentField.ActualValue = "1";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        if (item.Field.FieldName == "HouseNo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Street")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Boro")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Block")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Lot")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Bin")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "CB")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "OPTPw1")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "No",  // You Can set Yes Or No
                                    ActualValue = "No"  // You Can set Yes Or No
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = "No";
                                updateJobDocumentField.ActualValue = "No";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }


                        else if (item.Field.FieldName == "Description")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = item.StaticDescription,
                                    ActualValue = item.StaticDescription
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = item.StaticDescription;
                                updateJobDocumentField.ActualValue = item.StaticDescription;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();

                    }
                    else
                    {
                        if (item.Field.FieldName == "Applicant")
                        {
                            int idJobApplicant = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobContact jobContact = rpoContext.JobContacts.Include("Contact").Where(x => x.Id == idJobApplicant).FirstOrDefault();

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(applicantName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplicant),
                                    ActualValue = applicantName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(idJobApplicant);
                                updateJobDocumentField.ActualValue = applicantName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Job Number")
                        {

                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            jobDocument.IdJobApplication = idJobApplication;

                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (item.Field.FieldName == "Additional Description" && !string.IsNullOrEmpty(frontendFields.Value))
                            {
                                documentDescription = documentDescription + " | Additional Description: " + frontendFields.Value;
                            }
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }

                    }
                }
            }
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            // Generate Job Document
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }

        /// <summary>
        /// es the Certificate Of Application for Registration.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.(10> Application for Registration)</param>
        public static void GenerateCertificateOfApplicationForRegistration(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact").
                    Include("RfpAddress.OwnerContact.Addresses").
                    Include("RfpAddress.OwnerContact.Company").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();
                foreach (DocumentField item in documentFieldList)
                {

                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "FeeEnclosed")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "JobFileInfo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - APC501-62409.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Address")
                        {
                            string address = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty;
                            address = address;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = address,
                                    ActualValue = address
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = address;
                                updateJobDocumentField.ActualValue = address;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Borough")
                        {
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Block")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Lot")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        if (item.Field.FieldName == "NumberApts")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Make")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "BurnerMake")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }


                        if (item.Field.FieldName == "Model")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "BurnerModel")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "NumberIdUnits")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "MaxInputRating")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "GrossOutput")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "FiringRate_GPH")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "FiringRate_CFPH")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty


                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Oil")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Gas")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "New")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Existing")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Registered")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "NotRegistered")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "InstallationNumber")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        if (item.Field.FieldName == "Hrs/Day")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Days/Week")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Weeks/Year")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Make1")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Model1")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "MaxInputRating1")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Make2")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Model2")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "MaxInputRating2")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Make3")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Model3")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "MaxInputRating3")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "OwnerName")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Date")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        if (item.Field.FieldName == "CompanyAddress")
                        {
                            Contact contact = job != null && job.RfpAddress != null ? job.RfpAddress.OwnerContact : null;
                            Company company = contact.Company;
                            Address jobCompanyAddresses = Common.GetContactAddressForJobDocument(contact);

                            string companyName = company != null ? company.Name + ", " : string.Empty;
                            string companyAddresses = companyName + (jobCompanyAddresses != null && jobCompanyAddresses.State != null ? jobCompanyAddresses.Address1 + System.Environment.NewLine + jobCompanyAddresses.Address2 + System.Environment.NewLine + jobCompanyAddresses.City + (jobCompanyAddresses.State != null ? " " + jobCompanyAddresses.State.Acronym : string.Empty) + " " + jobCompanyAddresses.ZipCode : string.Empty);
                            companyAddresses = companyAddresses;

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyAddresses,
                                    ActualValue = companyAddresses
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = companyAddresses;
                                updateJobDocumentField.ActualValue = companyAddresses;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "OwnerPhoneNumber")
                        {
                            //string ownerPhoneNumber = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;
                            string ownerPhoneNumber = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;
                            if (ownerPhoneNumber == null || ownerPhoneNumber == "")
                            {
                                ownerPhoneNumber = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.MobilePhone : string.Empty;
                            }
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerPhoneNumber,
                                    ActualValue = ownerPhoneNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerPhoneNumber;
                                updateJobDocumentField.ActualValue = ownerPhoneNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();

                    }
                    else
                    {
                        if (item.Field.FieldName == "Additional Description")
                        {
                            documentDescription = "Additional Description: " + frontendFields.Value;
                        }

                        JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                        if (updateJobDocumentField == null)
                        {
                            JobDocumentField JobDocumentField = new JobDocumentField
                            {
                                IdJobDocument = idJobDocument,
                                IdDocumentField = frontendFields.IdDocumentField,
                                Value = frontendFields.Value,
                                ActualValue = frontendFields.Value
                            };
                            rpoContext.JobDocumentFields.Add(JobDocumentField);
                        }
                        else
                        {
                            updateJobDocumentField.Value = frontendFields.Value;
                            updateJobDocumentField.ActualValue = frontendFields.Value;
                            rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                            rpoContext.SaveChanges();
                        }
                        rpoContext.SaveChanges();

                    }
                }
            }

            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();

            // Generate Job Document
            GenerateJobDocument(idJobDocument);
        }


        public static void EditCertificateOfApplicationForRegistration(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact").
                    Include("RfpAddress.OwnerContact.Addresses").
                    Include("RfpAddress.OwnerContact.Company").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();
                foreach (DocumentField item in documentFieldList)
                {

                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {

                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - APC501-62409.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Address")
                        {
                            string address = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty;
                            address = address;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = address,
                                    ActualValue = address
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = address;
                                updateJobDocumentField.ActualValue = address;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Borough")
                        {
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Block")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Lot")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }






                        if (item.Field.FieldName == "OwnerName")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "CompanyAddress")
                        {
                            Contact contact = job != null && job.RfpAddress != null ? job.RfpAddress.OwnerContact : null;
                            Company company = contact.Company;
                            Address jobCompanyAddresses = Common.GetContactAddressForJobDocument(contact);

                            string companyName = company != null ? company.Name + ", " : string.Empty;
                            string companyAddresses = companyName + (jobCompanyAddresses != null && jobCompanyAddresses.State != null ? jobCompanyAddresses.Address1 + System.Environment.NewLine + jobCompanyAddresses.Address2 + System.Environment.NewLine + jobCompanyAddresses.City + (jobCompanyAddresses.State != null ? " " + jobCompanyAddresses.State.Acronym : string.Empty) + " " + jobCompanyAddresses.ZipCode : string.Empty);
                            companyAddresses = companyAddresses;

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyAddresses,
                                    ActualValue = companyAddresses
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = companyAddresses;
                                updateJobDocumentField.ActualValue = companyAddresses;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "OwnerPhoneNumber")
                        {
                            //string ownerPhoneNumber = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;
                            string ownerPhoneNumber = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;
                            if (ownerPhoneNumber == null || ownerPhoneNumber == "")
                            {
                                ownerPhoneNumber = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.MobilePhone : string.Empty;
                            }
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerPhoneNumber,
                                    ActualValue = ownerPhoneNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = ownerPhoneNumber;
                                updateJobDocumentField.ActualValue = ownerPhoneNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();

                    }
                    else
                    {
                        if (item.Field.FieldName == "Additional Description")
                        {
                            documentDescription = "Additional Description: " + frontendFields.Value;
                        }

                        JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                        if (updateJobDocumentField == null)
                        {
                            JobDocumentField JobDocumentField = new JobDocumentField
                            {
                                IdJobDocument = idJobDocument,
                                IdDocumentField = frontendFields.IdDocumentField,
                                Value = frontendFields.Value,
                                ActualValue = frontendFields.Value
                            };
                            rpoContext.JobDocumentFields.Add(JobDocumentField);
                        }
                        else
                        {
                            updateJobDocumentField.Value = frontendFields.Value;
                            updateJobDocumentField.ActualValue = frontendFields.Value;
                            rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                            rpoContext.SaveChanges();
                        }
                        rpoContext.SaveChanges();

                    }
                }
            }
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;

            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();

            // Edit Job Document
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }
        /// <summary>
        /// es the Application for Inspection Prior to Demolition.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.(15> Application for Inspection Prior to Demolition)</param>
        public static void GenerateApplicationforInspectionPriortoDemolition(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                string applicantEmail = string.Empty;
                string applicantPhone = string.Empty;
                string applicantCompany = string.Empty;


                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);

                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - B2A-62420.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "NumberStructures")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Company")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompany,
                                    ActualValue = applicantCompany
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompany;
                                updateJobDocumentField.ActualValue = applicantCompany;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }


                        else if (item.Field.FieldName == "Date")
                        {
                            DateTime time = DateTime.Now;
                            string format = "MM/dd/yy";
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = time.ToString(format),
                                    ActualValue = time.ToString(format)
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = time.ToString(format);
                                updateJobDocumentField.ActualValue = time.ToString(format);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "opgBoro")
                        {

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? Convert.ToString(job.RfpAddress.Borough.BisCode) : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? Convert.ToString(job.RfpAddress.Borough.BisCode) : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? Convert.ToString(job.RfpAddress.Borough.BisCode) : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? Convert.ToString(job.RfpAddress.Borough.BisCode) : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "opgStructureType")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }


                        else if (item.Field.FieldName == "txtOther")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "txtAddress")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "opgLegalizing")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CrossStreets")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BIN")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Block")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "AKA")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OtherBISNumbers")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Distance")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "opgMechanicalDemolition")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Fax")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "EMail")
                        {

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantEmail,
                                    ActualValue = applicantEmail
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantEmail;
                                updateJobDocumentField.ActualValue = applicantEmail;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "Phone")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantPhone,
                                    ActualValue = applicantPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantPhone;
                                updateJobDocumentField.ActualValue = applicantPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();

                    }
                    else
                    {

                        if (item.Field.FieldName == "Applicant")
                        {
                            int certifierid = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.Where(x => x.Id == certifierid).FirstOrDefault();

                            Address compnayAddress = jobContact != null && jobContact.Company != null && jobContact.Company.Addresses != null ? jobContact.Company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;
                            applicantCompany = jobContact != null && jobContact.Company != null ? jobContact.Company.Name : string.Empty;
                            applicantPhone = Common.GetContactPhoneNumberForJobDocument(jobContact);

                            applicantEmail = jobContact != null && jobContact.Contact != null ? jobContact.Contact.Email : string.Empty;

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(certifierid),
                                    ActualValue = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);

                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(certifierid);
                                updateJobDocumentField.ActualValue = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                            rpoContext.SaveChanges();
                        }
                        else if (item.Field.FieldName == "Application Type")
                        {
                            int idJobApplication = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                            rpoContext.SaveChanges();
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                            rpoContext.SaveChanges();

                        }
                    }
                }
            }

            // Generate Job Document
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();

            GenerateJobDocument(idJobDocument);
        }

        public static void EditApplicationforInspectionPriortoDemolition(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                string applicantEmail = string.Empty;
                string applicantPhone = string.Empty;
                string applicantCompany = string.Empty;


                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);

                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - B2A-62420.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Company")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompany,
                                    ActualValue = applicantCompany
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompany;
                                updateJobDocumentField.ActualValue = applicantCompany;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }


                        else if (item.Field.FieldName == "Date")
                        {
                            DateTime time = DateTime.Now;
                            string format = "MM/dd/yy";
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = time.ToString(format),
                                    ActualValue = time.ToString(format)
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = time.ToString(format);
                                updateJobDocumentField.ActualValue = time.ToString(format);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "opgBoro")
                        {

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? Convert.ToString(job.RfpAddress.Borough.BisCode) : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? Convert.ToString(job.RfpAddress.Borough.BisCode) : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? Convert.ToString(job.RfpAddress.Borough.BisCode) : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? Convert.ToString(job.RfpAddress.Borough.BisCode) : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "txtAddress")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BIN")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Block")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "EMail")
                        {

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantEmail,
                                    ActualValue = applicantEmail
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantEmail;
                                updateJobDocumentField.ActualValue = applicantEmail;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "Phone")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantPhone,
                                    ActualValue = applicantPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantPhone;
                                updateJobDocumentField.ActualValue = applicantPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();

                    }
                    else
                    {

                        if (item.Field.FieldName == "Applicant")
                        {
                            int certifierid = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.Where(x => x.Id == certifierid).FirstOrDefault();

                            Address compnayAddress = jobContact != null && jobContact.Company != null && jobContact.Company.Addresses != null ? jobContact.Company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;
                            applicantCompany = jobContact != null && jobContact.Company != null ? jobContact.Company.Name : string.Empty;
                            applicantPhone = Common.GetContactPhoneNumberForJobDocument(jobContact);

                            applicantEmail = jobContact != null && jobContact.Contact != null ? jobContact.Contact.Email : string.Empty;

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(certifierid),
                                    ActualValue = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);

                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(certifierid);
                                updateJobDocumentField.ActualValue = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                            rpoContext.SaveChanges();
                        }
                        else if (item.Field.FieldName == "Application Type")
                        {
                            int idJobApplication = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                            rpoContext.SaveChanges();
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                            rpoContext.SaveChanges();

                        }
                    }
                }
            }
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            // Edit Job Document
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();

            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }

        /// <summary>
        /// Generates the applicationfor best recommendationfor mechanical means demolition.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.</param>
        public static void GenerateApplicationforBestRecommendationforMechanicalMeansDemolition(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            string documentName = string.Empty;

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                string applicantEmail = string.Empty;
                string applicantPhone = string.Empty;
                string applicantTitle = string.Empty;
                string applicantCompany = string.Empty;

                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - BEST4-62435.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "NumberStructures")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Company")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompany,
                                    ActualValue = applicantCompany
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompany;
                                updateJobDocumentField.ActualValue = applicantCompany;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        //if (item.Field.FieldName == "EMail")
                        //{
                        //    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = job != null && job.Contact != null ? job.Contact.Email : string.Empty,
                        //            ActualValue = job != null && job.Contact != null ? job.Contact.Email : string.Empty
                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = job != null && job.Contact != null ? job.Contact.Email : string.Empty;
                        //        updateJobDocumentField.ActualValue = job != null && job.Contact != null ? job.Contact.Email : string.Empty;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        //if (item.Field.FieldName == "Phone")
                        //{
                        //    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = job != null && job.Contact != null ? job.Contact.MobilePhone : string.Empty,
                        //            ActualValue = job != null && job.Contact != null ? job.Contact.MobilePhone : string.Empty
                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = job != null && job.Contact != null ? job.Contact.MobilePhone : string.Empty;
                        //        updateJobDocumentField.ActualValue = job != null && job.Contact != null ? job.Contact.MobilePhone : string.Empty;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        else if (item.Field.FieldName == "EMail")
                        {

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantEmail,
                                    ActualValue = applicantEmail
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantEmail;
                                updateJobDocumentField.ActualValue = applicantEmail;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "Phone")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantPhone,
                                    ActualValue = applicantPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantPhone;
                                updateJobDocumentField.ActualValue = applicantPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Title")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantTitle,
                                    ActualValue = applicantTitle
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantTitle;
                                updateJobDocumentField.ActualValue = applicantTitle;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Fax")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        if (item.Field.FieldName == "Date")
                        {
                            DateTime time = DateTime.Now;
                            string format = "MM/dd/yy";
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = time.ToString(format),
                                    ActualValue = time.ToString(format)
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = time.ToString(format);
                                updateJobDocumentField.ActualValue = time.ToString(format);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "txtOther")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "txtAddress")
                        {
                            string address = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty;
                            address = address;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {

                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = address,
                                    ActualValue = address

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = address;
                                updateJobDocumentField.ActualValue = address;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "CrossStreets")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "BIN")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Block")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Lot")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "AKA")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "JobNo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null ? job.JobNumber : string.Empty,
                                    ActualValue = job != null ? job.JobNumber : string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null ? job.JobNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null ? job.JobNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        if (item.Field.FieldName == "chk2")
                        {
                            string checkboxChecked = "No";
                            if (job != null && job.RfpAddress != null && job.RfpAddress.Borough != null && job.RfpAddress.Borough.BisCode == 2)
                            {
                                checkboxChecked = "Yes";
                            }
                            else
                            {
                                checkboxChecked = "No";
                            }

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = Convert.ToString(checkboxChecked),
                                    ActualValue = Convert.ToString(checkboxChecked)

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(checkboxChecked);
                                updateJobDocumentField.ActualValue = Convert.ToString(checkboxChecked);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "chk3")
                        {
                            string checkboxChecked = "No";
                            if (job != null && job.RfpAddress != null && job.RfpAddress.Borough != null && job.RfpAddress.Borough.BisCode == 3)
                            {
                                checkboxChecked = "Yes";
                            }
                            else
                            {
                                checkboxChecked = "No";
                            }

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = Convert.ToString(checkboxChecked),
                                    ActualValue = Convert.ToString(checkboxChecked)

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(checkboxChecked);
                                updateJobDocumentField.ActualValue = Convert.ToString(checkboxChecked);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "chk1")
                        {
                            string checkboxChecked = "No";
                            if (job != null && job.RfpAddress != null && job.RfpAddress.Borough != null && job.RfpAddress.Borough.BisCode == 1)
                            {
                                checkboxChecked = "Yes";
                            }
                            else
                            {
                                checkboxChecked = "No";
                            }

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = Convert.ToString(checkboxChecked),
                                    ActualValue = Convert.ToString(checkboxChecked)

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(checkboxChecked);
                                updateJobDocumentField.ActualValue = Convert.ToString(checkboxChecked);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "chk4")
                        {
                            string checkboxChecked = "No";
                            if (job != null && job.RfpAddress != null && job.RfpAddress.Borough != null && job.RfpAddress.Borough.BisCode == 4)
                            {
                                checkboxChecked = "Yes";
                            }
                            else
                            {
                                checkboxChecked = "No";
                            }

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = Convert.ToString(checkboxChecked),
                                    ActualValue = Convert.ToString(checkboxChecked)

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(checkboxChecked);
                                updateJobDocumentField.ActualValue = Convert.ToString(checkboxChecked);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "chk5")
                        {
                            string checkboxChecked = "No";
                            if (job != null && job.RfpAddress != null && job.RfpAddress.Borough != null && job.RfpAddress.Borough.BisCode == 5)
                            {
                                checkboxChecked = "Yes";
                            }
                            else
                            {
                                checkboxChecked = "No";
                            }

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = Convert.ToString(checkboxChecked),
                                    ActualValue = Convert.ToString(checkboxChecked)

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(checkboxChecked);
                                updateJobDocumentField.ActualValue = Convert.ToString(checkboxChecked);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();

                    }
                    else
                    {
                        if (item.Field.FieldName == "Applicant")
                        {
                            int idApplicant = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.Where(x => x.Id == idApplicant).FirstOrDefault();

                            applicantTitle = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactTitle != null ? jobContact.Contact.ContactTitle.Name : string.Empty;
                            applicantTitle = applicantTitle != null ? applicantTitle : string.Empty;

                            string applicant = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            applicant = applicant != null ? applicant : string.Empty;
                            //Address compnayAddress = Common.GetContactAddressForJobDocument(jobContact);
                            //applicantCompany = compnayAddress != null && compnayAddress.Company != null ? compnayAddress.Company.Name : string.Empty;
                            applicantCompany = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;

                            applicantPhone = Common.GetContactPhoneNumberForJobDocument(jobContact);
                            applicantEmail = jobContact != null && jobContact.Contact != null ? jobContact.Contact.Email : string.Empty;
                            applicantEmail = applicantEmail != null ? applicantEmail : string.Empty;

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicant) ? "Applicant: " + applicant : string.Empty);

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idApplicant),
                                    ActualValue = applicant,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idApplicant);
                                updateJobDocumentField.ActualValue = applicant;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Application Type")
                        {
                            int idApplicantion = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idApplicantion).FirstOrDefault();
                            documentName = jobApplication != null && !string.IsNullOrEmpty(jobApplication.FloorWorking) ? "FL: " + jobApplication.FloorWorking : string.Empty;

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idApplicantion),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idApplicantion);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }

            // Generate Job Document

            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateJobDocument(idJobDocument);
        }

        public static void EditApplicationforBestRecommendationforMechanicalMeansDemolition(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            string documentName = string.Empty;

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                string applicantEmail = string.Empty;
                string applicantPhone = string.Empty;
                string applicantTitle = string.Empty;
                string applicantCompany = string.Empty;

                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - BEST4-62435.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        if (item.Field.FieldName == "Company")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompany,
                                    ActualValue = applicantCompany
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompany;
                                updateJobDocumentField.ActualValue = applicantCompany;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        //if (item.Field.FieldName == "EMail")
                        //{
                        //    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = job != null && job.Contact != null ? job.Contact.Email : string.Empty,
                        //            ActualValue = job != null && job.Contact != null ? job.Contact.Email : string.Empty
                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = job != null && job.Contact != null ? job.Contact.Email : string.Empty;
                        //        updateJobDocumentField.ActualValue = job != null && job.Contact != null ? job.Contact.Email : string.Empty;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        //if (item.Field.FieldName == "Phone")
                        //{
                        //    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = job != null && job.Contact != null ? job.Contact.MobilePhone : string.Empty,
                        //            ActualValue = job != null && job.Contact != null ? job.Contact.MobilePhone : string.Empty
                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = job != null && job.Contact != null ? job.Contact.MobilePhone : string.Empty;
                        //        updateJobDocumentField.ActualValue = job != null && job.Contact != null ? job.Contact.MobilePhone : string.Empty;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        else if (item.Field.FieldName == "EMail")
                        {

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantEmail,
                                    ActualValue = applicantEmail
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantEmail;
                                updateJobDocumentField.ActualValue = applicantEmail;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "Phone")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantPhone,
                                    ActualValue = applicantPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantPhone;
                                updateJobDocumentField.ActualValue = applicantPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Title")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantTitle,
                                    ActualValue = applicantTitle
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantTitle;
                                updateJobDocumentField.ActualValue = applicantTitle;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        if (item.Field.FieldName == "Date")
                        {
                            DateTime time = DateTime.Now;
                            string format = "MM/dd/yy";
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = time.ToString(format),
                                    ActualValue = time.ToString(format)
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = time.ToString(format);
                                updateJobDocumentField.ActualValue = time.ToString(format);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "txtAddress")
                        {
                            string address = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty;
                            address = address;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {

                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = address,
                                    ActualValue = address

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = address;
                                updateJobDocumentField.ActualValue = address;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "BIN")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Block")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Lot")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "JobNo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null ? job.JobNumber : string.Empty,
                                    ActualValue = job != null ? job.JobNumber : string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null ? job.JobNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null ? job.JobNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        if (item.Field.FieldName == "chk2")
                        {
                            string checkboxChecked = "No";
                            if (job != null && job.RfpAddress != null && job.RfpAddress.Borough != null && job.RfpAddress.Borough.BisCode == 2)
                            {
                                checkboxChecked = "Yes";
                            }
                            else
                            {
                                checkboxChecked = "No";
                            }

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = Convert.ToString(checkboxChecked),
                                    ActualValue = Convert.ToString(checkboxChecked)

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(checkboxChecked);
                                updateJobDocumentField.ActualValue = Convert.ToString(checkboxChecked);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "chk3")
                        {
                            string checkboxChecked = "No";
                            if (job != null && job.RfpAddress != null && job.RfpAddress.Borough != null && job.RfpAddress.Borough.BisCode == 3)
                            {
                                checkboxChecked = "Yes";
                            }
                            else
                            {
                                checkboxChecked = "No";
                            }

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = Convert.ToString(checkboxChecked),
                                    ActualValue = Convert.ToString(checkboxChecked)

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(checkboxChecked);
                                updateJobDocumentField.ActualValue = Convert.ToString(checkboxChecked);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "chk1")
                        {
                            string checkboxChecked = "No";
                            if (job != null && job.RfpAddress != null && job.RfpAddress.Borough != null && job.RfpAddress.Borough.BisCode == 1)
                            {
                                checkboxChecked = "Yes";
                            }
                            else
                            {
                                checkboxChecked = "No";
                            }

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = Convert.ToString(checkboxChecked),
                                    ActualValue = Convert.ToString(checkboxChecked)

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(checkboxChecked);
                                updateJobDocumentField.ActualValue = Convert.ToString(checkboxChecked);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "chk4")
                        {
                            string checkboxChecked = "No";
                            if (job != null && job.RfpAddress != null && job.RfpAddress.Borough != null && job.RfpAddress.Borough.BisCode == 4)
                            {
                                checkboxChecked = "Yes";
                            }
                            else
                            {
                                checkboxChecked = "No";
                            }

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = Convert.ToString(checkboxChecked),
                                    ActualValue = Convert.ToString(checkboxChecked)

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(checkboxChecked);
                                updateJobDocumentField.ActualValue = Convert.ToString(checkboxChecked);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "chk5")
                        {
                            string checkboxChecked = "No";
                            if (job != null && job.RfpAddress != null && job.RfpAddress.Borough != null && job.RfpAddress.Borough.BisCode == 5)
                            {
                                checkboxChecked = "Yes";
                            }
                            else
                            {
                                checkboxChecked = "No";
                            }

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = Convert.ToString(checkboxChecked),
                                    ActualValue = Convert.ToString(checkboxChecked)

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(checkboxChecked);
                                updateJobDocumentField.ActualValue = Convert.ToString(checkboxChecked);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();

                    }
                    else
                    {
                        if (item.Field.FieldName == "Applicant")
                        {
                            int idApplicant = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.Where(x => x.Id == idApplicant).FirstOrDefault();

                            applicantTitle = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactTitle != null ? jobContact.Contact.ContactTitle.Name : string.Empty;
                            applicantTitle = applicantTitle != null ? applicantTitle : string.Empty;

                            string applicant = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            applicant = applicant != null ? applicant : string.Empty;
                            //Address compnayAddress = Common.GetContactAddressForJobDocument(jobContact);
                            //applicantCompany = compnayAddress != null && compnayAddress.Company != null ? compnayAddress.Company.Name : string.Empty;
                            applicantCompany = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;

                            applicantPhone = Common.GetContactPhoneNumberForJobDocument(jobContact);
                            applicantEmail = jobContact != null && jobContact.Contact != null ? jobContact.Contact.Email : string.Empty;
                            applicantEmail = applicantEmail != null ? applicantEmail : string.Empty;

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicant) ? "Applicant: " + applicant : string.Empty);

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idApplicant),
                                    ActualValue = applicant,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(idApplicant);
                                updateJobDocumentField.ActualValue = applicant;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Application Type")
                        {
                            int idApplicantion = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idApplicantion).FirstOrDefault();
                            documentName = jobApplication != null && !string.IsNullOrEmpty(jobApplication.FloorWorking) ? "FL: " + jobApplication.FloorWorking : string.Empty;

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idApplicantion),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(idApplicantion);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }

            // Edit Job Document
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }

        /// <summary>
        /// DEP Registration for Demolition Form AR 299/300
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.(34> DEP Registration for Demolition Form AR 299/300)</param>
        public static void GenerateRequestforDEPRegistrationforDemolitionFormAR(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                // Address companyAddress = job != null && job.Company != null && job.Company.Addresses != null ? job.Company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;
                string applicationNumber = string.Empty;
                string applicantTitle = string.Empty;

                string businessCompanyName = string.Empty;
                string businessPhone = string.Empty;
                string businessAddress = string.Empty;
                string businessFax = string.Empty;
                string businessCity = string.Empty;
                string businessState = string.Empty;
                string businessZip = string.Empty;
                //string contactMobilePhone = string.Empty;
                string contactEmail = string.Empty;
                foreach (DocumentField item in documentFieldList)
                {

                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        string premisesAddress = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty;
                        if (item.Field.FieldName == "PremisesAddress")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = premisesAddress,
                                    ActualValue = premisesAddress,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = premisesAddress;
                                updateJobDocumentField.ActualValue = premisesAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "JobFileInfo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - DEPRFD-62442.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Boro")
                        {
                            string boro = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = boro,
                                    ActualValue = boro,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = boro;
                                updateJobDocumentField.ActualValue = boro;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Building or Structure Type")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Stories")
                        {
                            string stories = job != null && job.RfpAddress != null ? Convert.ToString(job.RfpAddress.Stories) : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = stories,
                                    ActualValue = stories,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = stories;
                                updateJobDocumentField.ActualValue = stories;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PremisesCity")
                        {
                            string premisesCity = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = premisesCity,
                                    ActualValue = premisesCity
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = premisesCity;
                                updateJobDocumentField.ActualValue = premisesCity;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PremisesState")
                        {
                            string premisesState = "NY";
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = premisesState,
                                    ActualValue = premisesState
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = premisesState;
                                updateJobDocumentField.ActualValue = premisesState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PremisesZip")
                        {
                            string premisesZip = job != null && job.RfpAddress != null ? job.RfpAddress.ZipCode : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = premisesZip,
                                    ActualValue = premisesZip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = premisesZip;
                                updateJobDocumentField.ActualValue = premisesZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FloorArea")
                        {
                            //string grossArea = job != null && job.RfpAddress != null ? job.RfpAddress.GrossArea : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "StreetFrontage")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BuildingFrontage")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Days")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "DWM")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "JobNo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicationNumber,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicationNumber;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "DateIssued")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "DOB_Permit_yes")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "DOB_Permit_no")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Company")
                        {

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessCompanyName,
                                    ActualValue = businessCompanyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = businessCompanyName;
                                updateJobDocumentField.ActualValue = businessCompanyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Phone")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessPhone,
                                    ActualValue = businessPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = businessPhone;
                                updateJobDocumentField.Value = businessPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessAddress,
                                    ActualValue = businessAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = businessAddress;
                                updateJobDocumentField.ActualValue = businessAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CityState")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessCity + " " + businessState,
                                    ActualValue = businessCity + " " + businessState,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = businessCity + " " + businessState;
                                updateJobDocumentField.ActualValue = businessCity + " " + businessState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Zip")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessZip,
                                    ActualValue = businessZip,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = businessZip;
                                updateJobDocumentField.ActualValue = businessZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Title")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantTitle,
                                    ActualValue = applicantTitle
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantTitle;
                                updateJobDocumentField.ActualValue = applicantTitle;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Demo_Precautions")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Demo_Method")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "chkAsbestos_Yes")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "chkAsbestos_No")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "CompletionDate")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "AsbestosInvestigator")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Certificate")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "FRCompany")
                        {
                            string frCompany = "RPO INC";
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frCompany,
                                    ActualValue = frCompany,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frCompany;
                                updateJobDocumentField.ActualValue = frCompany;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "FRPhone")
                        {
                            string frPhone = "(212) 566-5110";
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frPhone,
                                    ActualValue = frPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frPhone;
                                updateJobDocumentField.ActualValue = frPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "FRAddress")
                        {
                            string frAddress = "146 WEST 29TH STREET 2ND FLOOR";
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frAddress,
                                    ActualValue = frAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frAddress;
                                updateJobDocumentField.ActualValue = frAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "FRCityState")
                        {
                            string frCityState = "NEW YORK NY";
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frCityState,
                                    ActualValue = frCityState
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frCityState;
                                updateJobDocumentField.ActualValue = frCityState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "FRZip")
                        {
                            string frZip = "10001";
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frZip,
                                    ActualValue = frZip,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frZip;
                                updateJobDocumentField.ActualValue = frZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Owner")
                        {
                            string owner = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName + (job.RfpAddress.OwnerContact.Company != null ? " - " + job.RfpAddress.OwnerContact.Company.Name : string.Empty) : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = owner,
                                    ActualValue = owner
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = owner;
                                updateJobDocumentField.ActualValue = owner;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "OwnerTitle")
                        {
                            string ownerTitle = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.ContactTitle != null ? job.RfpAddress.OwnerContact.ContactTitle.Name : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerTitle,
                                    ActualValue = ownerTitle
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerTitle;
                                updateJobDocumentField.ActualValue = ownerTitle;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "OwnerDate")
                        {
                            // DateTime date = DateTime.Now;
                            // string format = "MM/dd/yy";
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }


                        rpoContext.SaveChanges();

                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {

                            int applicationId = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplications = rpoContext.JobApplications.Where(x => x.Id == applicationId).FirstOrDefault();
                            applicationNumber = jobApplications != null ? jobApplications.ApplicationNumber : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {

                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = applicationNumber,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Applicant")
                        {
                            //sunay
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.Where(x => x.Id == applicantId).FirstOrDefault();

                            string contactName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            applicantTitle = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactTitle != null ? jobContact.Contact.ContactTitle.Name : string.Empty;

                            Address compnayAddress = Common.GetContactAddressForJobDocument(jobContact);
                            businessCompanyName = jobContact != null && jobContact.Company != null ? jobContact.Company.Name : string.Empty;
                            businessPhone = Common.GetContactPhoneNumberForJobDocument(jobContact);
                            businessAddress = compnayAddress != null ? compnayAddress.Address1 + " " + compnayAddress.Address2 : string.Empty;
                            businessFax = string.Empty;
                            businessCity = compnayAddress != null ? compnayAddress.City : string.Empty;
                            businessState = compnayAddress != null && compnayAddress.State != null ? compnayAddress.State.Acronym : string.Empty;
                            businessZip = compnayAddress != null ? compnayAddress.ZipCode : string.Empty;
                            //contactMobilePhone = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MobilePhone : string.Empty;
                            contactEmail = jobContact != null ? jobContact.Contact.Email : string.Empty;

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = contactName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = contactName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();

                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();

                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }

            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            // Generate Job Document
            GenerateJobDocument(idJobDocument);
        }

        public static void EditRequestforDEPRegistrationforDemolitionFormAR(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();

            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                // Address companyAddress = job != null && job.Company != null && job.Company.Addresses != null ? job.Company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;
                string applicationNumber = string.Empty;
                string applicantTitle = string.Empty;

                string businessCompanyName = string.Empty;
                string businessPhone = string.Empty;
                string businessAddress = string.Empty;
                string businessFax = string.Empty;
                string businessCity = string.Empty;
                string businessState = string.Empty;
                string businessZip = string.Empty;
                //string contactMobilePhone = string.Empty;
                string contactEmail = string.Empty;
                foreach (DocumentField item in documentFieldList)
                {

                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        string premisesAddress = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty;
                        if (item.Field.FieldName == "PremisesAddress")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = premisesAddress,
                                    ActualValue = premisesAddress,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = premisesAddress;
                                updateJobDocumentField.ActualValue = premisesAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "JobFileInfo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - DEPRFD-62442.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Boro")
                        {
                            string boro = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = boro,
                                    ActualValue = boro,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = boro;
                                updateJobDocumentField.ActualValue = boro;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Stories")
                        {
                            string stories = job != null && job.RfpAddress != null ? Convert.ToString(job.RfpAddress.Stories) : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = stories,
                                    ActualValue = stories,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = stories;
                                updateJobDocumentField.ActualValue = stories;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PremisesCity")
                        {
                            string premisesCity = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = premisesCity,
                                    ActualValue = premisesCity
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = premisesCity;
                                updateJobDocumentField.ActualValue = premisesCity;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PremisesState")
                        {
                            string premisesState = "NY";
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = premisesState,
                                    ActualValue = premisesState
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = premisesState;
                                updateJobDocumentField.ActualValue = premisesState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PremisesZip")
                        {
                            string premisesZip = job != null && job.RfpAddress != null ? job.RfpAddress.ZipCode : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = premisesZip,
                                    ActualValue = premisesZip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = premisesZip;
                                updateJobDocumentField.ActualValue = premisesZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "JobNo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicationNumber,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicationNumber;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Company")
                        {

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessCompanyName,
                                    ActualValue = businessCompanyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = businessCompanyName;
                                updateJobDocumentField.ActualValue = businessCompanyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Phone")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessPhone,
                                    ActualValue = businessPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = businessPhone;
                                updateJobDocumentField.ActualValue = businessPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessAddress,
                                    ActualValue = businessAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = businessAddress;
                                updateJobDocumentField.ActualValue = businessAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CityState")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessCity + " " + businessState,
                                    ActualValue = businessCity + " " + businessState,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = businessCity + " " + businessState;
                                updateJobDocumentField.ActualValue = businessCity + " " + businessState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Zip")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = businessZip,
                                    ActualValue = businessZip,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = businessZip;
                                updateJobDocumentField.ActualValue = businessZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Title")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantTitle,
                                    ActualValue = applicantTitle
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantTitle;
                                updateJobDocumentField.ActualValue = applicantTitle;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }


                        if (item.Field.FieldName == "FRCompany")
                        {
                            string frCompany = "RPO INC";
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frCompany,
                                    ActualValue = frCompany,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frCompany;
                                updateJobDocumentField.ActualValue = frCompany;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "FRPhone")
                        {
                            string frPhone = "(212) 566-5110";
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frPhone,
                                    ActualValue = frPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frPhone;
                                updateJobDocumentField.ActualValue = frPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "FRAddress")
                        {
                            string frAddress = "146 WEST 29TH STREET 2ND FLOOR";
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frAddress,
                                    ActualValue = frAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frAddress;
                                updateJobDocumentField.ActualValue = frAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "FRCityState")
                        {
                            string frCityState = "NEW YORK NY";
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frCityState,
                                    ActualValue = frCityState
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frCityState;
                                updateJobDocumentField.ActualValue = frCityState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "FRZip")
                        {
                            string frZip = "10001";
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frZip,
                                    ActualValue = frZip,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frZip;
                                updateJobDocumentField.ActualValue = frZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Owner")
                        {
                            string owner = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName + (job.RfpAddress.OwnerContact.Company != null ? " - " + job.RfpAddress.OwnerContact.Company.Name : string.Empty) : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = owner,
                                    ActualValue = owner
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = owner;
                                updateJobDocumentField.ActualValue = owner;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "OwnerTitle")
                        {
                            string ownerTitle = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.ContactTitle != null ? job.RfpAddress.OwnerContact.ContactTitle.Name : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerTitle,
                                    ActualValue = ownerTitle
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = ownerTitle;
                                updateJobDocumentField.ActualValue = ownerTitle;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();

                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {

                            int applicationId = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplications = rpoContext.JobApplications.Where(x => x.Id == applicationId).FirstOrDefault();
                            applicationNumber = jobApplications != null ? jobApplications.ApplicationNumber : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {

                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = applicationNumber,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Applicant")
                        {
                            //sunay
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.Where(x => x.Id == applicantId).FirstOrDefault();

                            string contactName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            applicantTitle = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactTitle != null ? jobContact.Contact.ContactTitle.Name : string.Empty;

                            Address compnayAddress = Common.GetContactAddressForJobDocument(jobContact);
                            businessCompanyName = jobContact != null && jobContact.Company != null ? jobContact.Company.Name : string.Empty;
                            businessPhone = Common.GetContactPhoneNumberForJobDocument(jobContact);
                            businessAddress = compnayAddress != null ? compnayAddress.Address1 + " " + compnayAddress.Address2 : string.Empty;
                            businessFax = string.Empty;
                            businessCity = compnayAddress != null ? compnayAddress.City : string.Empty;
                            businessState = compnayAddress != null && compnayAddress.State != null ? compnayAddress.State.Acronym : string.Empty;
                            businessZip = compnayAddress != null ? compnayAddress.ZipCode : string.Empty;
                            //contactMobilePhone = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MobilePhone : string.Empty;
                            contactEmail = jobContact != null ? jobContact.Contact.Email : string.Empty;

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = contactName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField && x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = contactName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();

                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();

                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            // Edit Job Document
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }



        /// <summary>
        /// Generates the requestfor carbon monoxide letter.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.</param>
        public static void GenerateRequestforCarbonMonoxideLetter(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            JobApplication jobApplications = new JobApplication();

            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();
            bool isTodaysDate = false;
            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("RfpAddress.OwnerContact.Company").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();


                foreach (DocumentField item in documentFieldList)
                {

                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - CARBON-62424.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address")
                        {
                            Address ownerAddress = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Addresses != null ? job.RfpAddress.OwnerContact.Addresses.FirstOrDefault(x => x.IsMainAddress == true) : null;

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            var address = (job != null && job.RfpAddress != null) ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street
                                + System.Environment.NewLine +
                                job.RfpAddress.Borough.Description + ", " + (ownerAddress != null && ownerAddress.State != null ? ownerAddress.State.Acronym : string.Empty)
                                + System.Environment.NewLine + (jobApplications != null ? "Job #" + jobApplications.ApplicationNumber : string.Empty)
                                : string.Empty;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = address,
                                    ActualValue = address
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = address;
                                updateJobDocumentField.ActualValue = address;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Header")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);


                            Address address = ((job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Addresses != null) ? job.RfpAddress.OwnerContact.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null);
                            string header = ((job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null) ? job.RfpAddress.OwnerContact.FirstName + ' ' + job.RfpAddress.OwnerContact.LastName : string.Empty)
                                + System.Environment.NewLine +
                                ((job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Company != null) ? job.RfpAddress.OwnerContact.Company.Name : string.Empty)
                                + System.Environment.NewLine + (address != null ? address.Address1
                                + System.Environment.NewLine + address.Address2
                                + System.Environment.NewLine + address.City + (address.State != null ? " " + address.State.Acronym : string.Empty)
                                + (!string.IsNullOrEmpty(address.ZipCode) ? " " + address.ZipCode : string.Empty) : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {

                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = header,
                                    ActualValue = header
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = header;
                                updateJobDocumentField.ActualValue = header;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OwnerParagraph")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string staticDescription = item.StaticDescription.Replace("##AddressOwner##", (job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null) ? job.RfpAddress.OwnerContact.FirstName + ' ' + job.RfpAddress.OwnerContact.LastName : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = staticDescription,
                                    ActualValue = staticDescription
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = staticDescription;
                                updateJobDocumentField.ActualValue = staticDescription;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = (job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null) ? job.RfpAddress.OwnerContact.FirstName + ' ' + job.RfpAddress.OwnerContact.LastName : string.Empty,
                                    ActualValue = (job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null) ? job.RfpAddress.OwnerContact.FirstName + ' ' + job.RfpAddress.OwnerContact.LastName : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = (job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null) ? job.RfpAddress.OwnerContact.FirstName + ' ' + job.RfpAddress.OwnerContact.LastName : string.Empty;
                                updateJobDocumentField.ActualValue = (job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null) ? job.RfpAddress.OwnerContact.FirstName + ' ' + job.RfpAddress.OwnerContact.LastName : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Date")
                        {
                            DateTime date = DateTime.Today;
                            string swornDate = string.Empty;
                            if (isTodaysDate)
                            {
                                swornDate = string.Format("{0} day of {1} {2}", Ordinal(date.Day), date.ToString("MMMM"), date.ToString("yyyy"));
                            }

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = swornDate,
                                    ActualValue = swornDate
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = swornDate;
                                updateJobDocumentField.ActualValue = swornDate;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }


                        rpoContext.SaveChanges();

                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {

                            int applicationTypeId = Convert.ToInt32(frontendFields.Value);
                            jobApplications = rpoContext.JobApplications.Where(x => x.Id == applicationTypeId).FirstOrDefault();

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(applicationTypeId),
                                    ActualValue = jobApplications != null ? jobApplications.ApplicationNumber : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(applicationTypeId);
                                updateJobDocumentField.ActualValue = jobApplications != null ? jobApplications.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Use Today's Date as Notary Date?")
                        {
                            isTodaysDate = Convert.ToBoolean(frontendFields.Value);
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }

            // Generate Job Document
            GenerateJobDocument(idJobDocument);
        }

        /// <summary>
        /// Generates the requestfor builders pavement plan statement professional certificate.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.</param>
        public static void GenerateRequestforBuildersPavementPlanStatementProfessionalCertificate(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                string contactLic_No = string.Empty;
                string contactLic_state = string.Empty;

                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            string jobFileInfo = job != null ? job.JobNumber + " - BPPSPC-62438.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lic_Type")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {

                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = contactLic_state,
                                    ActualValue = contactLic_state
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = contactLic_state;
                                updateJobDocumentField.ActualValue = contactLic_state;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Lic_No")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {

                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = contactLic_No,
                                    ActualValue = contactLic_No
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = contactLic_No;
                                updateJobDocumentField.ActualValue = contactLic_No;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "JobNumber")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();

                    }
                    else
                    {

                        if (item.Field.FieldName == "Application Type")
                        {

                            int applicationTypeId = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == applicationTypeId).FirstOrDefault();

                            if (updateJobDocumentField == null)
                            {

                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(applicationTypeId),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(applicationTypeId);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "Applicant")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.Where(x => x.Id == applicantId).FirstOrDefault();

                            string licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                                jobContact.Contact.ContactLicenses.Select(x => x.Number).FirstOrDefault() : string.Empty;
                            if (!string.IsNullOrEmpty(licenceTypeNumber))
                            {
                                ContactLicense contactLicenseType = rpoContext.ContactLicenses.Where(a => a.Number == licenceTypeNumber).FirstOrDefault();
                                ContactLicenseType LicenseType = rpoContext.ContactLicenseTypes.Where(b => b.Id == contactLicenseType.IdContactLicenseType).FirstOrDefault();

                                if (LicenseType.Name == "Engineer")
                                {
                                    contactLic_state = "PE";
                                    contactLic_No = licenceTypeNumber;
                                }
                                else if (LicenseType.Name == "Architect")
                                {
                                    contactLic_state = "RA";
                                    contactLic_No = licenceTypeNumber;
                                }
                                else if (LicenseType.Name == "Registered Landscape Architect")
                                {
                                    contactLic_state = "RLA";
                                    contactLic_No = licenceTypeNumber;
                                }
                            }
                            else
                            {
                                licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                                jobContact.Contact.ContactLicenses.Select(x => x.ContactLicenseType.Name).FirstOrDefault() : string.Empty;

                                if (licenceTypeNumber.ToLower() == ("Engineer").ToLower())
                                {
                                    contactLic_state = "PE";
                                }
                                else if (licenceTypeNumber.ToLower() == ("Architect").ToLower())
                                {
                                    contactLic_state = "RA";
                                }
                                else if (licenceTypeNumber.ToLower() == ("Registered Landscape Architect").ToLower())
                                {
                                    contactLic_state = "RLA";
                                }
                            }

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(applicantId),
                                    ActualValue = applicantName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(applicantId);
                                updateJobDocumentField.ActualValue = applicantName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }

            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();

            // Generate Job Document
            GenerateJobDocument(idJobDocument);
        }

        public static void EditRequestforBuildersPavementPlanStatementProfessionalCertificate(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();

            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                string contactLic_No = string.Empty;
                string contactLic_state = string.Empty;

                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            string jobFileInfo = job != null ? job.JobNumber + " - BPPSPC-62438.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lic_Type")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {

                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = contactLic_state,
                                    ActualValue = contactLic_state
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = contactLic_state;
                                updateJobDocumentField.ActualValue = contactLic_state;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Lic_No")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {

                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = contactLic_No,
                                    ActualValue = contactLic_No
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = contactLic_No;
                                updateJobDocumentField.ActualValue = contactLic_No;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();

                    }
                    else
                    {

                        if (item.Field.FieldName == "Application Type")
                        {

                            int applicationTypeId = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == applicationTypeId).FirstOrDefault();

                            if (updateJobDocumentField == null)
                            {

                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(applicationTypeId),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(applicationTypeId);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "Applicant")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.Where(x => x.Id == applicantId).FirstOrDefault();

                            string licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                                jobContact.Contact.ContactLicenses.Select(x => x.Number).FirstOrDefault() : string.Empty;
                            if (!string.IsNullOrEmpty(licenceTypeNumber))
                            {
                                ContactLicense contactLicenseType = rpoContext.ContactLicenses.Where(a => a.Number == licenceTypeNumber).FirstOrDefault();
                                ContactLicenseType LicenseType = rpoContext.ContactLicenseTypes.Where(b => b.Id == contactLicenseType.IdContactLicenseType).FirstOrDefault();

                                if (LicenseType.Name == "Engineer")
                                {
                                    contactLic_state = "PE";
                                    contactLic_No = licenceTypeNumber;
                                }
                                else if (LicenseType.Name == "Architect")
                                {
                                    contactLic_state = "RA";
                                    contactLic_No = licenceTypeNumber;
                                }
                                else if (LicenseType.Name == "Registered Landscape Architect")
                                {
                                    contactLic_state = "RLA";
                                    contactLic_No = licenceTypeNumber;
                                }
                            }
                            else
                            {
                                licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                                jobContact.Contact.ContactLicenses.Select(x => x.ContactLicenseType.Name).FirstOrDefault() : string.Empty;

                                if (licenceTypeNumber.ToLower() == ("Engineer").ToLower())
                                {
                                    contactLic_state = "PE";
                                }
                                else if (licenceTypeNumber.ToLower() == ("Architect").ToLower())
                                {
                                    contactLic_state = "RA";
                                }
                                else if (licenceTypeNumber.ToLower() == ("Registered Landscape Architect").ToLower())
                                {
                                    contactLic_state = "RLA";
                                }
                            }

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(applicantId),
                                    ActualValue = applicantName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(applicantId);
                                updateJobDocumentField.ActualValue = applicantName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();

            // Edit Job Document
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }

        /// <summary>
        /// Application for StatementinSupportofCertificateCorrection
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.</param>
        public static void GenerateRequestforStatementinSupportofCertificateCorrection(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();
                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();
                string summonsNumber = string.Empty;
                string placeOfOccurance = string.Empty;
                string certifierName = string.Empty;
                string violationDate = string.Empty;
                string penaltyofPerjuryRadio = string.Empty;

                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);


                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "SummonsNumber2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = summonsNumber != null ? summonsNumber.Length > 6 ? summonsNumber.Substring(3, 3) : summonsNumber : string.Empty,
                                    ActualValue = summonsNumber != null ? summonsNumber.Length > 6 ? summonsNumber.Substring(3, 3) : summonsNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = summonsNumber != null ? summonsNumber.Length > 6 ? summonsNumber.Substring(3, 3) : summonsNumber : string.Empty;
                                updateJobDocumentField.ActualValue = summonsNumber != null ? summonsNumber.Length > 6 ? summonsNumber.Substring(3, 3) : summonsNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SummonsNumber3")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = summonsNumber != null ? summonsNumber.Length > 8 ? summonsNumber.Substring(6, 2) : summonsNumber : string.Empty,
                                    ActualValue = summonsNumber != null ? summonsNumber.Length > 8 ? summonsNumber.Substring(6, 2) : summonsNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = summonsNumber != null ? summonsNumber.Length > 8 ? summonsNumber.Substring(6, 2) : summonsNumber : string.Empty;
                                updateJobDocumentField.ActualValue = summonsNumber != null ? summonsNumber.Length > 8 ? summonsNumber.Substring(6, 2) : summonsNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SecondSummonsNumber5")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = summonsNumber != null ? summonsNumber.Length > 9 ? summonsNumber : summonsNumber.Substring(8, 1) : string.Empty,
                                    ActualValue = summonsNumber != null ? summonsNumber.Length > 9 ? summonsNumber : summonsNumber.Substring(8, 1) : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = summonsNumber != null ? summonsNumber.Length > 9 ? summonsNumber : summonsNumber.Substring(8, 1) : string.Empty;
                                updateJobDocumentField.ActualValue = summonsNumber != null ? summonsNumber.Length > 9 ? summonsNumber : summonsNumber.Substring(8, 1) : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SummonsNumber4")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = summonsNumber != null ? summonsNumber.Length > 9 ? summonsNumber : summonsNumber.Substring(8, 1) : string.Empty,
                                    ActualValue = summonsNumber != null ? summonsNumber.Length > 9 ? summonsNumber : summonsNumber.Substring(8, 1) : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = summonsNumber != null ? summonsNumber.Length > 9 ? summonsNumber : summonsNumber.Substring(8, 1) : string.Empty;
                                updateJobDocumentField.ActualValue = summonsNumber != null ? summonsNumber.Length > 9 ? summonsNumber : summonsNumber.Substring(8, 1) : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PlaceOfOccurance")
                        {
                            placeOfOccurance = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty;
                            var jobCompanyAddresses = job.Company != null ? job.Company.Addresses.FirstOrDefault() : null;
                            string state = jobCompanyAddresses != null && jobCompanyAddresses.State != null ? jobCompanyAddresses.State.Acronym : string.Empty;
                            string city = jobCompanyAddresses != null && jobCompanyAddresses.State != null ? jobCompanyAddresses.City : string.Empty;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = placeOfOccurance != null ? placeOfOccurance.PadRight(40) + ("New York") + (", " + "NY") + (job != null && job.RfpAddress != null ? ", " + "10001" : string.Empty) : string.Empty,
                                    ActualValue = placeOfOccurance != null ? placeOfOccurance.PadRight(40) + ("New York") + (", " + "NY") + (job != null && job.RfpAddress != null ? ", " + "10001" : string.Empty) : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = placeOfOccurance != null ? placeOfOccurance.PadRight(40) + ("New York") + (", " + "NY") + (job != null && job.RfpAddress != null ? ", " + "10001" : string.Empty) : string.Empty;
                                updateJobDocumentField.ActualValue = placeOfOccurance != null ? placeOfOccurance.PadRight(40) + ("New York") + (", " + "NY") + (job != null && job.RfpAddress != null ? ", " + "10001" : string.Empty) : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Print Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = certifierName,
                                    ActualValue = certifierName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = certifierName;
                                updateJobDocumentField.ActualValue = certifierName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OtherSpecify")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ViolationDate")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = violationDate,
                                    ActualValue = violationDate
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = violationDate;
                                updateJobDocumentField.ActualValue = violationDate;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "DescriptionWorkPerformed")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Date")
                        {
                            //DateTime time = DateTime.Now;
                            //string format = "MMM d yyyy";
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PenaltyofPerjuryRadio")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = penaltyofPerjuryRadio,
                                    ActualValue = penaltyofPerjuryRadio
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = penaltyofPerjuryRadio;
                                updateJobDocumentField.ActualValue = penaltyofPerjuryRadio;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SecondSummonsNumber1")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = summonsNumber != null ? summonsNumber.Length > 3 ? summonsNumber.Substring(0, 3) : summonsNumber : string.Empty,
                                    ActualValue = summonsNumber != null ? summonsNumber.Length > 3 ? summonsNumber.Substring(0, 3) : summonsNumber : string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = summonsNumber != null ? summonsNumber.Length > 3 ? summonsNumber.Substring(0, 3) : summonsNumber : string.Empty;
                                updateJobDocumentField.ActualValue = summonsNumber != null ? summonsNumber.Length > 3 ? summonsNumber.Substring(0, 3) : summonsNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SecondSummonsNumber2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = summonsNumber != null ? summonsNumber.Length > 3 ? summonsNumber.Substring(0, 3) : summonsNumber : string.Empty,
                                    ActualValue = summonsNumber != null ? summonsNumber.Length > 3 ? summonsNumber.Substring(0, 3) : summonsNumber : string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = summonsNumber != null ? summonsNumber.Length > 3 ? summonsNumber.Substring(0, 3) : summonsNumber : string.Empty;
                                updateJobDocumentField.ActualValue = summonsNumber != null ? summonsNumber.Length > 3 ? summonsNumber.Substring(0, 3) : summonsNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SecondSummonsNumber3")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = summonsNumber != null ? summonsNumber.Length > 6 ? summonsNumber.Substring(3, 3) : summonsNumber : string.Empty,
                                    ActualValue = summonsNumber != null ? summonsNumber.Length > 6 ? summonsNumber.Substring(3, 3) : summonsNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = summonsNumber != null ? summonsNumber.Length > 6 ? summonsNumber.Substring(3, 3) : summonsNumber : string.Empty;
                                updateJobDocumentField.ActualValue = summonsNumber != null ? summonsNumber.Length > 6 ? summonsNumber.Substring(3, 3) : summonsNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SecondSummonsNumber4")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = summonsNumber != null ? summonsNumber.Length > 8 ? summonsNumber.Substring(6, 2) : summonsNumber : string.Empty,
                                    ActualValue = summonsNumber != null ? summonsNumber.Length > 8 ? summonsNumber.Substring(6, 2) : summonsNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = summonsNumber != null ? summonsNumber.Length > 8 ? summonsNumber.Substring(6, 2) : summonsNumber : string.Empty;
                                updateJobDocumentField.ActualValue = summonsNumber != null ? summonsNumber.Length > 8 ? summonsNumber.Substring(6, 2) : summonsNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Of")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "2",
                                    ActualValue = "2"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = "2";
                                updateJobDocumentField.ActualValue = "2";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Page")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "2",
                                    ActualValue = "2"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = "2";
                                updateJobDocumentField.ActualValue = "2";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "SummonsNumber1")
                        {
                            int summonsId = Convert.ToInt32(frontendFields.Value);
                            JobViolation jobViolation = rpoContext.JobViolations.Where(x => x.Id == summonsId).FirstOrDefault();

                            summonsNumber = jobViolation != null ? jobViolation.SummonsNumber : string.Empty;
                            //placeOfOccurance = jobViolation != null ? jobViolation.InspectionLocation : string.Empty;

                            //respondentName = jobViolation != null ? jobViolation.RespondentName : string.Empty;
                            //violationDate = jobViolation != null ? Convert.ToString(jobViolation.DateIssued) : string.Empty;

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(summonsNumber) ? "Violation:" + summonsNumber + " | " : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = summonsNumber != null ? summonsNumber.Length > 3 ? summonsNumber.Substring(0, 3) : summonsNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = summonsNumber != null ? summonsNumber.Length > 3 ? summonsNumber.Substring(0, 3) : summonsNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Application Type")
                        {
                            int idApplication = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idApplication).FirstOrDefault();

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idApplication),
                                    ActualValue = jobApplication.ApplicationNumber,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idApplication);
                                updateJobDocumentField.ActualValue = jobApplication.ApplicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                            rpoContext.SaveChanges();
                        }
                        else if (item.Field.FieldName == "Name")
                        {
                            int idJobApplicant = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            Contact contact = rpoContext.Contacts.Include("Company.Addresses").Include("Addresses").Where(x => x.Id == idJobApplicant).FirstOrDefault();

                            certifierName = contact != null ? contact.FirstName + " " + contact.LastName : string.Empty;
                            documentDescription = documentDescription + "Applicant: " + certifierName;

                            Company company = contact.Company;
                            if (company != null && company.CompanyTypes != null && company.CompanyTypes.Where(x => x.ItemName == "General Contractor").Any())
                            {
                                penaltyofPerjuryRadio = "6";
                            }
                            else
                            {
                                ContactLicense contactLicense = contact.ContactLicenses.FirstOrDefault(x => x.ContactLicenseType.Name == "Engineer" || x.ContactLicenseType.Name == "Architect");
                                string contactLicensePersonPerformed = contactLicense != null ? contactLicense.Number : string.Empty;
                                if (!string.IsNullOrEmpty(contactLicensePersonPerformed))
                                {
                                    penaltyofPerjuryRadio = "8";
                                }
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplicant),
                                    ActualValue = contact != null ? contact.FirstName + " " + contact.LastName : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplicant);
                                updateJobDocumentField.ActualValue = contact != null ? contact.FirstName + " " + contact.LastName : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Optional Description")
                        {
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(frontendFields.Value) ? " | " : string.Empty) + (!string.IsNullOrEmpty(frontendFields.Value) ? "Optional Description: " + frontendFields.Value : string.Empty);

                            string empty = frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = empty,
                                    ActualValue = empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = empty;
                                updateJobDocumentField.ActualValue = empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                    }
                }
            }
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateJobDocument(idJobDocument);
        }


        #region editDocument
        public static void EditRequestforStatementinSupportofCertificateCorrection(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;
            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();
                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();
                string summonsNumber = string.Empty;
                string placeOfOccurance = string.Empty;
                string certifierName = string.Empty;
                string violationDate = string.Empty;
                string penaltyofPerjuryRadio = string.Empty;

                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);


                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "SummonsNumber2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = summonsNumber != null ? summonsNumber.Length > 6 ? summonsNumber.Substring(3, 3) : summonsNumber : string.Empty,
                                    ActualValue = summonsNumber != null ? summonsNumber.Length > 6 ? summonsNumber.Substring(3, 3) : summonsNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = summonsNumber != null ? summonsNumber.Length > 6 ? summonsNumber.Substring(3, 3) : summonsNumber : string.Empty;
                                updateJobDocumentField.ActualValue = summonsNumber != null ? summonsNumber.Length > 6 ? summonsNumber.Substring(3, 3) : summonsNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SummonsNumber3")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = summonsNumber != null ? summonsNumber.Length > 8 ? summonsNumber.Substring(6, 2) : summonsNumber : string.Empty,
                                    ActualValue = summonsNumber != null ? summonsNumber.Length > 8 ? summonsNumber.Substring(6, 2) : summonsNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = summonsNumber != null ? summonsNumber.Length > 8 ? summonsNumber.Substring(6, 2) : summonsNumber : string.Empty;
                                updateJobDocumentField.ActualValue = summonsNumber != null ? summonsNumber.Length > 8 ? summonsNumber.Substring(6, 2) : summonsNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SecondSummonsNumber5")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = summonsNumber != null ? summonsNumber.Length > 9 ? summonsNumber : summonsNumber.Substring(8, 1) : string.Empty,
                                    ActualValue = summonsNumber != null ? summonsNumber.Length > 9 ? summonsNumber : summonsNumber.Substring(8, 1) : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = summonsNumber != null ? summonsNumber.Length > 9 ? summonsNumber : summonsNumber.Substring(8, 1) : string.Empty;
                                updateJobDocumentField.ActualValue = summonsNumber != null ? summonsNumber.Length > 9 ? summonsNumber : summonsNumber.Substring(8, 1) : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SummonsNumber4")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = summonsNumber != null ? summonsNumber.Length > 9 ? summonsNumber : summonsNumber.Substring(8, 1) : string.Empty,
                                    ActualValue = summonsNumber != null ? summonsNumber.Length > 9 ? summonsNumber : summonsNumber.Substring(8, 1) : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = summonsNumber != null ? summonsNumber.Length > 9 ? summonsNumber : summonsNumber.Substring(8, 1) : string.Empty;
                                updateJobDocumentField.ActualValue = summonsNumber != null ? summonsNumber.Length > 9 ? summonsNumber : summonsNumber.Substring(8, 1) : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PlaceOfOccurance")
                        {
                            placeOfOccurance = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty;
                            var jobCompanyAddresses = job.Company != null ? job.Company.Addresses.FirstOrDefault() : null;
                            string state = jobCompanyAddresses != null && jobCompanyAddresses.State != null ? jobCompanyAddresses.State.Acronym : string.Empty;
                            string city = jobCompanyAddresses != null && jobCompanyAddresses.State != null ? jobCompanyAddresses.City : string.Empty;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = placeOfOccurance != null ? placeOfOccurance.PadRight(40) + ("New York") + (", " + "NY") + (job != null && job.RfpAddress != null ? ", " + "10001" : string.Empty) : string.Empty,
                                    ActualValue = placeOfOccurance != null ? placeOfOccurance.PadRight(40) + ("New York") + (", " + "NY") + (job != null && job.RfpAddress != null ? ", " + "10001" : string.Empty) : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = placeOfOccurance != null ? placeOfOccurance.PadRight(40) + ("New York") + (", " + "NY") + (job != null && job.RfpAddress != null ? ", " + "10001" : string.Empty) : string.Empty;
                                updateJobDocumentField.ActualValue = placeOfOccurance != null ? placeOfOccurance.PadRight(40) + ("New York") + (", " + "NY") + (job != null && job.RfpAddress != null ? ", " + "10001" : string.Empty) : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ViolationDate")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = violationDate,
                                    ActualValue = violationDate
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = violationDate;
                                updateJobDocumentField.ActualValue = violationDate;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PenaltyofPerjuryRadio")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = penaltyofPerjuryRadio,
                                    ActualValue = penaltyofPerjuryRadio
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = penaltyofPerjuryRadio;
                                updateJobDocumentField.ActualValue = penaltyofPerjuryRadio;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        //else if (item.Field.FieldName == "SecondSummonsNumber1")
                        //{
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = summonsNumber != null ? summonsNumber.Length > 3 ? summonsNumber.Substring(0, 3) : summonsNumber : string.Empty,
                        //            ActualValue = summonsNumber != null ? summonsNumber.Length > 3 ? summonsNumber.Substring(0, 3) : summonsNumber : string.Empty

                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    }
                        //    else
                        //    {
                        //        string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                        //        pdfFields.Add(pdffield);
                        //        updateJobDocumentField.Value = summonsNumber != null ? summonsNumber.Length > 3 ? summonsNumber.Substring(0, 3) : summonsNumber : string.Empty;
                        //        updateJobDocumentField.ActualValue = summonsNumber != null ? summonsNumber.Length > 3 ? summonsNumber.Substring(0, 3) : summonsNumber : string.Empty;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        FieldsValue.Add(new IdItemName
                        //        {
                        //            Id = pdffield,
                        //            ItemName = updateJobDocumentField.ActualValue
                        //        });
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        else if (item.Field.FieldName == "SecondSummonsNumber2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = summonsNumber != null ? summonsNumber.Length > 3 ? summonsNumber.Substring(0, 3) : summonsNumber : string.Empty,
                                    ActualValue = summonsNumber != null ? summonsNumber.Length > 3 ? summonsNumber.Substring(0, 3) : summonsNumber : string.Empty

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = summonsNumber != null ? summonsNumber.Length > 3 ? summonsNumber.Substring(0, 3) : summonsNumber : string.Empty;
                                updateJobDocumentField.ActualValue = summonsNumber != null ? summonsNumber.Length > 3 ? summonsNumber.Substring(0, 3) : summonsNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SecondSummonsNumber3")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = summonsNumber != null ? summonsNumber.Length > 6 ? summonsNumber.Substring(3, 3) : summonsNumber : string.Empty,
                                    ActualValue = summonsNumber != null ? summonsNumber.Length > 6 ? summonsNumber.Substring(3, 3) : summonsNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = summonsNumber != null ? summonsNumber.Length > 6 ? summonsNumber.Substring(3, 3) : summonsNumber : string.Empty;
                                updateJobDocumentField.ActualValue = summonsNumber != null ? summonsNumber.Length > 6 ? summonsNumber.Substring(3, 3) : summonsNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SecondSummonsNumber4")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = summonsNumber != null ? summonsNumber.Length > 8 ? summonsNumber.Substring(6, 2) : summonsNumber : string.Empty,
                                    ActualValue = summonsNumber != null ? summonsNumber.Length > 8 ? summonsNumber.Substring(6, 2) : summonsNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = summonsNumber != null ? summonsNumber.Length > 8 ? summonsNumber.Substring(6, 2) : summonsNumber : string.Empty;
                                updateJobDocumentField.ActualValue = summonsNumber != null ? summonsNumber.Length > 8 ? summonsNumber.Substring(6, 2) : summonsNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Of")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "2",
                                    ActualValue = "2"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = "2";
                                updateJobDocumentField.ActualValue = "2";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Page")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "2",
                                    ActualValue = "2"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = "2";
                                updateJobDocumentField.ActualValue = "2";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Print Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = certifierName,
                                    ActualValue = certifierName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = certifierName;
                                updateJobDocumentField.ActualValue = certifierName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "SummonsNumber1")
                        {
                            int summonsId = Convert.ToInt32(frontendFields.Value);
                            JobViolation jobViolation = rpoContext.JobViolations.Where(x => x.Id == summonsId).FirstOrDefault();

                            summonsNumber = jobViolation != null ? jobViolation.SummonsNumber : string.Empty;
                            //placeOfOccurance = jobViolation != null ? jobViolation.InspectionLocation : string.Empty;

                            //respondentName = jobViolation != null ? jobViolation.RespondentName : string.Empty;
                            //violationDate = jobViolation != null ? Convert.ToString(jobViolation.DateIssued) : string.Empty;

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(summonsNumber) ? "Violation:" + summonsNumber + " | " : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = summonsNumber != null ? summonsNumber.Length > 3 ? summonsNumber.Substring(0, 3) : summonsNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = summonsNumber != null ? summonsNumber.Length > 3 ? summonsNumber.Substring(0, 3) : summonsNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Application Type")
                        {
                            int idApplication = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idApplication).FirstOrDefault();

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idApplication),
                                    ActualValue = jobApplication.ApplicationNumber,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idApplication);
                                updateJobDocumentField.ActualValue = jobApplication.ApplicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                            rpoContext.SaveChanges();
                        }
                        else if (item.Field.FieldName == "Name")
                        {
                            int idJobApplicant = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            Contact contact = rpoContext.Contacts.Include("Company.Addresses").Include("Addresses").Where(x => x.Id == idJobApplicant).FirstOrDefault();

                            certifierName = contact != null ? contact.FirstName + " " + contact.LastName : string.Empty;
                            documentDescription = documentDescription + "Applicant: " + certifierName;

                            Company company = contact.Company;
                            if (company != null && company.CompanyTypes != null && company.CompanyTypes.Where(x => x.ItemName == "General Contractor").Any())
                            {
                                penaltyofPerjuryRadio = "6";
                            }
                            else
                            {
                                ContactLicense contactLicense = contact.ContactLicenses.FirstOrDefault(x => x.ContactLicenseType.Name == "Engineer" || x.ContactLicenseType.Name == "Architect");
                                string contactLicensePersonPerformed = contactLicense != null ? contactLicense.Number : string.Empty;
                                if (!string.IsNullOrEmpty(contactLicensePersonPerformed))
                                {
                                    penaltyofPerjuryRadio = "8";
                                }
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplicant),
                                    ActualValue = contact != null ? contact.FirstName + " " + contact.LastName : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(idJobApplicant);
                                updateJobDocumentField.ActualValue = contact != null ? contact.FirstName + " " + contact.LastName : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Optional Description")
                        {
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(frontendFields.Value) ? " | " : string.Empty) + (!string.IsNullOrEmpty(frontendFields.Value) ? "Optional Description: " + frontendFields.Value : string.Empty);

                            string empty = frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = empty,
                                    ActualValue = empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = empty;
                                updateJobDocumentField.ActualValue = empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                    }
                }
            }
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);

        }

        #endregion

        public static void GenerateRequestforBuildersPavementFieldInspection(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                string filingRepresentativeCompany = string.Empty;
                string filingRepresentativePhone = string.Empty;
                string filingRepresentativeEmail = string.Empty;

                foreach (DocumentField item in documentFieldList)
                {

                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {

                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - BPP9-62445.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PP_ID")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        if (item.Field.FieldName == "Address")
                        {
                            string address = job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = address,
                                    ActualValue = address,

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = address;
                                updateJobDocumentField.ActualValue = address;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "opgBoro")
                        {
                            string borough = job.RfpAddress != null && job.RfpAddress.Borough != null ? Convert.ToString(job.RfpAddress.Borough.BisCode) : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough,

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Block")
                        {
                            string block = job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = block,
                                    ActualValue = block

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = block;
                                updateJobDocumentField.ActualValue = block;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Lot")
                        {
                            string lot = job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lot,
                                    ActualValue = lot

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = lot;
                                updateJobDocumentField.ActualValue = lot;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Owner_Name")
                        {
                            string ownerName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName + (job.RfpAddress.OwnerContact.Company != null ? " - " + job.RfpAddress.OwnerContact.Company.Name : string.Empty) : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerName,
                                    ActualValue = ownerName,

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerName;
                                updateJobDocumentField.ActualValue = ownerName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Owner_Phone")
                        {
                            string ownerPhone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;
                            if (ownerPhone == null || ownerPhone == "")
                            {
                                ownerPhone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.MobilePhone : string.Empty;
                            }
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerPhone,
                                    ActualValue = ownerPhone

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerPhone;
                                updateJobDocumentField.ActualValue = ownerPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Owner_EMail")
                        {
                            string ownerEmail = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerEmail,
                                    ActualValue = ownerEmail

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerEmail;
                                updateJobDocumentField.ActualValue = ownerEmail;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Date")
                        {
                            DateTime time = DateTime.Now;
                            //string format = "MMMM d, yyyy";
                            string format = "MM/dd/yy";
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = time.ToString(format),
                                    ActualValue = time.ToString(format)
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = time.ToString(format);
                                updateJobDocumentField.ActualValue = time.ToString(format);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        if (item.Field.FieldName == "FR_Company")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = filingRepresentativeCompany,
                                    ActualValue = filingRepresentativeCompany

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = filingRepresentativeCompany;
                                updateJobDocumentField.ActualValue = filingRepresentativeCompany;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "FR_Phone")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = filingRepresentativePhone,
                                    ActualValue = filingRepresentativePhone

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = filingRepresentativePhone;
                                updateJobDocumentField.ActualValue = filingRepresentativePhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "FR_EMail")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = filingRepresentativeEmail,
                                    ActualValue = filingRepresentativeEmail

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = filingRepresentativeEmail;
                                updateJobDocumentField.ActualValue = filingRepresentativeEmail;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();

                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int idApplication = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idApplication).FirstOrDefault();

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idApplication),
                                    ActualValue = jobApplication.ApplicationNumber,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idApplication);
                                updateJobDocumentField.ActualValue = jobApplication.ApplicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                            rpoContext.SaveChanges();
                        }
                        else if (item.Field.FieldName == "Filing Representative")
                        {
                            int idFilingRepresentative = Convert.ToInt32(frontendFields.Value);
                            //Employee employee = rpoContext.Employees.Where(x => x.Id == idFilingRepresentative).FirstOrDefault();
                            Employee employee = Common.GetEmployeeInformation(idFilingRepresentative);

                            string filingRepresentative = employee != null ? employee.FirstName + " " + employee.LastName : string.Empty;
                            filingRepresentativeCompany = "RPO INC";
                            filingRepresentativePhone = employee != null ? employee.WorkPhone : string.Empty;
                            filingRepresentativeEmail = employee != null ? employee.Email : string.Empty;

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(filingRepresentative) ? "Filing Representative: " + filingRepresentative : string.Empty);

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = filingRepresentative,

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = filingRepresentative;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields != null ? frontendFields.Value : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields != null ? frontendFields.Value : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                            rpoContext.SaveChanges();

                        }
                    }
                }
            }


            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateJobDocument(idJobDocument);
        }

        public static void EditRequestforBuildersPavementFieldInspection(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                string filingRepresentativeCompany = string.Empty;
                string filingRepresentativePhone = string.Empty;
                string filingRepresentativeEmail = string.Empty;

                foreach (DocumentField item in documentFieldList)
                {

                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {

                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - BPP9-62445.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Address")
                        {
                            string address = job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = address,
                                    ActualValue = address,

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = address;
                                updateJobDocumentField.ActualValue = address;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "opgBoro")
                        {
                            string borough = job.RfpAddress != null && job.RfpAddress.Borough != null ? Convert.ToString(job.RfpAddress.Borough.BisCode) : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough,

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Block")
                        {
                            string block = job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = block,
                                    ActualValue = block

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = block;
                                updateJobDocumentField.ActualValue = block;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Lot")
                        {
                            string lot = job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lot,
                                    ActualValue = lot

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = lot;
                                updateJobDocumentField.ActualValue = lot;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Owner_Name")
                        {
                            string ownerName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName + (job.RfpAddress.OwnerContact.Company != null ? " - " + job.RfpAddress.OwnerContact.Company.Name : string.Empty) : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerName,
                                    ActualValue = ownerName,

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = ownerName;
                                updateJobDocumentField.ActualValue = ownerName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Owner_Phone")
                        {
                            string ownerPhone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;
                            if (ownerPhone == null || ownerPhone == "")
                            {
                                ownerPhone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.MobilePhone : string.Empty;
                            }
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerPhone,
                                    ActualValue = ownerPhone

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = ownerPhone;
                                updateJobDocumentField.ActualValue = ownerPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Owner_EMail")
                        {
                            string ownerEmail = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerEmail,
                                    ActualValue = ownerEmail

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = ownerEmail;
                                updateJobDocumentField.ActualValue = ownerEmail;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "Date")
                        {
                            DateTime time = DateTime.Now;
                            //string format = "MMMM d, yyyy";
                            string format = "MM/dd/yy";
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = time.ToString(format),
                                    ActualValue = time.ToString(format)
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = time.ToString(format);
                                updateJobDocumentField.ActualValue = time.ToString(format);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        if (item.Field.FieldName == "FR_Company")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = filingRepresentativeCompany,
                                    ActualValue = filingRepresentativeCompany

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = filingRepresentativeCompany;
                                updateJobDocumentField.ActualValue = filingRepresentativeCompany;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "FR_Phone")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = filingRepresentativePhone,
                                    ActualValue = filingRepresentativePhone

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = filingRepresentativePhone;
                                updateJobDocumentField.ActualValue = filingRepresentativePhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        if (item.Field.FieldName == "FR_EMail")
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = filingRepresentativeEmail,
                                    ActualValue = filingRepresentativeEmail

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = filingRepresentativeEmail;
                                updateJobDocumentField.ActualValue = filingRepresentativeEmail;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();

                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int idApplication = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idApplication).FirstOrDefault();

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idApplication),
                                    ActualValue = jobApplication.ApplicationNumber,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(idApplication);
                                updateJobDocumentField.ActualValue = jobApplication.ApplicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                            rpoContext.SaveChanges();
                        }
                        else if (item.Field.FieldName == "Filing Representative")
                        {
                            int idFilingRepresentative = Convert.ToInt32(frontendFields.Value);
                            //Employee employee = rpoContext.Employees.Where(x => x.Id == idFilingRepresentative).FirstOrDefault();
                            Employee employee = Common.GetEmployeeInformation(idFilingRepresentative);

                            string filingRepresentative = employee != null ? employee.FirstName + " " + employee.LastName : string.Empty;
                            filingRepresentativeCompany = "RPO INC";
                            filingRepresentativePhone = employee != null ? employee.WorkPhone : string.Empty;
                            filingRepresentativeEmail = employee != null ? employee.Email : string.Empty;

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(filingRepresentative) ? "Filing Representative: " + filingRepresentative : string.Empty);

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = filingRepresentative,

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = filingRepresentative;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;

                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields != null ? frontendFields.Value : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields != null ? frontendFields.Value : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                            rpoContext.SaveChanges();

                        }
                    }
                }
            }

            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }

        public static void GenerateAffidavitAsToRoadwayPavementAndSidewalkCurbConstruction(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;
            string jobCompany = string.Empty;
            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();
                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            string jobFileInfo = job != null ? job.JobNumber + " - BPP11-62441.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "County Of")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SS")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Job Company")
                        {
                            //Address address = job != null && job.Company != null && job.Company.Addresses != null ? job.Company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;
                            //string companyAddresss = address != null ? address.Address1 + " " + address.Address2 + " " + address.City + " " + (address.State != null ? address.State.Acronym : string.Empty) + " " + address.ZipCode : string.Empty;
                            //string jobCompany = job != null && job.Company != null ? job.Company.Name + " " + companyAddresss : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobCompany,
                                    ActualValue = jobCompany
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobCompany;
                                updateJobDocumentField.ActualValue = jobCompany;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner With Company")
                        {
                            string owner = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName + (job.RfpAddress.OwnerContact.Company != null ? " - " + job.RfpAddress.OwnerContact.Company.Name : string.Empty) : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = owner,
                                    ActualValue = owner
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = owner;
                                updateJobDocumentField.ActualValue = owner;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Address")
                        {
                            Address address = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Addresses != null ? job.RfpAddress.OwnerContact.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;
                            string ownerAddreess = address != null ? address.Address1 + (!string.IsNullOrEmpty(address.Address2) ? " " + address.Address2 : string.Empty) + (!string.IsNullOrEmpty(address.City) ? " " + address.City : string.Empty) + (address.State != null ? " " + address.State.Acronym : string.Empty) + (!string.IsNullOrEmpty(address.ZipCode) ? " " + address.ZipCode : string.Empty) : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerAddreess,
                                    ActualValue = ownerAddreess
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerAddreess;
                                updateJobDocumentField.ActualValue = ownerAddreess;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Paving Plan")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Dimension Feet")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "By Feet")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Roadway Pav")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Roadway feet By")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "RoadWay Feet abutting")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Job Address")
                        {
                            string jobAddress = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobAddress,
                                    ActualValue = jobAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobAddress;
                                updateJobDocumentField.ActualValue = jobAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Block")
                        {
                            string block = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = block,
                                    ActualValue = block
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = block;
                                updateJobDocumentField.ActualValue = block;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            string lot = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lot,
                                    ActualValue = lot
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = lot;
                                updateJobDocumentField.ActualValue = lot;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Borough")
                        {
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Building Dept")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Applicant")
                        {
                            int idApplicant = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;

                            JobContact jobContact = rpoContext.JobContacts.Include("Contact").Where(x => x.Id == idApplicant).FirstOrDefault();

                            string applicantCompanyName = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name + ", " : string.Empty;

                            Address address = Common.GetContactAddressForJobDocument(jobContact);
                            string applicantCompanyAddress = address != null ? address.Address1 + " " + address.Address2 + " " + address.City + " " + (address.State != null ? address.State.Acronym : string.Empty) + " " + address.ZipCode : string.Empty;
                            jobCompany = applicantCompanyName + applicantCompanyAddress;

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idApplicant),
                                    ActualValue = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idApplicant);
                                updateJobDocumentField.ActualValue = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }

            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateJobDocument(idJobDocument);
        }

        public static void EditAffidavitAsToRoadwayPavementAndSidewalkCurbConstruction(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;
            string jobCompany = string.Empty;
            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();
                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            string jobFileInfo = job != null ? job.JobNumber + " - BPP11-62441.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Job Company")
                        {
                            //Address address = job != null && job.Company != null && job.Company.Addresses != null ? job.Company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;
                            //string companyAddresss = address != null ? address.Address1 + " " + address.Address2 + " " + address.City + " " + (address.State != null ? address.State.Acronym : string.Empty) + " " + address.ZipCode : string.Empty;
                            //string jobCompany = job != null && job.Company != null ? job.Company.Name + " " + companyAddresss : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobCompany,
                                    ActualValue = jobCompany
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobCompany;
                                updateJobDocumentField.ActualValue = jobCompany;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner With Company")
                        {
                            string owner = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName + (job.RfpAddress.OwnerContact.Company != null ? " - " + job.RfpAddress.OwnerContact.Company.Name : string.Empty) : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = owner,
                                    ActualValue = owner
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = owner;
                                updateJobDocumentField.ActualValue = owner;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Address")
                        {
                            Address address = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Addresses != null ? job.RfpAddress.OwnerContact.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;
                            string ownerAddreess = address != null ? address.Address1 + (!string.IsNullOrEmpty(address.Address2) ? " " + address.Address2 : string.Empty) + (!string.IsNullOrEmpty(address.City) ? " " + address.City : string.Empty) + (address.State != null ? " " + address.State.Acronym : string.Empty) + (!string.IsNullOrEmpty(address.ZipCode) ? " " + address.ZipCode : string.Empty) : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerAddreess,
                                    ActualValue = ownerAddreess
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = ownerAddreess;
                                updateJobDocumentField.ActualValue = ownerAddreess;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Job Address")
                        {
                            string jobAddress = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobAddress,
                                    ActualValue = jobAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobAddress;
                                updateJobDocumentField.ActualValue = jobAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Block")
                        {
                            string block = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = block,
                                    ActualValue = block
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = block;
                                updateJobDocumentField.ActualValue = block;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            string lot = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lot,
                                    ActualValue = lot
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = lot;
                                updateJobDocumentField.ActualValue = lot;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Borough")
                        {
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Applicant")
                        {
                            int idApplicant = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;

                            JobContact jobContact = rpoContext.JobContacts.Include("Contact").Where(x => x.Id == idApplicant).FirstOrDefault();

                            string applicantCompanyName = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name + ", " : string.Empty;

                            Address address = Common.GetContactAddressForJobDocument(jobContact);
                            string applicantCompanyAddress = address != null ? address.Address1 + " " + address.Address2 + " " + address.City + " " + (address.State != null ? address.State.Acronym : string.Empty) + " " + address.ZipCode : string.Empty;
                            jobCompany = applicantCompanyName + applicantCompanyAddress;

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idApplicant),
                                    ActualValue = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField && x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(idApplicant);
                                updateJobDocumentField.ActualValue = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }

        /// <summary>
        /// Application for Roadway/Sidewalk Permits(s)
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.</param>
        public static void GenerateApplicationforRoadwayOrSidewalkPermits(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {

            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;
            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                string address = string.Empty;
                string areaCode = string.Empty;
                string phone1 = string.Empty;
                string phone2 = string.Empty;
                string email = string.Empty;

                string permitType = string.Empty;
                string streetFrom = string.Empty;
                string streetTo = string.Empty;
                string streetWorkingOn = string.Empty;
                string permitTypeCode = string.Empty;
                string fees = string.Empty;
                string frAreaCode = string.Empty;
                string frTel2 = string.Empty;
                string frTel3 = string.Empty;

                string iBMNumber = string.Empty;
                string[] permitTypeArr = new string[5];
                string[] permitTypecodeArr = new string[5];
                string[] feesArr = new string[5];



                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();
                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = address,
                                    ActualValue = address
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = address;
                                updateJobDocumentField.ActualValue = address;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "JobFileInfo")
                        {
                            string jobFileInfo = job != null ? job.JobNumber + " - M11-77191.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }


                        else if (item.Field.FieldName == "Area Code")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = areaCode,
                                    ActualValue = areaCode
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = areaCode;
                                updateJobDocumentField.ActualValue = areaCode;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Permittee ID")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = iBMNumber,
                                    ActualValue = iBMNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = iBMNumber;
                                updateJobDocumentField.ActualValue = iBMNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Tel 2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = phone1,
                                    ActualValue = phone1
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = phone1;
                                updateJobDocumentField.ActualValue = phone1;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Tel 3")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = phone2,
                                    ActualValue = phone2
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = phone2;
                                updateJobDocumentField.ActualValue = phone2;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Email")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = email,
                                    ActualValue = email
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = email;
                                updateJobDocumentField.ActualValue = email;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Borough_M")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Manhattan" ? "Yes" : "No") : "No",
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Manhattan" ? "Yes" : "No") : "No"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Manhattan" ? "Yes" : "No") : "No";
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Manhattan" ? "Yes" : "No") : "No";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Borough_B")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Brooklyn" ? "Yes" : "No") : "No",
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Brooklyn" ? "Yes" : "No") : "No"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Brooklyn" ? "Yes" : "No") : "No";
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Brooklyn" ? "Yes" : "No") : "No";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Borough_Q")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Queens" ? "Yes" : "No") : "No",
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Queens" ? "Yes" : "No") : "No"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Queens" ? "Yes" : "No") : "No";
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Queens" ? "Yes" : "No") : "No";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Borough_X")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Bronx" ? "Yes" : "No") : "No",
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Bronx" ? "Yes" : "No") : "No"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Bronx" ? "Yes" : "No") : "No";
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Bronx" ? "Yes" : "No") : "No";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Borough_S")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Staten Island" ? "Yes" : "No") : "No",
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Staten Island" ? "Yes" : "No") : "No"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Staten Island" ? "Yes" : "No") : "No";
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Staten Island" ? "Yes" : "No") : "No";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Engineering Control")
                        {

                            string val = string.Empty;

                            val = job != null && (!string.IsNullOrEmpty(job.OCMCNumber)) ? job.OCMCNumber : string.Empty;

                            if (val.Length >= 9)
                            {
                                val = val.Substring(0, 4);

                            }

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "2 Digit Year")
                        {
                            string val = string.Empty;

                            val = job != null && (!string.IsNullOrEmpty(job.OCMCNumber)) ? job.OCMCNumber : string.Empty;

                            if (val.Length >= 9)
                            {
                                val = val.Substring(4, 2);

                            }

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "File Number")
                        {
                            string val = string.Empty;

                            val = job != null && (!string.IsNullOrEmpty(job.OCMCNumber)) ? job.OCMCNumber : string.Empty;

                            if (val.Length >= 9)
                            {
                                val = val.Substring(6, 3);

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Roadway")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Sidewalk")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "House No")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "On Street")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "DOT_SWO")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = streetWorkingOn,
                                    ActualValue = streetWorkingOn
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = streetWorkingOn;
                                updateJobDocumentField.ActualValue = streetWorkingOn;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "DOT_FromSt")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = streetFrom,
                                    ActualValue = streetFrom
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = streetFrom;
                                updateJobDocumentField.ActualValue = streetFrom;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "DOT_ToSt")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = streetTo,
                                    ActualValue = streetTo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = streetTo;
                                updateJobDocumentField.ActualValue = streetTo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Purpose")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = permitType,
                                    ActualValue = permitType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = permitType;
                                updateJobDocumentField.ActualValue = permitType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Number of Openings")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Area Size")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Frontage Length")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Work Start Month")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Work Start Day")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Work Start Year")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Work End Month")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Work End Day")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Work End Year")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "100")
                        {

                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0100"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "111")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0111"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "113")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0113"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "114")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0114"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "115")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0115"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "116")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0116"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "117")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0117"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "118")
                        {

                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0118"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "119")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0119"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "126")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0126"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "127")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0127"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "132")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0132"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "401")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0401"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "402")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0402"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "403")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0403"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "405")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0405"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "201")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0201"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "202")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0202"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "203")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("203"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "204")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0204"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "205")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0205"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "208")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0208"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "211")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0211"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "214")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.ToUpper().Trim().Equals("0214"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "215")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.ToUpper().Trim().Equals("0215"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "221")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0221"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "701")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0701"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "702")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0702"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "703")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0703"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "704")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0704"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "705")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0705"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Other")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OthePermit")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OS")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CS 1")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CS 2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Dim 1")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Dim 2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Dim 3")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Dim 4")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Dim 5")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "North 1")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "North 2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "North 3")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "North 4")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Permit_1")
                        {
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = permitTypecodeArr != null && permitTypecodeArr.Length > 0 && permitTypecodeArr[0] != null ? permitTypecodeArr[0] : string.Empty,
                                    ActualValue = permitTypecodeArr != null && permitTypecodeArr.Length > 0 && permitTypecodeArr[0] != null ? permitTypecodeArr[0] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = permitTypecodeArr != null && permitTypecodeArr.Length > 0 && permitTypecodeArr[0] != null ? permitTypecodeArr[0] : string.Empty;
                                updateJobDocumentField.ActualValue = permitTypecodeArr != null && permitTypecodeArr.Length > 0 && permitTypecodeArr[0] != null ? permitTypecodeArr[0] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Fee_1")
                        {
                            feesArr = fees.Split(',').ToArray();

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = feesArr != null && feesArr.Length > 0 && feesArr[0] != null ? feesArr[0] : string.Empty,
                                    ActualValue = feesArr != null && feesArr.Length > 0 && feesArr[0] != null ? feesArr[0] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = feesArr != null && feesArr.Length > 0 && feesArr[0] != null ? feesArr[0] : string.Empty;
                                updateJobDocumentField.ActualValue = feesArr != null && feesArr.Length > 0 && feesArr[0] != null ? feesArr[0] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PermitNo_1")
                        {
                            permitTypeArr = permitType.Split(',').ToArray();

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = permitTypeArr != null && permitTypeArr.Length > 0 && permitTypeArr[0] != null ? permitTypeArr[0] : string.Empty,
                                    ActualValue = permitTypeArr != null && permitTypeArr.Length > 0 && permitTypeArr[0] != null ? permitTypeArr[0] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = permitTypeArr != null && permitTypeArr.Length > 0 && permitTypeArr[0] != null ? permitTypeArr[0] : string.Empty;
                                updateJobDocumentField.ActualValue = permitTypeArr != null && permitTypeArr.Length > 0 && permitTypeArr[0] != null ? permitTypeArr[0] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Permit_2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = permitTypecodeArr != null && permitTypecodeArr.Length > 1 && permitTypecodeArr[1] != null ? permitTypecodeArr[1] : string.Empty,
                                    ActualValue = permitTypecodeArr != null && permitTypecodeArr.Length > 1 && permitTypecodeArr[1] != null ? permitTypecodeArr[1] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = permitTypecodeArr != null && permitTypecodeArr.Length > 1 && permitTypecodeArr[1] != null ? permitTypecodeArr[1] : string.Empty;
                                updateJobDocumentField.ActualValue = permitTypecodeArr != null && permitTypecodeArr.Length > 1 && permitTypecodeArr[1] != null ? permitTypecodeArr[1] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Fee_2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = feesArr != null && feesArr.Length > 1 && feesArr[1] != null ? feesArr[1] : string.Empty,
                                    ActualValue = feesArr != null && feesArr.Length > 1 && feesArr[1] != null ? feesArr[1] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = feesArr != null && feesArr.Length > 1 && feesArr[1] != null ? feesArr[1] : string.Empty;
                                updateJobDocumentField.ActualValue = feesArr != null && feesArr.Length > 1 && feesArr[1] != null ? feesArr[1] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PermitNo_2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = permitTypeArr != null && permitTypeArr.Length > 1 && permitTypeArr[1] != null ? permitTypeArr[1] : string.Empty,
                                    ActualValue = permitTypeArr != null && permitTypeArr.Length > 1 && permitTypeArr[1] != null ? permitTypeArr[1] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = permitTypeArr != null && permitTypeArr.Length > 1 && permitTypeArr[1] != null ? permitTypeArr[1] : string.Empty;
                                updateJobDocumentField.ActualValue = permitTypeArr != null && permitTypeArr.Length > 1 && permitTypeArr[1] != null ? permitTypeArr[1] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Permit_3")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = permitTypecodeArr != null && permitTypecodeArr.Length > 2 && permitTypecodeArr[2] != null ? permitTypecodeArr[2] : string.Empty,
                                    ActualValue = permitTypecodeArr != null && permitTypecodeArr.Length > 2 && permitTypecodeArr[2] != null ? permitTypecodeArr[2] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = permitTypecodeArr != null && permitTypecodeArr.Length > 2 && permitTypecodeArr[2] != null ? permitTypecodeArr[2] : string.Empty;
                                updateJobDocumentField.ActualValue = permitTypecodeArr != null && permitTypecodeArr.Length > 2 && permitTypecodeArr[2] != null ? permitTypecodeArr[2] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Fee_3")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = feesArr != null && feesArr.Length > 2 && feesArr[2] != null ? feesArr[2] : string.Empty,
                                    ActualValue = feesArr != null && feesArr.Length > 2 && feesArr[2] != null ? feesArr[2] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = feesArr != null && feesArr.Length > 2 && feesArr[2] != null ? feesArr[2] : string.Empty;
                                updateJobDocumentField.ActualValue = feesArr != null && feesArr.Length > 2 && feesArr[2] != null ? feesArr[2] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PermitNo_3")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = permitTypeArr != null && permitTypeArr.Length > 2 && permitTypeArr[2] != null ? permitTypeArr[2] : string.Empty,
                                    ActualValue = permitTypeArr != null && permitTypeArr.Length > 2 && permitTypeArr[2] != null ? permitTypeArr[2] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = permitTypeArr != null && permitTypeArr.Length > 2 && permitTypeArr[2] != null ? permitTypeArr[2] : string.Empty;
                                updateJobDocumentField.ActualValue = permitTypeArr != null && permitTypeArr.Length > 2 && permitTypeArr[2] != null ? permitTypeArr[2] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Permit_4")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = permitTypecodeArr != null && permitTypecodeArr.Length > 3 && permitTypecodeArr[3] != null ? permitTypecodeArr[3] : string.Empty,
                                    ActualValue = permitTypecodeArr != null && permitTypecodeArr.Length > 3 && permitTypecodeArr[3] != null ? permitTypecodeArr[3] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = permitTypecodeArr != null && permitTypecodeArr.Length > 3 && permitTypecodeArr[3] != null ? permitTypecodeArr[3] : string.Empty;
                                updateJobDocumentField.ActualValue = permitTypecodeArr != null && permitTypecodeArr.Length > 3 && permitTypecodeArr[3] != null ? permitTypecodeArr[3] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Fee_4")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = feesArr != null && feesArr.Length > 3 && feesArr[3] != null ? feesArr[3] : string.Empty,
                                    ActualValue = feesArr != null && feesArr.Length > 3 && feesArr[3] != null ? feesArr[3] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = feesArr != null && feesArr.Length > 3 && feesArr[3] != null ? feesArr[3] : string.Empty;
                                updateJobDocumentField.ActualValue = feesArr != null && feesArr.Length > 3 && feesArr[3] != null ? feesArr[3] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PermitNo_4")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = permitTypeArr != null && permitTypeArr.Length > 3 && permitTypeArr[3] != null ? permitTypeArr[3] : string.Empty,
                                    ActualValue = permitTypeArr != null && permitTypeArr.Length > 3 && permitTypeArr[3] != null ? permitTypeArr[3] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = permitTypeArr != null && permitTypeArr.Length > 3 && permitTypeArr[3] != null ? permitTypeArr[3] : string.Empty;
                                updateJobDocumentField.ActualValue = permitTypeArr != null && permitTypeArr.Length > 3 && permitTypeArr[3] != null ? permitTypeArr[3] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Permit_5")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = permitTypecodeArr != null && permitTypecodeArr.Length > 4 && permitTypecodeArr[4] != null ? permitTypecodeArr[4] : string.Empty,
                                    ActualValue = permitTypecodeArr != null && permitTypecodeArr.Length > 4 && permitTypecodeArr[4] != null ? permitTypecodeArr[4] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = permitTypecodeArr != null && permitTypecodeArr.Length > 4 && permitTypecodeArr[4] != null ? permitTypecodeArr[4] : string.Empty;
                                updateJobDocumentField.ActualValue = permitTypecodeArr != null && permitTypecodeArr.Length > 4 && permitTypecodeArr[4] != null ? permitTypecodeArr[4] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Fee_5")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = feesArr != null && feesArr.Length > 4 && feesArr[4] != null ? feesArr[4] : string.Empty,
                                    ActualValue = feesArr != null && feesArr.Length > 4 && feesArr[4] != null ? feesArr[4] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = feesArr != null && feesArr.Length > 4 && feesArr[4] != null ? feesArr[4] : string.Empty;
                                updateJobDocumentField.ActualValue = feesArr != null && feesArr.Length > 4 && feesArr[4] != null ? feesArr[4] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PermitNo_5")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = permitTypeArr != null && permitTypeArr.Length > 4 && permitTypeArr[4] != null ? permitTypeArr[4] : string.Empty,
                                    ActualValue = permitTypeArr != null && permitTypeArr.Length > 4 && permitTypeArr[4] != null ? permitTypeArr[4] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = permitTypeArr != null && permitTypeArr.Length > 4 && permitTypeArr[4] != null ? permitTypeArr[4] : string.Empty;
                                updateJobDocumentField.ActualValue = permitTypeArr != null && permitTypeArr.Length > 4 && permitTypeArr[4] != null ? permitTypeArr[4] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Area Code 2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frAreaCode,
                                    ActualValue = frAreaCode
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frAreaCode;
                                updateJobDocumentField.ActualValue = frAreaCode;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Tel 22")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frTel2,
                                    ActualValue = frTel2
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frTel2;
                                updateJobDocumentField.ActualValue = frTel2;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Tel 23")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frTel3,
                                    ActualValue = frTel3
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frTel3;
                                updateJobDocumentField.ActualValue = frTel3;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Month")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Day")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Year")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "DOB Application Type - Number / LPC #")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();

                            jobDocument.IdJobApplication = idJobApplication;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "DOT Location")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();

                            streetFrom = jobApplication != null ? jobApplication.StreetFrom : string.Empty;
                            streetTo = jobApplication != null ? jobApplication.StreetTo : string.Empty;
                            streetWorkingOn = jobApplication != null ? jobApplication.StreetWorkingOn : string.Empty;

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(streetWorkingOn) ? "DOT Location: " + streetWorkingOn : string.Empty) + (!string.IsNullOrEmpty(streetFrom) ? " | " + streetFrom : string.Empty) + (!string.IsNullOrEmpty(streetTo) ? " | " + streetTo : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Applicant")
                        {
                            int idApplicant = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobContact jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == idApplicant);
                            Address applicantAddress = Common.GetContactAddressForJobDocument(jobContact);
                            string ApplicationState = applicantAddress != null && applicantAddress.State != null ? applicantAddress.State.Acronym : string.Empty;
                            address = applicantAddress != null ? applicantAddress.Address1 + " " + applicantAddress.Address2 + (!string.IsNullOrEmpty(applicantAddress.City) ? " " + applicantAddress.City : string.Empty) + (!string.IsNullOrEmpty(ApplicationState) ? " " + ApplicationState : string.Empty) + (!string.IsNullOrEmpty(applicantAddress.ZipCode) ? " " + applicantAddress.ZipCode : string.Empty) : string.Empty;
                            email = jobContact != null && jobContact.Contact != null ? jobContact.Contact.Email : string.Empty;
                            string companyName = jobContact != null && jobContact.Company != null ? jobContact.Company.Name : string.Empty;
                            string phoneNo = Common.GetContactPhoneNumberForJobDocument(jobContact);

                            Company company = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company : null;
                            if (company != null && company.CompanyTypes != null && company.CompanyTypes.Where(x => x.ItemName == "General Contractor").Any())
                            {
                                iBMNumber = company.IBMNumber;
                            }

                            if (phoneNo != null)
                            {
                                areaCode = phoneNo.Substring(1, 3);
                                phone1 = phoneNo.Substring(6, 3);
                                phone2 = phoneNo.Substring(10, 4);
                            }
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(companyName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(companyName) ? "Applicant: " + companyName : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idApplicant),
                                    ActualValue = companyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idApplicant);
                                updateJobDocumentField.ActualValue = companyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "DOT Work Type(s)")
                        {
                            // int idJobworkpermitType = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;

                            string workTypes = frontendFields.Value;
                            List<int> workTypesLst = !string.IsNullOrEmpty(workTypes) ? (workTypes.Split(',') != null && workTypes.Split(',').Any() ? workTypes.Split(',').Select(x => int.Parse(x)).ToList() : new List<int>()) : new List<int>();


                            var jobApplicationWorkPermitType = rpoContext.JobApplicationWorkPermitTypes
                                                                        .Include("JobWorkType")
                                                                        .Where(x => workTypesLst.Contains(x.Id))
                                                                        .Select(x => new
                                                                        {
                                                                            Permittype = x.PermitType != null && x.PermitType != "" ? x.PermitType : x.JobWorkType.Description,
                                                                            PermitTypeCode = x.Code,
                                                                            Fees = x.PermitType != null && x.PermitType != "" ? x.RenewalFee : x.EstimatedCost
                                                                        }).ToList();

                            permitType = jobApplicationWorkPermitType != null ? String.Join(",", jobApplicationWorkPermitType.Select(x => x.Permittype)) : string.Empty;
                            permitTypeCode = jobApplicationWorkPermitType != null ? String.Join(",", jobApplicationWorkPermitType.Select(x => x.PermitTypeCode)) : string.Empty;
                            fees = jobApplicationWorkPermitType != null ? String.Join(",", jobApplicationWorkPermitType.Select(x => x.Fees)) : string.Empty;

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(permitType) ? " | DOT Work Type(s): " + permitType : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = workTypes,
                                    ActualValue = permitType,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = workTypes;
                                updateJobDocumentField.ActualValue = permitType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Filing Representitive")
                        {
                            int idFillingRep = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            Employee employee = Common.GetEmployeeInformation(idFillingRep);

                            string employeeName = employee != null ? employee.FirstName + " " + employee.LastName + " - RPO INC" : string.Empty;
                            frAreaCode = employee != null && employee.WorkPhone != null && employee.WorkPhone != "" ? employee.WorkPhone.Substring(1, 3) : string.Empty;
                            frTel2 = employee != null && employee.WorkPhone != null && employee.WorkPhone != "" ? employee.WorkPhone.Substring(6, 3) : string.Empty;
                            frTel3 = employee != null && employee.WorkPhone != null && employee.WorkPhone != "" ? employee.WorkPhone.Substring(10, 4) : string.Empty;

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(employeeName) ? " | Filing Representitive: " + employeeName : string.Empty);
                            //documentDescription = "Filing Representitive: " + employeeName;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = employeeName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = employeeName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Optional Description")
                        {
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(frontendFields.Value) ? " | " : string.Empty) + (!string.IsNullOrEmpty(frontendFields.Value) ? "Optional Description: " + frontendFields.Value : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateJobDocument(idJobDocument);
        }

        public static void EditApplicationforRoadwayOrSidewalkPermits(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {

            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;
            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                string address = string.Empty;
                string areaCode = string.Empty;
                string phone1 = string.Empty;
                string phone2 = string.Empty;
                string email = string.Empty;

                string permitType = string.Empty;
                string streetFrom = string.Empty;
                string streetTo = string.Empty;
                string streetWorkingOn = string.Empty;
                string permitTypeCode = string.Empty;
                string fees = string.Empty;
                string frAreaCode = string.Empty;
                string frTel2 = string.Empty;
                string frTel3 = string.Empty;

                string iBMNumber = string.Empty;
                string[] permitTypeArr = new string[5];
                string[] permitTypecodeArr = new string[5];
                string[] feesArr = new string[5];



                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();
                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = address,
                                    ActualValue = address
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = address;
                                updateJobDocumentField.ActualValue = address;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "JobFileInfo")
                        {
                            string jobFileInfo = job != null ? job.JobNumber + " - M11-77191.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }


                        else if (item.Field.FieldName == "Area Code")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = areaCode,
                                    ActualValue = areaCode
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = areaCode;
                                updateJobDocumentField.ActualValue = areaCode;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Permittee ID")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = iBMNumber,
                                    ActualValue = iBMNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = iBMNumber;
                                updateJobDocumentField.ActualValue = iBMNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Tel 2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = phone1,
                                    ActualValue = phone1
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = phone1;
                                updateJobDocumentField.ActualValue = phone1;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Tel 3")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = phone2,
                                    ActualValue = phone2
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = phone2;
                                updateJobDocumentField.ActualValue = phone2;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Email")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = email,
                                    ActualValue = email
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = email;
                                updateJobDocumentField.ActualValue = email;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Borough_M")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Manhattan" ? "Yes" : "No") : "No",
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Manhattan" ? "Yes" : "No") : "No"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Manhattan" ? "Yes" : "No") : "No";
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Manhattan" ? "Yes" : "No") : "No";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Borough_B")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Brooklyn" ? "Yes" : "No") : "No",
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Brooklyn" ? "Yes" : "No") : "No"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Brooklyn" ? "Yes" : "No") : "No";
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Brooklyn" ? "Yes" : "No") : "No";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Borough_Q")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Queens" ? "Yes" : "No") : "No",
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Queens" ? "Yes" : "No") : "No"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Queens" ? "Yes" : "No") : "No";
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Queens" ? "Yes" : "No") : "No";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Borough_X")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Bronx" ? "Yes" : "No") : "No",
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Bronx" ? "Yes" : "No") : "No"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Bronx" ? "Yes" : "No") : "No";
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Bronx" ? "Yes" : "No") : "No";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Borough_S")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Staten Island" ? "Yes" : "No") : "No",
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Staten Island" ? "Yes" : "No") : "No"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Staten Island" ? "Yes" : "No") : "No";
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? (job.RfpAddress.Borough.Description == "Staten Island" ? "Yes" : "No") : "No";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Engineering Control")
                        {

                            string val = string.Empty;

                            val = job != null && (!string.IsNullOrEmpty(job.OCMCNumber)) ? job.OCMCNumber : string.Empty;

                            if (val.Length >= 9)
                            {
                                val = val.Substring(0, 4);

                            }

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "2 Digit Year")
                        {
                            string val = string.Empty;

                            val = job != null && (!string.IsNullOrEmpty(job.OCMCNumber)) ? job.OCMCNumber : string.Empty;

                            if (val.Length >= 9)
                            {
                                val = val.Substring(4, 2);

                            }

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "File Number")
                        {
                            string val = string.Empty;

                            val = job != null && (!string.IsNullOrEmpty(job.OCMCNumber)) ? job.OCMCNumber : string.Empty;

                            if (val.Length >= 9)
                            {
                                val = val.Substring(6, 3);

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "House No")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "On Street")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "DOT_SWO")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = streetWorkingOn,
                                    ActualValue = streetWorkingOn
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = streetWorkingOn;
                                updateJobDocumentField.ActualValue = streetWorkingOn;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "DOT_FromSt")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = streetFrom,
                                    ActualValue = streetFrom
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = streetFrom;
                                updateJobDocumentField.ActualValue = streetFrom;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "DOT_ToSt")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = streetTo,
                                    ActualValue = streetTo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = streetTo;
                                updateJobDocumentField.ActualValue = streetTo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Purpose")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = permitType,
                                    ActualValue = permitType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = permitType;
                                updateJobDocumentField.ActualValue = permitType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "100")
                        {

                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0100"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "111")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0111"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "113")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0113"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "114")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0114"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "115")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0115"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "116")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0116"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "117")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0117"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "118")
                        {

                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0118"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "119")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0119"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "126")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0126"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "127")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0127"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "132")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0132"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "401")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0401"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "402")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0402"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "403")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0403"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "405")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0405"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "201")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0201"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "202")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0202"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });

                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "203")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("203"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "204")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0204"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "205")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0205"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "208")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0208"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "211")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0211"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "214")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0214"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "215")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0215"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "221")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0221"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "701")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0701"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "702")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0702"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "703")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0703"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "704")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0704"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "705")
                        {
                            string val = string.Empty;
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("0705"));

                            if (str.Length > 0)
                            {
                                val = "Yes";

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }


                        else if (item.Field.FieldName == "Permit_1")
                        {
                            permitTypecodeArr = permitTypeCode.Split(',').ToArray();

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = permitTypecodeArr != null && permitTypecodeArr.Length > 0 && permitTypecodeArr[0] != null ? permitTypecodeArr[0] : string.Empty,
                                    ActualValue = permitTypecodeArr != null && permitTypecodeArr.Length > 0 && permitTypecodeArr[0] != null ? permitTypecodeArr[0] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = permitTypecodeArr != null && permitTypecodeArr.Length > 0 && permitTypecodeArr[0] != null ? permitTypecodeArr[0] : string.Empty;
                                updateJobDocumentField.ActualValue = permitTypecodeArr != null && permitTypecodeArr.Length > 0 && permitTypecodeArr[0] != null ? permitTypecodeArr[0] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Fee_1")
                        {
                            feesArr = fees.Split(',').ToArray();

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = feesArr != null && feesArr.Length > 0 && feesArr[0] != null ? feesArr[0] : string.Empty,
                                    ActualValue = feesArr != null && feesArr.Length > 0 && feesArr[0] != null ? feesArr[0] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = feesArr != null && feesArr.Length > 0 && feesArr[0] != null ? feesArr[0] : string.Empty;
                                updateJobDocumentField.ActualValue = feesArr != null && feesArr.Length > 0 && feesArr[0] != null ? feesArr[0] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PermitNo_1")
                        {
                            permitTypeArr = permitType.Split(',').ToArray();

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = permitTypeArr != null && permitTypeArr.Length > 0 && permitTypeArr[0] != null ? permitTypeArr[0] : string.Empty,
                                    ActualValue = permitTypeArr != null && permitTypeArr.Length > 0 && permitTypeArr[0] != null ? permitTypeArr[0] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = permitTypeArr != null && permitTypeArr.Length > 0 && permitTypeArr[0] != null ? permitTypeArr[0] : string.Empty;
                                updateJobDocumentField.ActualValue = permitTypeArr != null && permitTypeArr.Length > 0 && permitTypeArr[0] != null ? permitTypeArr[0] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Permit_2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = permitTypecodeArr != null && permitTypecodeArr.Length > 1 && permitTypecodeArr[1] != null ? permitTypecodeArr[1] : string.Empty,
                                    ActualValue = permitTypecodeArr != null && permitTypecodeArr.Length > 1 && permitTypecodeArr[1] != null ? permitTypecodeArr[1] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = permitTypecodeArr != null && permitTypecodeArr.Length > 1 && permitTypecodeArr[1] != null ? permitTypecodeArr[1] : string.Empty;
                                updateJobDocumentField.ActualValue = permitTypecodeArr != null && permitTypecodeArr.Length > 1 && permitTypecodeArr[1] != null ? permitTypecodeArr[1] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Fee_2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = feesArr != null && feesArr.Length > 1 && feesArr[1] != null ? feesArr[1] : string.Empty,
                                    ActualValue = feesArr != null && feesArr.Length > 1 && feesArr[1] != null ? feesArr[1] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = feesArr != null && feesArr.Length > 1 && feesArr[1] != null ? feesArr[1] : string.Empty;
                                updateJobDocumentField.ActualValue = feesArr != null && feesArr.Length > 1 && feesArr[1] != null ? feesArr[1] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PermitNo_2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = permitTypeArr != null && permitTypeArr.Length > 1 && permitTypeArr[1] != null ? permitTypeArr[1] : string.Empty,
                                    ActualValue = permitTypeArr != null && permitTypeArr.Length > 1 && permitTypeArr[1] != null ? permitTypeArr[1] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = permitTypeArr != null && permitTypeArr.Length > 1 && permitTypeArr[1] != null ? permitTypeArr[1] : string.Empty;
                                updateJobDocumentField.ActualValue = permitTypeArr != null && permitTypeArr.Length > 1 && permitTypeArr[1] != null ? permitTypeArr[1] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Permit_3")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = permitTypecodeArr != null && permitTypecodeArr.Length > 2 && permitTypecodeArr[2] != null ? permitTypecodeArr[2] : string.Empty,
                                    ActualValue = permitTypecodeArr != null && permitTypecodeArr.Length > 2 && permitTypecodeArr[2] != null ? permitTypecodeArr[2] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = permitTypecodeArr != null && permitTypecodeArr.Length > 2 && permitTypecodeArr[2] != null ? permitTypecodeArr[2] : string.Empty;
                                updateJobDocumentField.ActualValue = permitTypecodeArr != null && permitTypecodeArr.Length > 2 && permitTypecodeArr[2] != null ? permitTypecodeArr[2] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });

                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Fee_3")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = feesArr != null && feesArr.Length > 2 && feesArr[2] != null ? feesArr[2] : string.Empty,
                                    ActualValue = feesArr != null && feesArr.Length > 2 && feesArr[2] != null ? feesArr[2] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = feesArr != null && feesArr.Length > 2 && feesArr[2] != null ? feesArr[2] : string.Empty;
                                updateJobDocumentField.ActualValue = feesArr != null && feesArr.Length > 2 && feesArr[2] != null ? feesArr[2] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PermitNo_3")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = permitTypeArr != null && permitTypeArr.Length > 2 && permitTypeArr[2] != null ? permitTypeArr[2] : string.Empty,
                                    ActualValue = permitTypeArr != null && permitTypeArr.Length > 2 && permitTypeArr[2] != null ? permitTypeArr[2] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = permitTypeArr != null && permitTypeArr.Length > 2 && permitTypeArr[2] != null ? permitTypeArr[2] : string.Empty;
                                updateJobDocumentField.ActualValue = permitTypeArr != null && permitTypeArr.Length > 2 && permitTypeArr[2] != null ? permitTypeArr[2] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Permit_4")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = permitTypecodeArr != null && permitTypecodeArr.Length > 3 && permitTypecodeArr[3] != null ? permitTypecodeArr[3] : string.Empty,
                                    ActualValue = permitTypecodeArr != null && permitTypecodeArr.Length > 3 && permitTypecodeArr[3] != null ? permitTypecodeArr[3] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = permitTypecodeArr != null && permitTypecodeArr.Length > 3 && permitTypecodeArr[3] != null ? permitTypecodeArr[3] : string.Empty;
                                updateJobDocumentField.ActualValue = permitTypecodeArr != null && permitTypecodeArr.Length > 3 && permitTypecodeArr[3] != null ? permitTypecodeArr[3] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Fee_4")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = feesArr != null && feesArr.Length > 3 && feesArr[3] != null ? feesArr[3] : string.Empty,
                                    ActualValue = feesArr != null && feesArr.Length > 3 && feesArr[3] != null ? feesArr[3] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = feesArr != null && feesArr.Length > 3 && feesArr[3] != null ? feesArr[3] : string.Empty;
                                updateJobDocumentField.ActualValue = feesArr != null && feesArr.Length > 3 && feesArr[3] != null ? feesArr[3] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PermitNo_4")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = permitTypeArr != null && permitTypeArr.Length > 3 && permitTypeArr[3] != null ? permitTypeArr[3] : string.Empty,
                                    ActualValue = permitTypeArr != null && permitTypeArr.Length > 3 && permitTypeArr[3] != null ? permitTypeArr[3] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = permitTypeArr != null && permitTypeArr.Length > 3 && permitTypeArr[3] != null ? permitTypeArr[3] : string.Empty;
                                updateJobDocumentField.ActualValue = permitTypeArr != null && permitTypeArr.Length > 3 && permitTypeArr[3] != null ? permitTypeArr[3] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Permit_5")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = permitTypecodeArr != null && permitTypecodeArr.Length > 4 && permitTypecodeArr[4] != null ? permitTypecodeArr[4] : string.Empty,
                                    ActualValue = permitTypecodeArr != null && permitTypecodeArr.Length > 4 && permitTypecodeArr[4] != null ? permitTypecodeArr[4] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = permitTypecodeArr != null && permitTypecodeArr.Length > 4 && permitTypecodeArr[4] != null ? permitTypecodeArr[4] : string.Empty;
                                updateJobDocumentField.ActualValue = permitTypecodeArr != null && permitTypecodeArr.Length > 4 && permitTypecodeArr[4] != null ? permitTypecodeArr[4] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Fee_5")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = feesArr != null && feesArr.Length > 4 && feesArr[4] != null ? feesArr[4] : string.Empty,
                                    ActualValue = feesArr != null && feesArr.Length > 4 && feesArr[4] != null ? feesArr[4] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = feesArr != null && feesArr.Length > 4 && feesArr[4] != null ? feesArr[4] : string.Empty;
                                updateJobDocumentField.ActualValue = feesArr != null && feesArr.Length > 4 && feesArr[4] != null ? feesArr[4] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PermitNo_5")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = permitTypeArr != null && permitTypeArr.Length > 4 && permitTypeArr[4] != null ? permitTypeArr[4] : string.Empty,
                                    ActualValue = permitTypeArr != null && permitTypeArr.Length > 4 && permitTypeArr[4] != null ? permitTypeArr[4] : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = permitTypeArr != null && permitTypeArr.Length > 4 && permitTypeArr[4] != null ? permitTypeArr[4] : string.Empty;
                                updateJobDocumentField.ActualValue = permitTypeArr != null && permitTypeArr.Length > 4 && permitTypeArr[4] != null ? permitTypeArr[4] : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Area Code 2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frAreaCode,
                                    ActualValue = frAreaCode
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frAreaCode;
                                updateJobDocumentField.ActualValue = frAreaCode;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Tel 22")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frTel2,
                                    ActualValue = frTel2
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frTel2;
                                updateJobDocumentField.ActualValue = frTel2;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Tel 23")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frTel3,
                                    ActualValue = frTel3
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frTel3;
                                updateJobDocumentField.ActualValue = frTel3;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }


                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "DOB Application Type - Number / LPC #")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();

                            jobDocument.IdJobApplication = idJobApplication;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "DOT Location")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();

                            streetFrom = jobApplication != null ? jobApplication.StreetFrom : string.Empty;
                            streetTo = jobApplication != null ? jobApplication.StreetTo : string.Empty;
                            streetWorkingOn = jobApplication != null ? jobApplication.StreetWorkingOn : string.Empty;

                            documentDescription = documentDescription + (jobApplication != null && jobApplication.JobApplicationType != null ? "DOT Location " + jobApplication.JobApplicationType.Description : string.Empty) + (!string.IsNullOrEmpty(streetFrom) ? streetFrom : string.Empty) + (!string.IsNullOrEmpty(streetTo) ? " | " + streetTo : string.Empty) + (!string.IsNullOrEmpty(streetWorkingOn) ? " | " + streetWorkingOn : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idJobApplication),
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(idJobApplication);
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Applicant")
                        {
                            int idApplicant = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobContact jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == idApplicant);
                            Address applicantAddress = Common.GetContactAddressForJobDocument(jobContact);
                            string ApplicationState = applicantAddress != null && applicantAddress.State != null ? applicantAddress.State.Acronym : string.Empty;
                            address = applicantAddress != null ? applicantAddress.Address1 + " " + applicantAddress.Address2 + (!string.IsNullOrEmpty(applicantAddress.City) ? " " + applicantAddress.City : string.Empty) + (!string.IsNullOrEmpty(ApplicationState) ? " " + ApplicationState : string.Empty) + (!string.IsNullOrEmpty(applicantAddress.ZipCode) ? " " + applicantAddress.ZipCode : string.Empty) : string.Empty;
                            email = jobContact != null && jobContact.Contact != null ? jobContact.Contact.Email : string.Empty;
                            string companyName = jobContact != null && jobContact.Company != null ? jobContact.Company.Name : string.Empty;
                            string phoneNo = Common.GetContactPhoneNumberForJobDocument(jobContact);

                            Company company = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company : null;
                            if (company != null && company.CompanyTypes != null && company.CompanyTypes.Where(x => x.ItemName == "General Contractor").Any())
                            {
                                iBMNumber = company.IBMNumber;
                            }

                            if (phoneNo != null)
                            {
                                areaCode = phoneNo.Substring(1, 3);
                                phone1 = phoneNo.Substring(6, 3);
                                phone2 = phoneNo.Substring(10, 4);
                            }
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(companyName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(companyName) ? "Applicant: " + companyName : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(idApplicant),
                                    ActualValue = companyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField && x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(idApplicant);
                                updateJobDocumentField.ActualValue = companyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "DOT Work Type(s)")
                        {
                            // int idJobworkpermitType = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;

                            string workTypes = frontendFields.Value;
                            List<int> workTypesLst = !string.IsNullOrEmpty(workTypes) ? (workTypes.Split(',') != null && workTypes.Split(',').Any() ? workTypes.Split(',').Select(x => int.Parse(x)).ToList() : new List<int>()) : new List<int>();


                            var jobApplicationWorkPermitType = rpoContext.JobApplicationWorkPermitTypes
                                                                        .Include("JobWorkType")
                                                                        .Where(x => workTypesLst.Contains(x.Id))
                                                                        .Select(x => new
                                                                        {
                                                                            Permittype = x.PermitType != null && x.PermitType != "" ? x.PermitType : x.JobWorkType.Description,
                                                                            PermitTypeCode = x.Code,
                                                                            Fees = x.PermitType != null && x.PermitType != "" ? x.RenewalFee : x.EstimatedCost
                                                                        }).ToList();

                            permitType = jobApplicationWorkPermitType != null ? String.Join(",", jobApplicationWorkPermitType.Select(x => x.Permittype)) : string.Empty;
                            permitTypeCode = jobApplicationWorkPermitType != null ? String.Join(",", jobApplicationWorkPermitType.Select(x => x.PermitTypeCode)) : string.Empty;
                            fees = jobApplicationWorkPermitType != null ? String.Join(",", jobApplicationWorkPermitType.Select(x => x.Fees)) : string.Empty;

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(permitType) ? " | DOT Work Type(s): " + permitType : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = workTypes,
                                    ActualValue = permitType,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = workTypes;
                                updateJobDocumentField.ActualValue = permitType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Filing Representitive")
                        {
                            int idFillingRep = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            Employee employee = Common.GetEmployeeInformation(idFillingRep);

                            string employeeName = employee != null ? employee.FirstName + " " + employee.LastName + " - RPO INC" : string.Empty;
                            frAreaCode = employee != null && employee.WorkPhone != null && employee.WorkPhone != "" ? employee.WorkPhone.Substring(1, 3) : string.Empty;
                            frTel2 = employee != null && employee.WorkPhone != null && employee.WorkPhone != "" ? employee.WorkPhone.Substring(6, 3) : string.Empty;
                            frTel3 = employee != null && employee.WorkPhone != null && employee.WorkPhone != "" ? employee.WorkPhone.Substring(10, 4) : string.Empty;

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(employeeName) ? " | Filing Representitive: " + employeeName : string.Empty);
                            //documentDescription = "Filing Representitive: " + employeeName;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = employeeName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = employeeName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Optional Description")
                        {
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(frontendFields.Value) ? " | " : string.Empty) + (!string.IsNullOrEmpty(frontendFields.Value) ? "Optional Description: " + frontendFields.Value : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }

        /// <summary>
        /// Builder's Pavement Plan - Authorization to the Dept of Transportation
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.</param>
        public static void GenerateBuildersPavementPlanAuthorizationtotheDeptofTransportation(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {

            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("RfpAddress.OwnerContact").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                string applicationNumber = string.Empty;
                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();

                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);


                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            string jobFileInfo = job != null ? job.JobNumber + " - BPP5-81336.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BPP")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BIS")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicationNumber,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicationNumber;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Permit")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Project Lead Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Boro")
                        {
                            var Borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough : null;
                            var BoroughValue = string.Empty;

                            if (Borough != null)
                            {
                                //if (Borough == "Brooklyn")
                                //{
                                //    BoroughValue = "1";
                                //}
                                //else if (Borough == "Bronx")
                                //{
                                //    BoroughValue = "2";
                                //}
                                //else if (Borough == "Manhattan")
                                //{
                                //    BoroughValue = "3";
                                //}
                                //else if (Borough == "Queens")
                                //{
                                //    BoroughValue = "4";
                                //}
                                //else if (Borough == "Staten Island")
                                //{
                                //    BoroughValue = "5";
                                //}
                                BoroughValue = Convert.ToString(Borough.BisCode);
                            }

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = BoroughValue,
                                    ActualValue = BoroughValue
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = BoroughValue;
                                updateJobDocumentField.ActualValue = BoroughValue;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Block")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Telephone Number")
                        {
                            var telephoneNumber = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;
                            if (telephoneNumber == null || telephoneNumber == "")
                            {
                                telephoneNumber = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.MobilePhone : string.Empty;
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = telephoneNumber,
                                    ActualValue = telephoneNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = telephoneNumber;
                                updateJobDocumentField.ActualValue = telephoneNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Email Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street Number 1")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street From 1")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street To 1")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "New Curb 1")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "New Curb1 LFT")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "New Concrete Walk 1")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "New Concrete Walk1 LFT")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "New Roadway Pavment 1")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "New Roadway Pavment1 LFT")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Feet Wide 1")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street Number 2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street From 2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street To 2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "New Curb 2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "New Curb2 LFT")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "New Concrete Walk 2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "New Concrete Walk2 LFT")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "New Roadway Pavment 2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "New Roadway Pavment2 LFT")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Feet Wide 2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street Number 3")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street From 3")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street To 3")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "New Curb 3")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "New Curb3 LFT")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "New Concrete Walk 3")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "New Concrete Walk3 LFT")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "New Roadway Pavment 3")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "New Roadway Pavment3 LFT")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Feet Wide 3")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Date 1")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Date 2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.FirstOrDefault(x => x.Id == applicantId);
                            applicationNumber = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Applicant")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.Include("Contact").FirstOrDefault(x => x.Id == applicantId);

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(applicantName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicantName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicantName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                }
            }

            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();

            GenerateJobDocument(idJobDocument);
        }

        public static void EditBuildersPavementPlanAuthorizationtotheDeptofTransportation(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {

            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("RfpAddress.OwnerContact").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                string applicationNumber = string.Empty;
                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();

                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);


                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            string jobFileInfo = job != null ? job.JobNumber + " - BPP5-81336.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BIS")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicationNumber,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicationNumber;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Project Lead Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Boro")
                        {
                            var Borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough : null;
                            var BoroughValue = string.Empty;

                            if (Borough != null)
                            {
                                //if (Borough == "Brooklyn")
                                //{
                                //    BoroughValue = "1";
                                //}
                                //else if (Borough == "Bronx")
                                //{
                                //    BoroughValue = "2";
                                //}
                                //else if (Borough == "Manhattan")
                                //{
                                //    BoroughValue = "3";
                                //}
                                //else if (Borough == "Queens")
                                //{
                                //    BoroughValue = "4";
                                //}
                                //else if (Borough == "Staten Island")
                                //{
                                //    BoroughValue = "5";
                                //}
                                BoroughValue = Convert.ToString(Borough.BisCode);
                            }

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = BoroughValue,
                                    ActualValue = BoroughValue
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = BoroughValue;
                                updateJobDocumentField.ActualValue = BoroughValue;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Block")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Telephone Number")
                        {
                            var telephoneNumber = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;
                            if (telephoneNumber == null || telephoneNumber == "")
                            {
                                telephoneNumber = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.MobilePhone : string.Empty;
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = telephoneNumber,
                                    ActualValue = telephoneNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = telephoneNumber;
                                updateJobDocumentField.ActualValue = telephoneNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Email Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }


                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.FirstOrDefault(x => x.Id == applicantId);
                            applicationNumber = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Applicant")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.Include("Contact").FirstOrDefault(x => x.Id == applicantId);

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(applicantName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicantName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicantName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                }
            }

            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }

        /// <summary>
        ///  Request Items for Builders Payment Plan Signoff
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.</param>
        public static void GenerateRequestItemsforBuildersPaymentPlanSignoff(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {

            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("RfpAddress.OwnerContact").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                string applicationNumber = string.Empty;

                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();
                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "BPP NO")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BIS NO")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicationNumber,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicationNumber;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Permit")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lead Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "boro")
                        {
                            //string borough = job.RfpAddress != null && job.RfpAddress.Borough != null ? Convert.ToString(job.RfpAddress.Borough.BisCode) : string.Empty;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Block")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner name")
                        {
                            string ownerCompany = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Company != null ? job.RfpAddress.OwnerContact.Company.Name : string.Empty;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName + (!string.IsNullOrEmpty(ownerCompany) ? " - " + ownerCompany : string.Empty) : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName + (!string.IsNullOrEmpty(ownerCompany) ? " - " + ownerCompany : string.Empty) : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName + (!string.IsNullOrEmpty(ownerCompany) ? " - " + ownerCompany : string.Empty) : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName + (!string.IsNullOrEmpty(ownerCompany) ? " - " + ownerCompany : string.Empty) : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Telephone no")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "email")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "House number Apply to")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "House number Specific Sign off")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Certification of Inspection")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Concrete")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Department of Transportation")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Engineer Affidevit")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Final Survey")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Remove tree")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Plant new Tree")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Road Way")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "side Walk")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Waiver of Curb")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Waiver of Legal")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Plan Examiner")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Date")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application")
                        {
                            int Certifierid = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == Certifierid).FirstOrDefault();
                            applicationNumber = (jobApplication != null) ? jobApplication.ApplicationNumber : string.Empty;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }
            GenerateJobDocument(idJobDocument);
        }


        public static void EditRequestItemsforBuildersPaymentPlanSignoff(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {

            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("RfpAddress.OwnerContact").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                string applicationNumber = string.Empty;

                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();
                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {

                        if (item.Field.FieldName == "BIS NO")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicationNumber,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicationNumber;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Lead Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Block")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner name")
                        {
                            string ownerCompany = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Company != null ? job.RfpAddress.OwnerContact.Company.Name : string.Empty;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName + (!string.IsNullOrEmpty(ownerCompany) ? " - " + ownerCompany : string.Empty) : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName + (!string.IsNullOrEmpty(ownerCompany) ? " - " + ownerCompany : string.Empty) : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName + (!string.IsNullOrEmpty(ownerCompany) ? " - " + ownerCompany : string.Empty) : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName + (!string.IsNullOrEmpty(ownerCompany) ? " - " + ownerCompany : string.Empty) : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Telephone no")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "email")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "House number Apply to")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "House number Specific Sign off")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application")
                        {
                            int Certifierid = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == Certifierid).FirstOrDefault();
                            applicationNumber = (jobApplication != null) ? jobApplication.ApplicationNumber : string.Empty;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }
                }
            }
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }
        /// <summary>
        /// Application for B45M Request Fire Alarm Inspection
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="jobDocumentCreateOrUpdateDTO">The job document create or update dto.</param>
        public static void GenerateB45MRequestFireAlarmInspection(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {

            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;
            JobDocumentType jobDocumentType = new JobDocumentType();
            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("RfpAddress.OwnerContact").
                    Include("RfpAddress.Company.Addresses").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();
                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();

                var applicantName = string.Empty;
                var LicenceNumber = string.Empty;
                var phone = string.Empty;
                var fax = string.Empty;
                var cell = string.Empty;
                var email = string.Empty;
                string compAddress = string.Empty;
                string applicantCompany = string.Empty;
                string businessFax = string.Empty;
                string businessCity = string.Empty;
                string businessState = string.Empty;
                string businessZip = string.Empty;

                string floorWorkingOn = string.Empty;
                string workDescription = string.Empty;
                string chkFirst = string.Empty;
                string chkSecond = string.Empty;
                string chkThird = string.Empty;
                string jobDocType = string.Empty;
                string refNumber = string.Empty;
                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            string jobFileInfo = job != null ? job.JobNumber + " - B45M-62412.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }



                        else if (item.Field.FieldName == "txtRef_No")
                        {
                            string val = refNumber;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "DATE")
                        {

                            DateTime date = DateTime.Now;
                            string format = "MM/dd/yy";

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = date.ToString(format),
                                    ActualValue = date.ToString(format)
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = date.ToString(format);
                                updateJobDocumentField.ActualValue = date.ToString(format);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ADDRESS")
                        {
                            var val = (job != null && job.RfpAddress != null) ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street + (job.RfpAddress.Borough != null ? ' ' + job.RfpAddress.Borough.Description : string.Empty) + (job.RfpAddress.ZipCode != null ? ' ' + job.RfpAddress.ZipCode : string.Empty) : string.Empty;                           
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        //else if (item.Field.FieldName == "BORO")
                        //{
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty,
                        //            ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty
                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                        //        updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        //else if (item.Field.FieldName == "ZIP")
                        //{
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = job != null && job.RfpAddress != null ? job.RfpAddress.ZipCode : string.Empty,
                        //            ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.ZipCode : string.Empty

                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.ZipCode : string.Empty;
                        //        updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.ZipCode : string.Empty;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        else if (item.Field.FieldName == "BUSINESS NAME")
                        {
                            string specialPlaceName = job != null ? job.SpecialPlace : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = specialPlaceName,
                                    ActualValue = specialPlaceName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = specialPlaceName;
                                updateJobDocumentField.ActualValue = specialPlaceName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PREMISES TELEPHONE")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "NEARESTINTERSECTION")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Meeting Location")
                        {
                            string meetingLocation = "LOBBY";
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = meetingLocation,
                                    ActualValue = meetingLocation
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = meetingLocation;
                                updateJobDocumentField.ActualValue = meetingLocation;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Floors")
                        {
                            floorWorkingOn = job != null ? job.FloorNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = floorWorkingOn,
                                    ActualValue = floorWorkingOn,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = floorWorkingOn;
                                updateJobDocumentField.ActualValue = floorWorkingOn;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "F.D. EXPEDITOR LIC NO")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = LicenceNumber,
                                    ActualValue = LicenceNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = LicenceNumber;
                                updateJobDocumentField.ActualValue = LicenceNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Request Phone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = phone,
                                    ActualValue = phone,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = phone;
                                updateJobDocumentField.ActualValue = phone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Request Fax")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fax,
                                    ActualValue = fax

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = fax;
                                updateJobDocumentField.ActualValue = fax;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Request MobilePhone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = cell,
                                    ActualValue = cell
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = cell;
                                updateJobDocumentField.ActualValue = cell;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Request EMail")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = email,
                                    ActualValue = email
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = email;
                                updateJobDocumentField.ActualValue = email;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Request Company")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompany,
                                    ActualValue = applicantCompany
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompany;
                                updateJobDocumentField.ActualValue = applicantCompany;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Request Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = compAddress + " " + businessCity + " " + businessState + " " + businessZip,
                                    ActualValue = compAddress + " " + businessCity + " " + businessState + " " + businessZip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = compAddress + " " + businessCity + " " + businessState + " " + businessZip;
                                updateJobDocumentField.ActualValue = compAddress + " " + businessCity + " " + businessState + " " + businessZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Phone")
                        {
                            string telephone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;
                            if (telephone == null || telephone == "")
                            {
                                telephone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.MobilePhone : string.Empty;
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = telephone,
                                    ActualValue = telephone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = telephone;
                                updateJobDocumentField.ActualValue = telephone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner EMail")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner CompanyAddress")
                        {
                            string companyName = job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Company != null ? job.RfpAddress.OwnerContact.Company.Name : string.Empty;
                            Address addressCompany = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Company != null
                                && job.RfpAddress.OwnerContact.Company.Addresses != null ? job.RfpAddress.OwnerContact.Company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;
                            //Company company = job != null && job.RfpAddress != null && job.RfpAddress.Company != null ? job.RfpAddress.Company : null;
                            //Address companyAddress = job != null && job.RfpAddress != null && job.RfpAddress.Company.Addresses.FirstOrDefault() != null ? job.RfpAddress.Company.Addresses.FirstOrDefault(x => x.IsMainAddress == true) : null;

                            string address = addressCompany != null ? companyName + " " + addressCompany.Address1 + " " + addressCompany.Address2 + " " + addressCompany.City + " " + (addressCompany.State != null ? addressCompany.State.Acronym : string.Empty) + " " + addressCompany.ZipCode : string.Empty;
                            if (updateJobDocumentField == null)
                            {

                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = address,
                                    ActualValue = address

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = address;
                                updateJobDocumentField.ActualValue = address;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Electrician")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "TM1")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FDPlans")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PW1")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = chkFirst,
                                    ActualValue = chkFirst
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = chkFirst;
                                updateJobDocumentField.ActualValue = chkFirst;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "TB60")
                        {
                            if (updateJobDocumentField == null)
                            {

                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "B45")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = chkSecond,
                                    ActualValue = chkSecond
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = chkSecond;
                                updateJobDocumentField.ActualValue = chkSecond;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "File")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = chkThird,
                                    ActualValue = chkThird
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = chkThird;
                                updateJobDocumentField.ActualValue = chkThird;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "txtJob_Description")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = workDescription,
                                    ActualValue = workDescription
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = workDescription;
                                updateJobDocumentField.ActualValue = workDescription;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                    else
                    {

                        if (item.Field.FieldName == "Application Type")
                        {
                            int applicationTypeId = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.FirstOrDefault(x => x.Id == applicationTypeId);

                            string applicationNumber = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                            jobDocument.IdJobApplication = applicationTypeId;
                            if (jobDocType.ToLower() == ("DOB").ToLower())
                            {

                                if (jobDocType.ToLower() == ("DOB").ToLower())
                                    refNumber = applicationNumber;
                                //floorWorkingOn = jobApplication != null ? jobApplication.FloorWorking : string.Empty;
                                //workDescription = jobApplication!=null ? string.Join(", ", jobApplication.WorkPermitTypes.Select(x => x.WorkDescription)):string.Empty;
                                workDescription = jobApplication != null ? string.Join(", ", jobApplication.WorkPermitTypes.Where(x => !string.IsNullOrEmpty(x.WorkDescription)).Select(x => x.WorkDescription)) : string.Empty;

                            }

                            if (updateJobDocumentField == null)
                            {



                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = (jobDocumentType != null) ? jobDocumentType.Type : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = (jobDocumentType != null) ? jobDocumentType.Type : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Type")
                        {
                            int typeId = Convert.ToInt32(frontendFields.Value);
                            jobDocumentType = rpoContext.JobDocumentTypes.Where(x => x.Id == typeId).FirstOrDefault();
                            jobDocType = (jobDocumentType != null) ? jobDocumentType.Type : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(jobDocType) ? "Type: " + jobDocType : string.Empty);
                            if (jobDocType.ToLower() == ("DOB").ToLower())
                            {
                                chkFirst = "Yes";
                                chkSecond = "Yes";
                                chkThird = "Yes";
                            }
                            else if (jobDocType.ToLower() == ("Letter of Defect").ToLower())
                            {
                                chkSecond = "Yes";
                                chkThird = "Yes";
                            }
                            else if (jobDocType.ToLower() == ("Violation").ToLower())
                            {
                                chkSecond = "Yes";
                                chkThird = "Yes";
                            }
                            if (updateJobDocumentField == null)
                            {

                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = jobDocType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = jobDocType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "Applicant")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.Where(x => x.Id == applicantId).FirstOrDefault();

                            string applicant = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            applicant = applicant != null ? applicant : string.Empty;
                            Address compnayAddress = Common.GetContactAddressForJobDocument(jobContact);
                            applicantCompany = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;

                            phone = Common.GetContactPhoneNumberForJobDocument(jobContact);
                            email = jobContact != null && jobContact.Contact != null ? jobContact.Contact.Email : string.Empty;
                            email = email != null ? email : string.Empty;
                            cell = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MobilePhone : string.Empty;

                            compAddress = compnayAddress != null ? compnayAddress.Address1 + " " + compnayAddress.Address2 : string.Empty;
                            businessFax = string.Empty;
                            businessCity = compnayAddress != null ? compnayAddress.City : string.Empty;
                            businessState = compnayAddress != null && compnayAddress.State != null ? compnayAddress.State.Acronym : string.Empty;
                            businessZip = compnayAddress != null ? compnayAddress.ZipCode : string.Empty;

                            ContactLicense contactLicNumber = jobContact != null ? jobContact.Contact.ContactLicenses.FirstOrDefault() : null;
                            LicenceNumber = contactLicNumber != null ? contactLicNumber.Number : string.Empty;


                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicant) && !string.IsNullOrEmpty(applicant) ? " | " : string.Empty) + (!string.IsNullOrEmpty(applicant) ? "Applicant: " + applicant : string.Empty);
                            if (updateJobDocumentField == null)
                            {

                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(applicantId),
                                    ActualValue = applicant
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = Convert.ToString(applicantId);
                                updateJobDocumentField.ActualValue = applicant;

                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "REFERENCE DOCUMENT No:")
                        {


                            jobDocType = (jobDocumentType != null) ? jobDocumentType.Type : string.Empty;
                            if (jobDocType.ToLower() == ("Violation").ToLower())
                            {
                                refNumber = frontendFields.Value;

                                documentDescription = documentDescription + " | Violation #: " + refNumber;

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "Letter of Defect #")
                        {
                            jobDocType = (jobDocumentType != null) ? jobDocumentType.Type : string.Empty;
                            if (jobDocType.ToLower() == ("Letter of Defect").ToLower())
                            {
                                refNumber = frontendFields.Value;

                                documentDescription = documentDescription + " | Letter of Defect #: " + refNumber;

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "Optional Description")
                        {
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(frontendFields.Value) ? " | " : string.Empty) + (!string.IsNullOrEmpty(frontendFields.Value) ? "Optional Description: " + frontendFields.Value : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }
                    }
                }
                jobDocument.DocumentDescription = documentDescription;
                jobDocument.JobDocumentFor = jobDocumentFor;
                rpoContext.SaveChanges();
                GenerateJobDocument(idJobDocument);
            }
        }


        public static void EditB45MRequestFireAlarmInspection(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {

            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;
            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            JobDocumentType jobDocumentType = new JobDocumentType();
            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("RfpAddress.OwnerContact").
                    Include("RfpAddress.Company.Addresses").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();
                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();

                var applicantName = string.Empty;
                var LicenceNumber = string.Empty;
                var phone = string.Empty;
                var fax = string.Empty;
                var cell = string.Empty;
                var email = string.Empty;
                string compAddress = string.Empty;
                string applicantCompany = string.Empty;
                string businessFax = string.Empty;
                string businessCity = string.Empty;
                string businessState = string.Empty;
                string businessZip = string.Empty;

                string floorWorkingOn = string.Empty;
                string workDescription = string.Empty;
                string chkFirst = string.Empty;
                string chkSecond = string.Empty;
                string chkThird = string.Empty;
                string jobDocType = string.Empty;
                string refNumber = string.Empty;
                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            string jobFileInfo = job != null ? job.JobNumber + " - B45M-62412.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }



                        else if (item.Field.FieldName == "txtRef_No")
                        {
                            string val = refNumber;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "DATE")
                        {

                            DateTime date = DateTime.Now;
                            string format = "MM/dd/yy";

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = date.ToString(format),
                                    ActualValue = date.ToString(format)
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = date.ToString(format);
                                updateJobDocumentField.ActualValue = date.ToString(format);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ADDRESS")
                        {
                            //var val = (job != null && job.RfpAddress != null) ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street : string.Empty;
                            var val = (job != null && job.RfpAddress != null) ? job.RfpAddress.HouseNumber + ' ' + job.RfpAddress.Street + (job.RfpAddress.Borough != null ? ' ' + job.RfpAddress.Borough.Description : string.Empty) + (job.RfpAddress.ZipCode != null ? ' ' + job.RfpAddress.ZipCode : string.Empty) : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = val,
                                    ActualValue = val
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = val;
                                updateJobDocumentField.ActualValue = val;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        //else if (item.Field.FieldName == "BORO")
                        //{
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty,
                        //            ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty
                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    }
                        //    else
                        //    {
                        //        string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                        //        pdfFields.Add(pdffield);
                        //        updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                        //        updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        FieldsValue.Add(new IdItemName
                        //        {
                        //            Id = pdffield,
                        //            ItemName = updateJobDocumentField.ActualValue
                        //        });
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        //else if (item.Field.FieldName == "ZIP")
                        //{
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = job != null && job.RfpAddress != null ? job.RfpAddress.ZipCode : string.Empty,
                        //            ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.ZipCode : string.Empty

                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    }
                        //    else
                        //    {
                        //        string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                        //        pdfFields.Add(pdffield);
                        //        updateJobDocumentField.Value = job != null && job.RfpAddress != null ? job.RfpAddress.ZipCode : string.Empty;
                        //        updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null ? job.RfpAddress.ZipCode : string.Empty;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        FieldsValue.Add(new IdItemName
                        //        {
                        //            Id = pdffield,
                        //            ItemName = updateJobDocumentField.ActualValue
                        //        });
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        else if (item.Field.FieldName == "BUSINESS NAME")
                        {
                            string specialPlaceName = job != null ? job.SpecialPlace : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = specialPlaceName,
                                    ActualValue = specialPlaceName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = specialPlaceName;
                                updateJobDocumentField.ActualValue = specialPlaceName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Meeting Location")
                        {
                            string meetingLocation = "LOBBY";
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = meetingLocation,
                                    ActualValue = meetingLocation
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = meetingLocation;
                                updateJobDocumentField.ActualValue = meetingLocation;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Floors")
                        {
                            floorWorkingOn = job != null ? job.FloorNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = floorWorkingOn,
                                    ActualValue = floorWorkingOn,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = floorWorkingOn;
                                updateJobDocumentField.ActualValue = floorWorkingOn;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "F.D. EXPEDITOR LIC NO")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = LicenceNumber,
                                    ActualValue = LicenceNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = LicenceNumber;
                                updateJobDocumentField.ActualValue = LicenceNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Request Phone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = phone,
                                    ActualValue = phone,
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = phone;
                                updateJobDocumentField.ActualValue = phone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Request Fax")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fax,
                                    ActualValue = fax

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = fax;
                                updateJobDocumentField.ActualValue = fax;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Request MobilePhone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = cell,
                                    ActualValue = cell
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = cell;
                                updateJobDocumentField.ActualValue = cell;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Request EMail")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = email,
                                    ActualValue = email
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = email;
                                updateJobDocumentField.ActualValue = email;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Request Company")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompany,
                                    ActualValue = applicantCompany
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompany;
                                updateJobDocumentField.ActualValue = applicantCompany;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Request Address")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = compAddress + " " + businessCity + " " + businessState + " " + businessZip,
                                    ActualValue = compAddress + " " + businessCity + " " + businessState + " " + businessZip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = compAddress + " " + businessCity + " " + businessState + " " + businessZip;
                                updateJobDocumentField.ActualValue = compAddress + " " + businessCity + " " + businessState + " " + businessZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Phone")
                        {
                            string telephone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;
                            if (telephone == null || telephone == "")
                            {
                                telephone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.MobilePhone : string.Empty;
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = telephone,
                                    ActualValue = telephone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = telephone;
                                updateJobDocumentField.ActualValue = telephone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner EMail")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty,
                                    ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty;
                                updateJobDocumentField.ActualValue = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner CompanyAddress")
                        {
                            string companyName = job.RfpAddress.OwnerContact.Company != null ? job.RfpAddress.OwnerContact.Company.Name : string.Empty;
                            Address addressCompany = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.Company != null
                                && job.RfpAddress.OwnerContact.Company.Addresses != null ? job.RfpAddress.OwnerContact.Company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;
                            //Company company = job != null && job.RfpAddress != null && job.RfpAddress.Company != null ? job.RfpAddress.Company : null;
                            //Address companyAddress = job != null && job.RfpAddress != null && job.RfpAddress.Company.Addresses.FirstOrDefault() != null ? job.RfpAddress.Company.Addresses.FirstOrDefault(x => x.IsMainAddress == true) : null;

                            string address = addressCompany != null ? companyName + " " + addressCompany.Address1 + " " + addressCompany.Address2 + " " + addressCompany.City + " " + (addressCompany.State != null ? addressCompany.State.Acronym : string.Empty) + " " + addressCompany.ZipCode : string.Empty;
                            if (updateJobDocumentField == null)
                            {

                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = address,
                                    ActualValue = address

                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = address;
                                updateJobDocumentField.ActualValue = address;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "PW1")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = chkFirst,
                                    ActualValue = chkFirst
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = chkFirst;
                                updateJobDocumentField.ActualValue = chkFirst;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "B45")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = chkSecond,
                                    ActualValue = chkSecond
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = chkSecond;
                                updateJobDocumentField.ActualValue = chkSecond;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "File")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = chkThird,
                                    ActualValue = chkThird
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = chkThird;
                                updateJobDocumentField.ActualValue = chkThird;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "txtJob_Description")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = workDescription,
                                    ActualValue = workDescription
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = workDescription;
                                updateJobDocumentField.ActualValue = workDescription;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();
                    }
                    else
                    {

                        if (item.Field.FieldName == "Application Type")
                        {
                            int applicationTypeId = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.FirstOrDefault(x => x.Id == applicationTypeId);

                            string applicationNumber = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                            jobDocument.IdJobApplication = applicationTypeId;

                            if (jobDocType.ToLower() == ("DOB").ToLower())
                            {

                                if (jobDocType.ToLower() == ("DOB").ToLower())
                                    refNumber = applicationNumber;
                                //floorWorkingOn = jobApplication != null ? jobApplication.FloorWorking : string.Empty;
                                //workDescription = jobApplication!=null ? string.Join(", ", jobApplication.WorkPermitTypes.Select(x => x.WorkDescription)):string.Empty;
                                workDescription = jobApplication != null ? string.Join(", ", jobApplication.WorkPermitTypes.Where(x => !string.IsNullOrEmpty(x.WorkDescription)).Select(x => x.WorkDescription)) : string.Empty;

                            }

                            if (updateJobDocumentField == null)
                            {



                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = (jobDocumentType != null) ? jobDocumentType.Type : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = (jobDocumentType != null) ? jobDocumentType.Type : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Type")
                        {
                            int typeId = Convert.ToInt32(frontendFields.Value);
                            jobDocumentType = rpoContext.JobDocumentTypes.Where(x => x.Id == typeId).FirstOrDefault();
                            jobDocType = (jobDocumentType != null) ? jobDocumentType.Type : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(jobDocType) ? "Type: " + jobDocType : string.Empty);
                            if (jobDocType.ToLower() == ("DOB").ToLower())
                            {
                                chkFirst = "Yes";
                                chkSecond = "Yes";
                                chkThird = "Yes";
                            }
                            else if (jobDocType.ToLower() == ("Letter of Defect").ToLower())
                            {
                                chkSecond = "Yes";
                                chkThird = "Yes";
                            }
                            else if (jobDocType.ToLower() == ("Violation").ToLower())
                            {
                                chkSecond = "Yes";
                                chkThird = "Yes";
                            }
                            if (updateJobDocumentField == null)
                            {

                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = jobDocType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = jobDocType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "Applicant")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.Where(x => x.Id == applicantId).FirstOrDefault();

                            string applicant = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            applicant = applicant != null ? applicant : string.Empty;
                            Address compnayAddress = Common.GetContactAddressForJobDocument(jobContact);
                            applicantCompany = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;

                            phone = Common.GetContactPhoneNumberForJobDocument(jobContact);
                            email = jobContact != null && jobContact.Contact != null ? jobContact.Contact.Email : string.Empty;
                            email = email != null ? email : string.Empty;
                            cell = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MobilePhone : string.Empty;

                            compAddress = compnayAddress != null ? compnayAddress.Address1 + " " + compnayAddress.Address2 : string.Empty;
                            businessFax = string.Empty;
                            businessCity = compnayAddress != null ? compnayAddress.City : string.Empty;
                            businessState = compnayAddress != null && compnayAddress.State != null ? compnayAddress.State.Acronym : string.Empty;
                            businessZip = compnayAddress != null ? compnayAddress.ZipCode : string.Empty;

                            ContactLicense contactLicNumber = jobContact != null ? jobContact.Contact.ContactLicenses.FirstOrDefault() : null;
                            LicenceNumber = contactLicNumber != null ? contactLicNumber.Number : string.Empty;


                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicant) && !string.IsNullOrEmpty(applicant) ? " | " : string.Empty) + (!string.IsNullOrEmpty(applicant) ? "Applicant: " + applicant : string.Empty);
                            if (updateJobDocumentField == null)
                            {

                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = Convert.ToString(applicantId),
                                    ActualValue = applicant
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = Convert.ToString(applicantId);
                                updateJobDocumentField.ActualValue = applicant;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "REFERENCE DOCUMENT No:")
                        {


                            jobDocType = (jobDocumentType != null) ? jobDocumentType.Type : string.Empty;
                            if (jobDocType.ToLower() == ("Violation").ToLower())
                            {
                                refNumber = frontendFields.Value;

                                documentDescription = documentDescription + " | Violation #: " + refNumber;

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "Letter of Defect #")
                        {
                            jobDocType = (jobDocumentType != null) ? jobDocumentType.Type : string.Empty;
                            if (jobDocType.ToLower() == ("Letter of Defect").ToLower())
                            {
                                refNumber = frontendFields.Value;

                                documentDescription = documentDescription + " | Letter of Defect #: " + refNumber;

                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "Optional Description")
                        {
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(frontendFields.Value) ? " | " : string.Empty) + (!string.IsNullOrEmpty(frontendFields.Value) ? "Optional Description: " + frontendFields.Value : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }
                    }
                }
                List<string> newpdfString = pdfFields;
                List<int> newDocumentFieldId = DocumentFieldsIds;
                jobDocument.DocumentDescription = documentDescription;
                jobDocument.JobDocumentFor = jobDocumentFor;
                rpoContext.SaveChanges();
                GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
            }
        }
        public static void GenerateManufacturersStatement(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();
                string applicationType = string.Empty;


                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        DateTime date = DateTime.Today;
                        if (item.Field.FieldName == "MonthAndDay")
                        {
                            string format = "MMM d";
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = date.ToString(format),
                                    ActualValue = date.ToString(format)
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = date.ToString(format);
                                updateJobDocumentField.ActualValue = date.ToString(format);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Year")
                        {
                            string format = "yy";
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = date.ToString(format),
                                    ActualValue = date.ToString(format)
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = date.ToString(format);
                                updateJobDocumentField.ActualValue = date.ToString(format);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ApplicationType")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicationType,
                                    ActualValue = applicationType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicationType;
                                updateJobDocumentField.ActualValue = applicationType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Block")
                        {
                            string block = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = block,
                                    ActualValue = block
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = block;
                                updateJobDocumentField.ActualValue = block;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            string lot = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lot,
                                    ActualValue = lot
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = lot;
                                updateJobDocumentField.ActualValue = lot;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "HouseNo")
                        {
                            string houseNo = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = houseNo,
                                    ActualValue = houseNo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = houseNo;
                                updateJobDocumentField.ActualValue = houseNo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street")
                        {
                            string street = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = street,
                                    ActualValue = street
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = street;
                                updateJobDocumentField.ActualValue = street;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Distance")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Borough")
                        {
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Title")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "NameCorp")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Company")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Typesofmasonryunits1")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "NameConstructorOrOwner")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Typeofmasonryunits2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ArchitectName")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "EngineerName")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Typeofmasonryunits3")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Typesofmasonryunits4")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "A.S.T.M")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Name_and_Title")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "AppNo")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.Include("JobApplicationType").FirstOrDefault(x => x.Id == applicantId);
                            string applicationNumber = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;

                            applicationType = jobApplication != null && jobApplication.JobApplicationType != null ? jobApplication.JobApplicationType.Description : string.Empty;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        //else if (item.Field.FieldName == "Applicant Name")
                        //{
                        //    int applicantId = Convert.ToInt32(frontendFields.Value);
                        //    JobContact jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == applicantId);

                        //    applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;

                        //    Address contactAddress = Common.GetContactAddressForJobDocument(jobContact);
                        //    address = contactAddress != null ? contactAddress.Address1 + " " + contactAddress.Address2 : string.Empty;

                        //    applicantTitle = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactTitle != null ? jobContact.Contact.ContactTitle.Name : string.Empty;

                        //    companyName = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;

                        //    documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = frontendFields.Value,

                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = frontendFields.Value;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        else if (item.Field.FieldName == "Optional Description")
                        {
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(frontendFields.Value) ? " | " : string.Empty) + (!string.IsNullOrEmpty(frontendFields.Value) ? "Optional Description: " + frontendFields.Value : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();
                    }
                }
            }

            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateJobDocument(idJobDocument);
        }

        public static void EditManufacturersStatement(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();
                string applicationType = string.Empty;


                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        DateTime date = DateTime.Today;
                        if (item.Field.FieldName == "MonthAndDay")
                        {
                            string format = "MMM d";
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = date.ToString(format),
                                    ActualValue = date.ToString(format)
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = date.ToString(format);
                                updateJobDocumentField.ActualValue = date.ToString(format);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Year")
                        {
                            string format = "yy";
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = date.ToString(format),
                                    ActualValue = date.ToString(format)
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = date.ToString(format);
                                updateJobDocumentField.ActualValue = date.ToString(format);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ApplicationType")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicationType,
                                    ActualValue = applicationType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicationType;
                                updateJobDocumentField.ActualValue = applicationType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Block")
                        {
                            string block = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = block,
                                    ActualValue = block
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = block;
                                updateJobDocumentField.ActualValue = block;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            string lot = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lot,
                                    ActualValue = lot
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = lot;
                                updateJobDocumentField.ActualValue = lot;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "HouseNo")
                        {
                            string houseNo = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = houseNo,
                                    ActualValue = houseNo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = houseNo;
                                updateJobDocumentField.ActualValue = houseNo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street")
                        {
                            string street = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = street,
                                    ActualValue = street
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = street;
                                updateJobDocumentField.ActualValue = street;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Borough")
                        {
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "AppNo")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.Include("JobApplicationType").FirstOrDefault(x => x.Id == applicantId);
                            string applicationNumber = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;

                            applicationType = jobApplication != null && jobApplication.JobApplicationType != null ? jobApplication.JobApplicationType.Description : string.Empty;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        //else if (item.Field.FieldName == "Applicant Name")
                        //{
                        //    int applicantId = Convert.ToInt32(frontendFields.Value);
                        //    JobContact jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == applicantId);

                        //    applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;

                        //    Address contactAddress = Common.GetContactAddressForJobDocument(jobContact);
                        //    address = contactAddress != null ? contactAddress.Address1 + " " + contactAddress.Address2 : string.Empty;

                        //    applicantTitle = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactTitle != null ? jobContact.Contact.ContactTitle.Name : string.Empty;

                        //    companyName = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;

                        //    documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = frontendFields.Value,

                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = frontendFields.Value;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        else if (item.Field.FieldName == "Optional Description")
                        {
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(frontendFields.Value) ? " | " : string.Empty) + (!string.IsNullOrEmpty(frontendFields.Value) ? "Optional Description: " + frontendFields.Value : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();
                    }
                }
            }
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }

        public static void GenerateSuppliersStatement(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {

            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;
            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();

                string applicationType = string.Empty;
                string address = string.Empty;
                string applicantTitle = string.Empty;
                string companyName = string.Empty;
                string applicantName = string.Empty;
                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        DateTime date = DateTime.Today;
                        if (item.Field.FieldName == "MonthDate")
                        {
                            string format = "MMM d";
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = date.ToString(format),
                                    ActualValue = date.ToString(format)
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = date.ToString(format);
                                updateJobDocumentField.ActualValue = date.ToString(format);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Year")
                        {
                            string format = "yy";
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = date.ToString(format),
                                    ActualValue = date.ToString(format)
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = date.ToString(format);
                                updateJobDocumentField.ActualValue = date.ToString(format);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ApplicationType")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicationType,
                                    ActualValue = applicationType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicationType;
                                updateJobDocumentField.ActualValue = applicationType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        //else if (item.Field.FieldName == "Application No")
                        //{
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = string.Empty,
                        //            ActualValue = string.Empty
                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = string.Empty;
                        //        updateJobDocumentField.ActualValue = string.Empty;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        else if (item.Field.FieldName == "Block")
                        {
                            string block = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = block,
                                    ActualValue = block
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = block;
                                updateJobDocumentField.ActualValue = block;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            string lot = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lot,
                                    ActualValue = lot
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = lot;
                                updateJobDocumentField.ActualValue = lot;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Location")
                        {
                            string houseNo = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                            string street = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                            string distance = string.Empty;
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = houseNo.PadRight(20) + " " + street.PadRight(45) + " " + borough,
                                    ActualValue = houseNo.PadRight(20) + " " + street.PadRight(45) + " " + borough
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = houseNo.PadRight(20) + " " + street.PadRight(45) + " " + borough;
                                updateJobDocumentField.ActualValue = houseNo.PadRight(20) + " " + street.PadRight(45) + " " + borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        //if (item.Field.FieldName == "Applicant Name")
                        //{
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = string.Empty,
                        //            ActualValue = string.Empty
                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = string.Empty;
                        //        updateJobDocumentField.ActualValue = string.Empty;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        else if (item.Field.FieldName == "Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Applicant Title")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Corporation")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Name of company")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Type of masonry units1")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Contractor")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Type of masonry units2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Name of Architect")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Name of Engineer")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Type of masonry units3")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Standard Number and Year")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Name and title")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();
                    }
                    else
                    {

                        //if (item.Field.FieldName == "Applicant Name")
                        //{
                        //    int applicantId = Convert.ToInt32(frontendFields.Value);
                        //    JobContact jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == applicantId);

                        //    applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;

                        //    Address contactAddress = Common.GetContactAddressForJobDocument(jobContact);
                        //    address = contactAddress != null ? contactAddress.Address1 + " " + contactAddress.Address2 : string.Empty;

                        //    applicantTitle = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactTitle != null ? jobContact.Contact.ContactTitle.Name : string.Empty;

                        //    companyName = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;
                        //    documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = frontendFields.Value

                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = frontendFields.Value;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        if (item.Field.FieldName == "Application No")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.Include("JobApplicationType").FirstOrDefault(x => x.Id == applicantId);
                            string applicationNumber = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;

                            applicationType = jobApplication != null && jobApplication.JobApplicationType != null ? jobApplication.JobApplicationType.Description : string.Empty;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Optional Description")
                        {
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(frontendFields.Value) ? " | " : string.Empty) + (!string.IsNullOrEmpty(frontendFields.Value) ? "Optional Description: " + frontendFields.Value : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                }
            }
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateJobDocument(idJobDocument);
        }

        public static void EditSuppliersStatement(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {

            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;
            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();

                string applicationType = string.Empty;
                string address = string.Empty;
                string applicantTitle = string.Empty;
                string companyName = string.Empty;
                string applicantName = string.Empty;
                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        DateTime date = DateTime.Today;
                        if (item.Field.FieldName == "MonthDate")
                        {
                            string format = "MMM d";
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = date.ToString(format),
                                    ActualValue = date.ToString(format)
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = date.ToString(format);
                                updateJobDocumentField.ActualValue = date.ToString(format);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Year")
                        {
                            string format = "yy";
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = date.ToString(format),
                                    ActualValue = date.ToString(format)
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = date.ToString(format);
                                updateJobDocumentField.ActualValue = date.ToString(format);
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ApplicationType")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicationType,
                                    ActualValue = applicationType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicationType;
                                updateJobDocumentField.ActualValue = applicationType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        //else if (item.Field.FieldName == "Application No")
                        //{
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = string.Empty,
                        //            ActualValue = string.Empty
                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = string.Empty;
                        //        updateJobDocumentField.ActualValue = string.Empty;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        else if (item.Field.FieldName == "Block")
                        {
                            string block = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = block,
                                    ActualValue = block
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = block;
                                updateJobDocumentField.ActualValue = block;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            string lot = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lot,
                                    ActualValue = lot
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = lot;
                                updateJobDocumentField.ActualValue = lot;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Location")
                        {
                            string houseNo = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                            string street = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                            string distance = string.Empty;
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = houseNo.PadRight(20) + " " + street.PadRight(45) + " " + borough,
                                    ActualValue = houseNo.PadRight(20) + " " + street.PadRight(45) + " " + borough
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = houseNo.PadRight(20) + " " + street.PadRight(45) + " " + borough;
                                updateJobDocumentField.ActualValue = houseNo.PadRight(20) + " " + street.PadRight(45) + " " + borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();
                    }
                    else
                    {

                        //if (item.Field.FieldName == "Applicant Name")
                        //{
                        //    int applicantId = Convert.ToInt32(frontendFields.Value);
                        //    JobContact jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == applicantId);

                        //    applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;

                        //    Address contactAddress = Common.GetContactAddressForJobDocument(jobContact);
                        //    address = contactAddress != null ? contactAddress.Address1 + " " + contactAddress.Address2 : string.Empty;

                        //    applicantTitle = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactTitle != null ? jobContact.Contact.ContactTitle.Name : string.Empty;

                        //    companyName = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;
                        //    documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = frontendFields.Value

                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = frontendFields.Value;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        if (item.Field.FieldName == "Application No")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.Include("JobApplicationType").FirstOrDefault(x => x.Id == applicantId);
                            string applicationNumber = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;

                            applicationType = jobApplication != null && jobApplication.JobApplicationType != null ? jobApplication.JobApplicationType.Description : string.Empty;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Optional Description")
                        {
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(frontendFields.Value) ? " | " : string.Empty) + (!string.IsNullOrEmpty(frontendFields.Value) ? "Optional Description: " + frontendFields.Value : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                }
            }
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }

        public static void GeneratePreliminaryAffidavitbyFabricatorOrErector(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {

            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();
                string companyAddress = string.Empty;
                string companyName = string.Empty;
                string applicantTitle = string.Empty;
                string contractorAddress = string.Empty;
                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        //if (item.Field.FieldName == "Name")
                        //{
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = string.Empty,
                        //            ActualValue = string.Empty
                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = string.Empty;
                        //        updateJobDocumentField.ActualValue = string.Empty;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        if (item.Field.FieldName == "Title")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantTitle,
                                    ActualValue = applicantTitle
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantTitle;
                                updateJobDocumentField.ActualValue = applicantTitle;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "NameOfCompany")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyName,
                                    ActualValue = companyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = companyName;
                                updateJobDocumentField.ActualValue = companyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Company Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyAddress,
                                    ActualValue = companyAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = companyAddress;
                                updateJobDocumentField.ActualValue = companyAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Name of Company 2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyName,
                                    ActualValue = companyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = companyName;
                                updateJobDocumentField.ActualValue = companyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        //if (item.Field.FieldName == "Job Description")
                        //{
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = string.Empty,
                        //            ActualValue = string.Empty
                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = string.Empty;
                        //        updateJobDocumentField.ActualValue = string.Empty;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        else if (item.Field.FieldName == "Job Address")
                        {
                            string jobAddress = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street + (job.RfpAddress.Borough != null ? " " + job.RfpAddress.Borough.Description : string.Empty) + " " + job.RfpAddress.ZipCode : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobAddress,
                                    ActualValue = jobAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobAddress;
                                updateJobDocumentField.ActualValue = jobAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Architect Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Engineer Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "Name")
                        {
                            if (frontendFields.Value != null && frontendFields.Value != "")
                            {
                                int applicantId = Convert.ToInt32(frontendFields.Value);

                                JobContact jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == applicantId);

                                string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;

                                applicantTitle = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactTitle != null ? jobContact.Contact.ContactTitle.Name : string.Empty;

                                companyName = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;

                                Address address = Common.GetContactAddressForJobDocument(jobContact);
                                companyAddress = address != null ? address.Address1 + " " + address.Address2 + " " + address.City + (address.State != null ? " " + address.State.Acronym : string.Empty) : string.Empty;

                                documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                                if (updateJobDocumentField == null)
                                {
                                    JobDocumentField JobDocumentField = new JobDocumentField
                                    {
                                        IdJobDocument = idJobDocument,
                                        IdDocumentField = Convert.ToInt32(item.Id),
                                        Value = frontendFields.Value,
                                        ActualValue = applicantName
                                    };
                                    rpoContext.JobDocumentFields.Add(JobDocumentField);
                                }
                                else
                                {
                                    updateJobDocumentField.Value = frontendFields.Value;
                                    updateJobDocumentField.ActualValue = applicantName;
                                    rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                    rpoContext.SaveChanges();
                                }
                            }
                            else
                            {
                                if (updateJobDocumentField == null)
                                {
                                    JobDocumentField JobDocumentField = new JobDocumentField
                                    {
                                        IdJobDocument = idJobDocument,
                                        IdDocumentField = Convert.ToInt32(item.Id),
                                        Value = string.Empty,
                                        ActualValue = string.Empty
                                    };
                                    rpoContext.JobDocumentFields.Add(JobDocumentField);
                                }
                                else
                                {
                                    updateJobDocumentField.Value = string.Empty;
                                    updateJobDocumentField.ActualValue = string.Empty;
                                    rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                    rpoContext.SaveChanges();
                                }
                            }
                        }
                        else if (item.Field.FieldName == "Contractor")
                        {
                            int contractorId = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == contractorId);

                            string contractorName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            Address address = Common.GetContactAddressForJobDocument(jobContact);
                            contractorAddress = address != null ? address.Address1 + " " + address.Address2 + " " + address.City + (address.State != null ? " " + address.State.Acronym : string.Empty) : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(contractorName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(contractorName) ? "Contractor: " + contractorName : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = contractorName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = contractorName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        //else if (item.Field.FieldName == "Job Description")
                        //{
                        //    documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(frontendFields.Value) ? " | " : string.Empty) + (!string.IsNullOrEmpty(frontendFields.Value) ? "Optional Description: " + frontendFields.Value : string.Empty);
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = frontendFields.IdDocumentField,
                        //            Value = frontendFields.Value,
                        //            ActualValue = frontendFields.Value
                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //        rpoContext.SaveChanges();
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = frontendFields.Value;
                        //        updateJobDocumentField.ActualValue = frontendFields.Value;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();
                    }
                }
            }
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateJobDocument(idJobDocument);

        }

        public static void EditPreliminaryAffidavitbyFabricatorOrErector(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {

            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();
                string companyAddress = string.Empty;
                string companyName = string.Empty;
                string applicantTitle = string.Empty;
                string contractorAddress = string.Empty;
                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        //if (item.Field.FieldName == "Name")
                        //{
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = string.Empty,
                        //            ActualValue = string.Empty
                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = string.Empty;
                        //        updateJobDocumentField.ActualValue = string.Empty;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        if (item.Field.FieldName == "Title")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantTitle,
                                    ActualValue = applicantTitle
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantTitle;
                                updateJobDocumentField.ActualValue = applicantTitle;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "NameOfCompany")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyName,
                                    ActualValue = companyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = companyName;
                                updateJobDocumentField.ActualValue = companyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Company Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyAddress,
                                    ActualValue = companyAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = companyAddress;
                                updateJobDocumentField.ActualValue = companyAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Name of Company 2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyName,
                                    ActualValue = companyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = companyName;
                                updateJobDocumentField.ActualValue = companyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        //if (item.Field.FieldName == "Job Description")
                        //{
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = string.Empty,
                        //            ActualValue = string.Empty
                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = string.Empty;
                        //        updateJobDocumentField.ActualValue = string.Empty;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        else if (item.Field.FieldName == "Job Address")
                        {
                            string jobAddress = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street + (job.RfpAddress.Borough != null ? " " + job.RfpAddress.Borough.Description : string.Empty) + " " + job.RfpAddress.ZipCode : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobAddress,
                                    ActualValue = jobAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobAddress;
                                updateJobDocumentField.ActualValue = jobAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }


                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "Name")
                        {
                            if (frontendFields.Value != null && frontendFields.Value != "")
                            {
                                int applicantId = Convert.ToInt32(frontendFields.Value);

                                JobContact jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == applicantId);

                                string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;

                                applicantTitle = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactTitle != null ? jobContact.Contact.ContactTitle.Name : string.Empty;

                                companyName = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;

                                Address address = Common.GetContactAddressForJobDocument(jobContact);
                                companyAddress = address != null ? address.Address1 + " " + address.Address2 + " " + address.City + (address.State != null ? " " + address.State.Acronym : string.Empty) : string.Empty;

                                documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                                if (updateJobDocumentField == null)
                                {
                                    JobDocumentField JobDocumentField = new JobDocumentField
                                    {
                                        IdJobDocument = idJobDocument,
                                        IdDocumentField = Convert.ToInt32(item.Id),
                                        Value = frontendFields.Value,
                                        ActualValue = applicantName
                                    };
                                    rpoContext.JobDocumentFields.Add(JobDocumentField);
                                }
                                else
                                {
                                    string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                    pdfFields.Add(pdffield);
                                    updateJobDocumentField.Value = frontendFields.Value;
                                    updateJobDocumentField.ActualValue = applicantName;
                                    rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                    FieldsValue.Add(new IdItemName
                                    {
                                        Id = pdffield,
                                        ItemName = updateJobDocumentField.ActualValue
                                    });
                                    rpoContext.SaveChanges();
                                }
                            }
                            else
                            {
                                if (updateJobDocumentField == null)
                                {
                                    JobDocumentField JobDocumentField = new JobDocumentField
                                    {
                                        IdJobDocument = idJobDocument,
                                        IdDocumentField = Convert.ToInt32(item.Id),
                                        Value = string.Empty,
                                        ActualValue = string.Empty
                                    };
                                    rpoContext.JobDocumentFields.Add(JobDocumentField);
                                }
                                else
                                {
                                    string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                    pdfFields.Add(pdffield);
                                    updateJobDocumentField.Value = string.Empty;
                                    updateJobDocumentField.ActualValue = string.Empty;
                                    rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                    FieldsValue.Add(new IdItemName
                                    {
                                        Id = pdffield,
                                        ItemName = updateJobDocumentField.ActualValue
                                    });
                                    rpoContext.SaveChanges();
                                }
                            }
                        }
                        else if (item.Field.FieldName == "Contractor")
                        {
                            int contractorId = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == contractorId);

                            string contractorName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            Address address = Common.GetContactAddressForJobDocument(jobContact);
                            contractorAddress = address != null ? address.Address1 + " " + address.Address2 + " " + address.City + (address.State != null ? " " + address.State.Acronym : string.Empty) : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(contractorName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(contractorName) ? "Contractor: " + contractorName : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = contractorName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = contractorName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        //else if (item.Field.FieldName == "Job Description")
                        //{
                        //    documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(frontendFields.Value) ? " | " : string.Empty) + (!string.IsNullOrEmpty(frontendFields.Value) ? "Optional Description: " + frontendFields.Value : string.Empty);
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = frontendFields.IdDocumentField,
                        //            Value = frontendFields.Value,
                        //            ActualValue = frontendFields.Value
                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //        rpoContext.SaveChanges();
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = frontendFields.Value;
                        //        updateJobDocumentField.ActualValue = frontendFields.Value;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();
                    }
                }
            }
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);

        }

        public static void GenerateFinalCertificationbyFabricatorOrErector(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {

            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;
            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();
                string applicantTitle = string.Empty;
                string companyName = string.Empty;
                string companyAddress = string.Empty;
                string contractorAddress = string.Empty;
                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "Title")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantTitle,
                                    ActualValue = applicantTitle
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantTitle;
                                updateJobDocumentField.ActualValue = applicantTitle;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Name Of Company")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyName,
                                    ActualValue = companyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = companyName;
                                updateJobDocumentField.ActualValue = companyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OfficeAddress")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyAddress,
                                    ActualValue = companyAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = companyAddress;
                                updateJobDocumentField.ActualValue = companyAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SName Of Company")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyName,
                                    ActualValue = companyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = companyName;
                                updateJobDocumentField.ActualValue = companyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        //else if (item.Field.FieldName == "Description Of Job")
                        // {
                        //     if (updateJobDocumentField == null)
                        //     {
                        //         JobDocumentField JobDocumentField = new JobDocumentField
                        //         {
                        //             IdJobDocument = idJobDocument,
                        //             IdDocumentField = Convert.ToInt32(item.Id),
                        //             Value = string.Empty,
                        //             ActualValue = string.Empty
                        //         };
                        //         rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //     }
                        //     else
                        //     {
                        //         updateJobDocumentField.Value = string.Empty;
                        //         updateJobDocumentField.ActualValue = string.Empty;
                        //         rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //         rpoContext.SaveChanges();
                        //     }
                        // }
                        else if (item.Field.FieldName == "Job Address")
                        {
                            string jobAddress = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street + (job.RfpAddress.Borough != null ? " " + job.RfpAddress.Borough.Description : string.Empty) + " " + job.RfpAddress.ZipCode : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobAddress,
                                    ActualValue = jobAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobAddress;
                                updateJobDocumentField.ActualValue = jobAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Architect Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Engineer Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Signed")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "Name Of Officer")
                        {
                            if (frontendFields.Value != null && frontendFields.Value != "")
                            {
                                int applicantId = Convert.ToInt32(frontendFields.Value);
                                JobContact jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == applicantId);

                                string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;

                                applicantTitle = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactTitle != null ? jobContact.Contact.ContactTitle.Name : string.Empty;

                                companyName = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;

                                Address address = Common.GetContactAddressForJobDocument(jobContact);
                                companyAddress = address != null ? address.Address1 + " " + address.Address2 + " " + address.City + (address.State != null ? " " + address.State.Acronym : string.Empty) : string.Empty;

                                documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? "Officer: " + applicantName : string.Empty);

                                if (updateJobDocumentField == null)
                                {
                                    JobDocumentField JobDocumentField = new JobDocumentField
                                    {
                                        IdJobDocument = idJobDocument,
                                        IdDocumentField = Convert.ToInt32(item.Id),
                                        Value = frontendFields.Value,
                                        ActualValue = applicantName
                                    };
                                    rpoContext.JobDocumentFields.Add(JobDocumentField);
                                }
                                else
                                {
                                    updateJobDocumentField.Value = frontendFields.Value;
                                    updateJobDocumentField.ActualValue = applicantName;
                                    rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                    rpoContext.SaveChanges();
                                }
                            }
                            else
                            {
                                if (updateJobDocumentField == null)
                                {
                                    JobDocumentField JobDocumentField = new JobDocumentField
                                    {
                                        IdJobDocument = idJobDocument,
                                        IdDocumentField = Convert.ToInt32(item.Id),
                                        Value = frontendFields.Value,
                                        ActualValue = string.Empty
                                    };
                                    rpoContext.JobDocumentFields.Add(JobDocumentField);
                                }
                                else
                                {
                                    updateJobDocumentField.Value = frontendFields.Value;
                                    updateJobDocumentField.ActualValue = string.Empty;
                                    rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                    rpoContext.SaveChanges();
                                }
                            }

                        }
                        else if (item.Field.FieldName == "Contractor or Owner")
                        {
                            int contractorId = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == contractorId);
                            string contractorName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            Address address = Common.GetContactAddressForJobDocument(jobContact);
                            contractorAddress = address != null ? address.Address1 + " " + address.Address2 + " " + address.City + (address.State != null ? " " + address.State.Acronym : string.Empty) : string.Empty;

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(contractorName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(contractorName) ? "Contractor: " + contractorName : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = contractorName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = contractorName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                }
            }
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateJobDocument(idJobDocument);
        }

        public static void EditFinalCertificationbyFabricatorOrErector(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {

            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;
            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();
                string applicantTitle = string.Empty;
                string companyName = string.Empty;
                string companyAddress = string.Empty;
                string contractorAddress = string.Empty;
                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "Title")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantTitle,
                                    ActualValue = applicantTitle
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantTitle;
                                updateJobDocumentField.ActualValue = applicantTitle;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Name Of Company")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyName,
                                    ActualValue = companyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = companyName;
                                updateJobDocumentField.ActualValue = companyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OfficeAddress")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyAddress,
                                    ActualValue = companyAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = companyAddress;
                                updateJobDocumentField.ActualValue = companyAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SName Of Company")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyName,
                                    ActualValue = companyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = companyName;
                                updateJobDocumentField.ActualValue = companyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        //else if (item.Field.FieldName == "Description Of Job")
                        // {
                        //     if (updateJobDocumentField == null)
                        //     {
                        //         JobDocumentField JobDocumentField = new JobDocumentField
                        //         {
                        //             IdJobDocument = idJobDocument,
                        //             IdDocumentField = Convert.ToInt32(item.Id),
                        //             Value = string.Empty,
                        //             ActualValue = string.Empty
                        //         };
                        //         rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //     }
                        //     else
                        //     {
                        //         updateJobDocumentField.Value = string.Empty;
                        //         updateJobDocumentField.ActualValue = string.Empty;
                        //         rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //         rpoContext.SaveChanges();
                        //     }
                        // }
                        else if (item.Field.FieldName == "Job Address")
                        {
                            string jobAddress = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber + " " + job.RfpAddress.Street + (job.RfpAddress.Borough != null ? " " + job.RfpAddress.Borough.Description : string.Empty) + " " + job.RfpAddress.ZipCode : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobAddress,
                                    ActualValue = jobAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobAddress;
                                updateJobDocumentField.ActualValue = jobAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "Name Of Officer")
                        {
                            if (frontendFields.Value != null && frontendFields.Value != "")
                            {
                                int applicantId = Convert.ToInt32(frontendFields.Value);
                                JobContact jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == applicantId);

                                string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;

                                applicantTitle = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactTitle != null ? jobContact.Contact.ContactTitle.Name : string.Empty;

                                companyName = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;

                                Address address = Common.GetContactAddressForJobDocument(jobContact);
                                companyAddress = address != null ? address.Address1 + " " + address.Address2 + " " + address.City + (address.State != null ? " " + address.State.Acronym : string.Empty) : string.Empty;

                                documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? "Officer: " + applicantName : string.Empty);

                                if (updateJobDocumentField == null)
                                {
                                    JobDocumentField JobDocumentField = new JobDocumentField
                                    {
                                        IdJobDocument = idJobDocument,
                                        IdDocumentField = Convert.ToInt32(item.Id),
                                        Value = frontendFields.Value,
                                        ActualValue = applicantName
                                    };
                                    rpoContext.JobDocumentFields.Add(JobDocumentField);
                                }
                                else
                                {
                                    string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                    pdfFields.Add(pdffield);
                                    updateJobDocumentField.Value = frontendFields.Value;
                                    updateJobDocumentField.ActualValue = applicantName;
                                    rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                    FieldsValue.Add(new IdItemName
                                    {
                                        Id = pdffield,
                                        ItemName = updateJobDocumentField.ActualValue
                                    });
                                    rpoContext.SaveChanges();
                                }
                            }
                            else
                            {
                                if (updateJobDocumentField == null)
                                {
                                    JobDocumentField JobDocumentField = new JobDocumentField
                                    {
                                        IdJobDocument = idJobDocument,
                                        IdDocumentField = Convert.ToInt32(item.Id),
                                        Value = frontendFields.Value,
                                        ActualValue = string.Empty
                                    };
                                    rpoContext.JobDocumentFields.Add(JobDocumentField);
                                }
                                else
                                {
                                    string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                    pdfFields.Add(pdffield);
                                    updateJobDocumentField.Value = frontendFields.Value;
                                    updateJobDocumentField.ActualValue = string.Empty;
                                    rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                    FieldsValue.Add(new IdItemName
                                    {
                                        Id = pdffield,
                                        ItemName = updateJobDocumentField.ActualValue
                                    });
                                    rpoContext.SaveChanges();
                                }
                            }

                        }
                        else if (item.Field.FieldName == "Contractor or Owner")
                        {
                            int contractorId = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == contractorId);
                            string contractorName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            Address address = Common.GetContactAddressForJobDocument(jobContact);
                            contractorAddress = address != null ? address.Address1 + " " + address.Address2 + " " + address.City + (address.State != null ? " " + address.State.Acronym : string.Empty) : string.Empty;

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(contractorName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(contractorName) ? "Contractor: " + contractorName : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = contractorName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = contractorName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                }
            }
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }

        public static void GenerateZoningdiagram(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;
            string applicationNumber = string.Empty;
            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();
                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();
                string firstName = string.Empty;
                string lastName = string.Empty;
                string middelName = string.Empty;

                string mobilePhone = string.Empty;
                string email = string.Empty;
                string licenceNumber = string.Empty;
                string companyAddress = string.Empty;
                string city = string.Empty;
                string state = string.Empty;

                string phone = string.Empty;
                string zip = string.Empty;
                string companyName = string.Empty;
                string jobId = string.Empty;


                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "Resolve Objections")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "HouseNo")
                        {
                            string houseNo = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = houseNo,
                                    ActualValue = houseNo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = houseNo;
                                updateJobDocumentField.ActualValue = houseNo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }


                        else if (item.Field.FieldName == "txtJobNumber")
                        {
                            string JobNumber = applicationNumber;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = JobNumber,
                                    ActualValue = JobNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = JobNumber;
                                updateJobDocumentField.ActualValue = JobNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Street")
                        {
                            string street = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = street,
                                    ActualValue = street
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = street;
                                updateJobDocumentField.ActualValue = street;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Boro")
                        {
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Block")
                        {
                            string block = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = block,
                                    ActualValue = block
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = block;
                                updateJobDocumentField.ActualValue = block;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            string lot = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lot,
                                    ActualValue = lot
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = lot;
                                updateJobDocumentField.ActualValue = lot;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BIN")
                        {
                            string bin = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = bin,
                                    ActualValue = bin
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = bin;
                                updateJobDocumentField.ActualValue = bin;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Date")
                        {
                            // DateTime date = DateTime.Today;
                            // string format = "MM/dd/yyyy";
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Sheet")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "1",
                                    ActualValue = "1",
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = "1";
                                updateJobDocumentField.ActualValue = "1";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "NumSheets")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "1",
                                    ActualValue = "1"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = "1";
                                updateJobDocumentField.ActualValue = "1";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Last Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lastName,
                                    ActualValue = lastName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = lastName;
                                updateJobDocumentField.ActualValue = lastName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "First Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = firstName,
                                    ActualValue = firstName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = firstName;
                                updateJobDocumentField.ActualValue = firstName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Middle Initial")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = middelName,
                                    ActualValue = middelName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = middelName;
                                updateJobDocumentField.ActualValue = middelName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Company")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyName,
                                    ActualValue = companyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = companyName;
                                updateJobDocumentField.ActualValue = companyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Phone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = phone,
                                    ActualValue = phone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = phone;
                                updateJobDocumentField.ActualValue = phone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyAddress,
                                    ActualValue = companyAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = companyAddress;
                                updateJobDocumentField.ActualValue = companyAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Fax")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "JobFileInfo")
                        {
                            string jobFileInfo = job != null ? job.JobNumber + " - ZD1-76625.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "City")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = city,
                                    ActualValue = city
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = city;
                                updateJobDocumentField.ActualValue = city;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "State")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = state,
                                    ActualValue = state
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = state;
                                updateJobDocumentField.ActualValue = state;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Zip")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = zip,
                                    ActualValue = zip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = zip;
                                updateJobDocumentField.ActualValue = zip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "MobilePhone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = mobilePhone,
                                    ActualValue = mobilePhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = mobilePhone;
                                updateJobDocumentField.ActualValue = mobilePhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "EMail")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = email,
                                    ActualValue = email
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = email;
                                updateJobDocumentField.ActualValue = email;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Licence No")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = licenceNumber,
                                    ActualValue = licenceNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = licenceNumber;
                                updateJobDocumentField.ActualValue = licenceNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Dwelling Units")
                        {
                            string dwellingUnits = job != null && job.RfpAddress != null ? Convert.ToString(job.RfpAddress.DwellingUnits) : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = dwellingUnits,
                                    ActualValue = dwellingUnits
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = dwellingUnits;
                                updateJobDocumentField.ActualValue = dwellingUnits;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Parking Area")
                        {
                            string parkingArea = string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = parkingArea,
                                    ActualValue = parkingArea
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = parkingArea;
                                updateJobDocumentField.ActualValue = parkingArea;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Parking Total")
                        {
                            string parkingTotal = string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = parkingTotal,
                                    ActualValue = parkingTotal
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = parkingTotal;
                                updateJobDocumentField.ActualValue = parkingTotal;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Parking Enclosed")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BSA Variance")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BSA Variance CalNo")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BSA Special Permit")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BSA SpecialPermit CalNo")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BSA SpecialPermit AZS")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BSA GCLW")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BSA GCLW CalNo")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BSA GCLW Section")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BSA Other")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BSA Other CalNo")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CPC SpecialPermit")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CPC ULURP")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CPC SpecialPermit AZS")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CPC Authorization")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CPC Authorization AppNo")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CPC Authorization AZS")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CPC Certification")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CPC Certification AppNo")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CPC Certification AZS")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CPC Other")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CPC Other AppNo")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int jobApplicantId = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.FirstOrDefault(x => x.Id == jobApplicantId);

                            applicationNumber = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Applicant")
                        {

                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == applicantId);

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;

                            firstName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName : string.Empty;
                            lastName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.LastName : string.Empty;
                            middelName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MiddleName : string.Empty;
                            jobId = jobContact != null && jobContact.IdJob != null ? Convert.ToString(jobContact.IdJob) : string.Empty;
                            companyName = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;
                            mobilePhone = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MobilePhone : string.Empty;
                            email = jobContact != null && jobContact.Contact != null ? jobContact.Contact.Email : string.Empty;
                            licenceNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null ? jobContact.Contact.ContactLicenses.Select(x => x.Number).FirstOrDefault() : string.Empty;
                            //phone = jobContact != null && jobContact.Contact != null ? jobContact.Contact.WorkPhone : string.Empty;

                            //Address contactAddress = jobContact != null && jobContact.Contact != null && jobContact.Contact.Addresses != null ? jobContact.Contact.Addresses.FirstOrDefault(x => x.IsMainAddress==true) : null;
                            //address = contactAddress != null ? contactAddress.Address1 + " " + contactAddress.Address2 + " " + contactAddress.City + (contactAddress.State != null ? " " + contactAddress.State.Acronym : string.Empty) : string.Empty;
                            //city = contactAddress != null ? contactAddress.City : string.Empty;

                            // Address address = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null && jobContact.Contact.Company.Addresses != null ? jobContact.Contact.Company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;

                            Address address = Common.GetContactAddressForJobDocument(jobContact);

                            companyAddress = address != null ? address.Address1 + " " + address.Address2 : string.Empty;
                            city = address != null ? address.City : string.Empty;
                            state = address != null && address.State != null ? " " + address.State.Acronym : string.Empty;
                            // phone = address != null ? address.Phone : string.Empty;
                            phone = Common.GetContactPhoneNumberForJobDocument(jobContact);
                            zip = address != null ? address.ZipCode : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicantName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicantName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                }
            }
            jobDocument.DocumentDescription = documentDescription;
            rpoContext.SaveChanges();
            GenerateJobDocument(idJobDocument);
        }
        public static void EditGenerateZoningdiagram(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();

            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;
            string applicationNumber = string.Empty;
            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();
                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();
                string firstName = string.Empty;
                string lastName = string.Empty;
                string middelName = string.Empty;

                string mobilePhone = string.Empty;
                string email = string.Empty;
                string licenceNumber = string.Empty;
                string companyAddress = string.Empty;
                string city = string.Empty;
                string state = string.Empty;

                string phone = string.Empty;
                string zip = string.Empty;
                string companyName = string.Empty;
                string jobId = string.Empty;


                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "HouseNo")
                        {
                            string houseNo = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = houseNo,
                                    ActualValue = houseNo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = houseNo;
                                updateJobDocumentField.ActualValue = houseNo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }


                        else if (item.Field.FieldName == "txtJobNumber")
                        {
                            string JobNumber = applicationNumber;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = JobNumber,
                                    ActualValue = JobNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = JobNumber;
                                updateJobDocumentField.ActualValue = JobNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Street")
                        {
                            string street = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = street,
                                    ActualValue = street
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = street;
                                updateJobDocumentField.ActualValue = street;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Boro")
                        {
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Block")
                        {
                            string block = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = block,
                                    ActualValue = block
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = block;
                                updateJobDocumentField.ActualValue = block;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            string lot = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lot,
                                    ActualValue = lot
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = lot;
                                updateJobDocumentField.ActualValue = lot;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BIN")
                        {
                            string bin = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = bin,
                                    ActualValue = bin
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = bin;
                                updateJobDocumentField.ActualValue = bin;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Sheet")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "1",
                                    ActualValue = "1",
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = "1";
                                updateJobDocumentField.ActualValue = "1";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "NumSheets")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "1",
                                    ActualValue = "1"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = "1";
                                updateJobDocumentField.ActualValue = "1";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Last Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lastName,
                                    ActualValue = lastName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = lastName;
                                updateJobDocumentField.ActualValue = lastName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "First Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = firstName,
                                    ActualValue = firstName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = firstName;
                                updateJobDocumentField.ActualValue = firstName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Middle Initial")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = middelName,
                                    ActualValue = middelName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = middelName;
                                updateJobDocumentField.ActualValue = middelName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Company")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyName,
                                    ActualValue = companyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = companyName;
                                updateJobDocumentField.ActualValue = companyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Phone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = phone,
                                    ActualValue = phone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = phone;
                                updateJobDocumentField.ActualValue = phone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyAddress,
                                    ActualValue = companyAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = companyAddress;
                                updateJobDocumentField.ActualValue = companyAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "JobFileInfo")
                        {
                            string jobFileInfo = job != null ? job.JobNumber + " - ZD1-76625.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "City")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = city,
                                    ActualValue = city
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = city;
                                updateJobDocumentField.ActualValue = city;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "State")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = state,
                                    ActualValue = state
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = state;
                                updateJobDocumentField.ActualValue = state;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Zip")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = zip,
                                    ActualValue = zip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = zip;
                                updateJobDocumentField.ActualValue = zip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "MobilePhone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = mobilePhone,
                                    ActualValue = mobilePhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = mobilePhone;
                                updateJobDocumentField.ActualValue = mobilePhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "EMail")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = email,
                                    ActualValue = email
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = email;
                                updateJobDocumentField.ActualValue = email;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Licence No")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = licenceNumber,
                                    ActualValue = licenceNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = licenceNumber;
                                updateJobDocumentField.ActualValue = licenceNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Dwelling Units")
                        {
                            string dwellingUnits = job != null && job.RfpAddress != null ? Convert.ToString(job.RfpAddress.DwellingUnits) : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = dwellingUnits,
                                    ActualValue = dwellingUnits
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = dwellingUnits;
                                updateJobDocumentField.ActualValue = dwellingUnits;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Parking Area")
                        {
                            string parkingArea = string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = parkingArea,
                                    ActualValue = parkingArea
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = parkingArea;
                                updateJobDocumentField.ActualValue = parkingArea;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Parking Total")
                        {
                            string parkingTotal = string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = parkingTotal,
                                    ActualValue = parkingTotal
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = parkingTotal;
                                updateJobDocumentField.ActualValue = parkingTotal;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int jobApplicantId = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.FirstOrDefault(x => x.Id == jobApplicantId);

                            applicationNumber = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Applicant")
                        {

                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == applicantId);

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;

                            firstName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName : string.Empty;
                            lastName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.LastName : string.Empty;
                            middelName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MiddleName : string.Empty;
                            jobId = jobContact != null && jobContact.IdJob != null ? Convert.ToString(jobContact.IdJob) : string.Empty;
                            companyName = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;
                            mobilePhone = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MobilePhone : string.Empty;
                            email = jobContact != null && jobContact.Contact != null ? jobContact.Contact.Email : string.Empty;
                            licenceNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null ? jobContact.Contact.ContactLicenses.Select(x => x.Number).FirstOrDefault() : string.Empty;
                            //phone = jobContact != null && jobContact.Contact != null ? jobContact.Contact.WorkPhone : string.Empty;

                            //Address contactAddress = jobContact != null && jobContact.Contact != null && jobContact.Contact.Addresses != null ? jobContact.Contact.Addresses.FirstOrDefault(x => x.IsMainAddress==true) : null;
                            //address = contactAddress != null ? contactAddress.Address1 + " " + contactAddress.Address2 + " " + contactAddress.City + (contactAddress.State != null ? " " + contactAddress.State.Acronym : string.Empty) : string.Empty;
                            //city = contactAddress != null ? contactAddress.City : string.Empty;

                            // Address address = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null && jobContact.Contact.Company.Addresses != null ? jobContact.Contact.Company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;

                            Address address = Common.GetContactAddressForJobDocument(jobContact);

                            companyAddress = address != null ? address.Address1 + " " + address.Address2 : string.Empty;
                            city = address != null ? address.City : string.Empty;
                            state = address != null && address.State != null ? " " + address.State.Acronym : string.Empty;
                            // phone = address != null ? address.Phone : string.Empty;
                            phone = Common.GetContactPhoneNumberForJobDocument(jobContact);
                            zip = address != null ? address.ZipCode : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicantName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField && x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicantName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                }
            }
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument.DocumentDescription = documentDescription;
            rpoContext.SaveChanges();
            GenerateEditedJobDocumentZD1(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
            // GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }
        public static void GenerateZoningResolutionDeterminationApplication(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {

            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();
                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();

                string applicantLastName = string.Empty;
                string applicantFirstName = string.Empty;
                string applicantMiddelName = string.Empty;
                string applicantCompanyName = string.Empty;
                string applicantCompanyPhone = string.Empty;
                string applicantCompanyAddress = string.Empty;
                string applicantCompanyCity = string.Empty;
                string applicantCompanyState = string.Empty;
                string applicantCompanyZip = string.Empty;
                string applicantMobile = string.Empty;
                string applicantEmail = string.Empty;
                string applicantLicenseNumber = string.Empty;
                string engineerLicenseType = string.Empty;
                string architectLicenseType = string.Empty;

                string fillingRepresentativeLastName = string.Empty;
                string fillingRepresentativeFirstName = string.Empty;
                string fillingRepresentativeMiddelName = string.Empty;
                string fillingRepresentativeCompanyName = string.Empty;
                string fillingRepresentativeCompanyPhone = string.Empty;
                string fillingRepresentativeCompanyAddress = string.Empty;
                string fillingRepresentativeCompanyCity = string.Empty;
                string fillingRepresentativeCompanyState = string.Empty;
                string fillingRepresentativeCompanyZip = string.Empty;
                string fillingRepresentativeMobile = string.Empty;
                string fillingRepresentativeEmail = string.Empty;
                string fillingRepresentativeLicenseNumber = string.Empty;
                string jobdocumenttype = string.Empty;
                string documentnumber = string.Empty;

                string applicationNumber = string.Empty;


                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "HouseNo")
                        {
                            string houseNo = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = houseNo,
                                    ActualValue = houseNo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = houseNo;
                                updateJobDocumentField.ActualValue = houseNo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }


                        else if (item.Field.FieldName == "JobFileInfo")
                        {
                            // JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - ZRD1-76626.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Street")
                        {
                            string street = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = street,
                                    ActualValue = street
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = street;
                                updateJobDocumentField.ActualValue = street;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Boro")
                        {
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Block")
                        {
                            string block = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = block,
                                    ActualValue = block
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = block;
                                updateJobDocumentField.ActualValue = block;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            string lot = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lot,
                                    ActualValue = lot
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = lot;
                                updateJobDocumentField.ActualValue = lot;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BIN")
                        {
                            string bin = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = bin,
                                    ActualValue = bin
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = bin;
                                updateJobDocumentField.ActualValue = bin;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CB")
                        {
                            string comunityBoardNumber = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = comunityBoardNumber,
                                    ActualValue = comunityBoardNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = comunityBoardNumber;
                                updateJobDocumentField.ActualValue = comunityBoardNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Last")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantLastName,
                                    ActualValue = applicantLastName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantLastName;
                                updateJobDocumentField.ActualValue = applicantLastName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "First")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantFirstName,
                                    ActualValue = applicantFirstName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantFirstName;
                                updateJobDocumentField.ActualValue = applicantFirstName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "MI")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantMiddelName,
                                    ActualValue = applicantMiddelName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantMiddelName;
                                updateJobDocumentField.ActualValue = applicantMiddelName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Company")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyName,
                                    ActualValue = applicantCompanyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyName;
                                updateJobDocumentField.ActualValue = applicantCompanyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Phone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyPhone,
                                    ActualValue = applicantCompanyPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyPhone;
                                updateJobDocumentField.ActualValue = applicantCompanyPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyAddress,
                                    ActualValue = applicantCompanyAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyAddress;
                                updateJobDocumentField.ActualValue = applicantCompanyAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Fax")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "City")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyCity,
                                    ActualValue = applicantCompanyCity
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyCity;
                                updateJobDocumentField.ActualValue = applicantCompanyCity;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "State")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyState,
                                    ActualValue = applicantCompanyState
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyState;
                                updateJobDocumentField.ActualValue = applicantCompanyState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Zip")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyZip,
                                    ActualValue = applicantCompanyZip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyZip;
                                updateJobDocumentField.ActualValue = applicantCompanyZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "MobilePhone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantMobile,
                                    ActualValue = applicantMobile
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantMobile;
                                updateJobDocumentField.ActualValue = applicantMobile;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "EMail")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantEmail,
                                    ActualValue = applicantEmail
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantEmail;
                                updateJobDocumentField.ActualValue = applicantEmail;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lic_No")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantLicenseNumber,
                                    ActualValue = applicantLicenseNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantLicenseNumber;
                                updateJobDocumentField.ActualValue = applicantLicenseNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "chkE")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = engineerLicenseType,
                                    ActualValue = engineerLicenseType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = engineerLicenseType;
                                updateJobDocumentField.ActualValue = engineerLicenseType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "chkA")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = architectLicenseType,
                                    ActualValue = architectLicenseType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = architectLicenseType;
                                updateJobDocumentField.ActualValue = architectLicenseType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PENS_ID")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "chkAttorney")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "chkFilRep")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "Yes",
                                    ActualValue = "Yes"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = "Yes";
                                updateJobDocumentField.ActualValue = "Yes";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "chkOther")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Other")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_Last")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeLastName,
                                    ActualValue = fillingRepresentativeLastName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = fillingRepresentativeLastName;
                                updateJobDocumentField.ActualValue = fillingRepresentativeLastName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_First")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeFirstName,
                                    ActualValue = fillingRepresentativeFirstName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = fillingRepresentativeFirstName;
                                updateJobDocumentField.ActualValue = fillingRepresentativeFirstName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_MI")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeMiddelName,
                                    ActualValue = fillingRepresentativeMiddelName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = fillingRepresentativeMiddelName;
                                updateJobDocumentField.ActualValue = fillingRepresentativeMiddelName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_Company")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeCompanyName,
                                    ActualValue = fillingRepresentativeCompanyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = fillingRepresentativeCompanyName;
                                updateJobDocumentField.ActualValue = fillingRepresentativeCompanyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_Phone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeCompanyPhone,
                                    ActualValue = fillingRepresentativeCompanyPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = fillingRepresentativeCompanyPhone;
                                updateJobDocumentField.ActualValue = fillingRepresentativeCompanyPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeCompanyAddress,
                                    ActualValue = fillingRepresentativeCompanyAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = fillingRepresentativeCompanyAddress;
                                updateJobDocumentField.ActualValue = fillingRepresentativeCompanyAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_Fax")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_City")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeCompanyCity,
                                    ActualValue = fillingRepresentativeCompanyCity
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = fillingRepresentativeCompanyCity;
                                updateJobDocumentField.ActualValue = fillingRepresentativeCompanyCity;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_State")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeCompanyState,
                                    ActualValue = fillingRepresentativeCompanyState
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = fillingRepresentativeCompanyState;
                                updateJobDocumentField.ActualValue = fillingRepresentativeCompanyState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_Zip")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeCompanyZip,
                                    ActualValue = fillingRepresentativeCompanyZip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = fillingRepresentativeCompanyZip;
                                updateJobDocumentField.ActualValue = fillingRepresentativeCompanyZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_MobilePhone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeMobile,
                                    ActualValue = fillingRepresentativeMobile
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = fillingRepresentativeMobile;
                                updateJobDocumentField.ActualValue = fillingRepresentativeMobile;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_EMail")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeEmail,
                                    ActualValue = fillingRepresentativeEmail
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = fillingRepresentativeEmail;
                                updateJobDocumentField.ActualValue = fillingRepresentativeEmail;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_RegNo")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeLicenseNumber,
                                    ActualValue = fillingRepresentativeLicenseNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = fillingRepresentativeLicenseNumber;
                                updateJobDocumentField.ActualValue = fillingRepresentativeLicenseNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "opgRequestFor")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "chkdBC")
                        {
                            string BoroughCommissioner = string.Empty;
                            if (jobdocumenttype == "Borough Commisioner's Office")
                            {
                                BoroughCommissioner = "Yes";
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = BoroughCommissioner,
                                    ActualValue = BoroughCommissioner
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = BoroughCommissioner;
                                updateJobDocumentField.ActualValue = BoroughCommissioner;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "chkdTA")
                        {
                            string technicalaffairs = string.Empty;
                            if (jobdocumenttype == "Technical Affairs")
                            {
                                technicalaffairs = "Yes";
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = technicalaffairs,
                                    ActualValue = technicalaffairs
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = technicalaffairs;
                                updateJobDocumentField.ActualValue = technicalaffairs;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "chkJobNo_Yes")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "Yes",
                                    ActualValue = "Yes"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = "Yes";
                                updateJobDocumentField.ActualValue = "Yes";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "chkJobNo_No")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "JobNo")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicationNumber,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicationNumber;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        //else if (item.Field.FieldName == "DocNo")
                        //{
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = string.Empty,
                        //            ActualValue = string.Empty
                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = string.Empty;
                        //        updateJobDocumentField.ActualValue = string.Empty;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}
                        else if (item.Field.FieldName == "Obj #")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Examiner")
                        {
                            string examiner = "* UNSPECIFIED*";
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = examiner,
                                    ActualValue = examiner
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = examiner;
                                updateJobDocumentField.ActualValue = examiner;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "opgPrevious")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "TechTopic")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ControlNumbers")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "opg1-3Family")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "opgHPD")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "opgFeeExempt")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Zone_Dist")
                        {
                            string zoning = job != null && job.RfpAddress != null ? job.RfpAddress.ZoneDistrict : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = zoning,
                                    ActualValue = zoning
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = zoning;
                                updateJobDocumentField.ActualValue = zoning;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "MDL")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Overlay")
                        {
                            string overlay = job != null && job.RfpAddress != null ? job.RfpAddress.Overlay : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = overlay,
                                    ActualValue = overlay
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = overlay;
                                updateJobDocumentField.ActualValue = overlay;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BB")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Sp_Dist")
                        {
                            string specialDistrict = job != null && job.RfpAddress != null ? job.RfpAddress.SpecialDistrict : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = specialDistrict,
                                    ActualValue = specialDistrict
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = specialDistrict;
                                updateJobDocumentField.ActualValue = specialDistrict;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "TPPN_Other")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ZR_Section")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Code_Section")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Rule_No")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "TPPN_Memo")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "chkBorough")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "chkDeputyBorough")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "chkCode_Zoning")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "chkChiefPlanExam")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "chkGeneralCounsel")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "chkOtherOfficial")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "OtherOfficial")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Description1")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Date")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Description2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int jobApplicantId = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.FirstOrDefault(x => x.Id == jobApplicantId);

                            applicationNumber = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Filling Representative")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            Employee employee_RPO = Common.GetEmployeeInformation(applicantId);
                            Employee employee = rpoContext.Employees.FirstOrDefault(x => x.Id == applicantId);

                            string fillingRepresentative = employee != null ? employee.FirstName + " " + employee.LastName : string.Empty;

                            fillingRepresentativeFirstName = employee != null ? employee.FirstName : string.Empty;
                            fillingRepresentativeLastName = employee != null ? employee.LastName : string.Empty;
                            //fillingRepresentativeMiddelName = employee != null ? employee.MiddleName : string.Empty;

                            fillingRepresentativeCompanyName = "RPO INC";
                            fillingRepresentativeMobile = employee != null ? employee.MobilePhone : string.Empty;
                            fillingRepresentativeEmail = employee != null ? employee.Email : string.Empty;

                            //AgentCertificate agentCertificate = rpoContext.AgentCertificates
                            //.Include("DocumentType").FirstOrDefault(x => x.IdEmployee == applicantId && x.DocumentType.Name.Equals("DOB Filing Representative"));


                            AgentCertificate agentCertificateEng = rpoContext.AgentCertificates
                           .Include("DocumentType").FirstOrDefault(x => x.IdEmployee == applicantId && x.DocumentType.Name.Equals("Professional Engineer"));

                            AgentCertificate agentCertificateArchi = rpoContext.AgentCertificates
                           .Include("DocumentType").FirstOrDefault(x => x.IdEmployee == applicantId && x.DocumentType.Name.Equals("Registered Architect"));

                            if (agentCertificateEng != null)
                            {
                                fillingRepresentativeLicenseNumber = agentCertificateEng != null ? agentCertificateEng.NumberId : string.Empty;
                            }
                            else if (agentCertificateArchi != null)
                            {
                                fillingRepresentativeLicenseNumber = agentCertificateArchi != null ? agentCertificateArchi.NumberId : string.Empty;
                            }




                            //fillingRepresentativeLicenseNumber = agentCertificate != null ? agentCertificate.NumberId : string.Empty;
                            string Name = fillingRepresentativeFirstName + " " + fillingRepresentativeLastName;
                            //fillingRepresentativeCompanyAddress = employee != null ? employee.Address1 + " " + employee.Address2 : string.Empty;
                            fillingRepresentativeCompanyAddress = employee_RPO != null ? employee_RPO.Address1 : string.Empty;
                            fillingRepresentativeCompanyCity = employee != null ? employee_RPO.City : string.Empty;
                            fillingRepresentativeCompanyState = employee != null && employee_RPO.State != null ? " " + employee_RPO.State.Acronym : string.Empty;
                            fillingRepresentativeCompanyPhone = employee != null ? employee_RPO.WorkPhone : string.Empty;
                            fillingRepresentativeCompanyZip = employee != null ? employee_RPO.ZipCode : string.Empty;


                            documentDescription = documentDescription + (!string.IsNullOrEmpty(Name) ? " | Filling Representative: " + Name : string.Empty);
                            //Contact contact = rpoContext.Contacts.FirstOrDefault(x => x.Id == applicantId);

                            //string fillingRepresentative = contact != null ? contact.FirstName + " " + contact.LastName : string.Empty;

                            //fillingRepresentativeFirstName = contact != null ? contact.FirstName : string.Empty;
                            //fillingRepresentativeLastName = contact != null ? contact.LastName : string.Empty;
                            //fillingRepresentativeMiddelName = contact != null ? contact.MiddleName : string.Empty;

                            //fillingRepresentativeCompanyName = contact != null && contact.Company != null ? contact.Company.Name : string.Empty;
                            //fillingRepresentativeMobile = contact != null ? contact.MobilePhone : string.Empty;
                            //fillingRepresentativeEmail = contact != null ? contact.Email : string.Empty;
                            //fillingRepresentativeLicenseNumber = contact != null && contact.ContactLicenses != null ? contact.ContactLicenses.Select(x => x.Number).FirstOrDefault() : string.Empty;

                            //Address address = Common.GetContactAddressForJobDocument(contact);
                            //fillingRepresentativeCompanyAddress = address != null ? address.Address1 + " " + address.Address2 : string.Empty;
                            //fillingRepresentativeCompanyCity = address != null ? address.City : string.Empty;
                            //fillingRepresentativeCompanyState = address != null && address.State != null ? " " + address.State.Acronym : string.Empty;
                            //fillingRepresentativeCompanyPhone = Common.GetContactPhoneNumberForJobDocument(contact);
                            //fillingRepresentativeCompanyZip = address != null ? address.ZipCode : string.Empty;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = fillingRepresentative
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = fillingRepresentative;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Type")
                        {

                            int certifierid = Convert.ToInt32(frontendFields.Value);
                            JobDocumentType jobDocumentType = rpoContext.JobDocumentTypes.FirstOrDefault(x => x.Id == certifierid);
                            jobdocumenttype = jobDocumentType != null ? jobDocumentType.Type : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(jobdocumenttype) ? "Type: " + jobdocumenttype : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "DocNo")
                        {
                            documentnumber = Convert.ToString(frontendFields.Value);
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentnumber) ? " | DocNo: " + documentnumber : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }


                        else if (item.Field.FieldName == "Applicant")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == applicantId);

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;

                            applicantFirstName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName : string.Empty;
                            applicantLastName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.LastName : string.Empty;
                            applicantMiddelName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MiddleName : string.Empty;

                            applicantCompanyName = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;
                            applicantMobile = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MobilePhone : string.Empty;
                            applicantEmail = jobContact != null && jobContact.Contact != null ? jobContact.Contact.Email : string.Empty;


                            string licenceTypeNumber = string.Empty;

                            var test = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                                 jobContact.Contact.ContactLicenses.Select(x => x).ToList() : null;
                            string permitTypecode = string.Empty;
                            string test1 = string.Empty;
                            if (test != null)
                            {
                                foreach (var item1 in test)
                                {

                                    permitTypecode += item1.ContactLicenseType != null ? item1.ContactLicenseType.Name + "," : string.Empty;

                                }
                            }
                            string[] permitTypecodeArr = new string[20];
                            permitTypecodeArr = permitTypecode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("Engineer"));

                            if (permitTypecodeArr.Contains("Engineer"))
                            {
                                string licenceTypeNumber1 = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            jobContact.Contact.ContactLicenses.Where(x => x.ContactLicenseType.Name == "Engineer").Select(x => x.Number).FirstOrDefault() : string.Empty;
                                engineerLicenseType = "Yes";
                                applicantLicenseNumber = licenceTypeNumber1;
                                fillingRepresentativeLicenseNumber = licenceTypeNumber1;
                            }
                            else if (permitTypecodeArr.Contains("Architect"))
                            {
                                string licenceTypeNumber1 = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            jobContact.Contact.ContactLicenses.Where(x => x.ContactLicenseType.Name == "Architect").Select(x => x.Number).FirstOrDefault() : string.Empty;
                                architectLicenseType = "Yes";
                                applicantLicenseNumber = licenceTypeNumber1;
                                fillingRepresentativeLicenseNumber = licenceTypeNumber1;
                            }


                            //string licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            //jobContact.Contact.ContactLicenses.Select(x => x.Number).FirstOrDefault() : string.Empty;
                            //if (!string.IsNullOrEmpty(licenceTypeNumber))
                            //{
                            //    ContactLicense contactLicenseType = rpoContext.ContactLicenses.Where(a => a.Number == licenceTypeNumber).FirstOrDefault();
                            //    ContactLicenseType LicenseType = rpoContext.ContactLicenseTypes.Where(b => b.Id == contactLicenseType.IdContactLicenseType).FirstOrDefault();
                            //    if (LicenseType.Name.ToLower() == ("Engineer").ToLower())
                            //    {
                            //        engineerLicenseType = "Yes";
                            //        applicantLicenseNumber = licenceTypeNumber;
                            //    }
                            //    else if (LicenseType.Name.ToLower() == ("Architect").ToLower())
                            //    {
                            //        architectLicenseType = "Yes";
                            //        applicantLicenseNumber = licenceTypeNumber;
                            //    }
                            //}
                            //else
                            //{
                            //    licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            //    jobContact.Contact.ContactLicenses.Select(x => x.ContactLicenseType.Name).FirstOrDefault() : string.Empty;

                            //    if (licenceTypeNumber.ToLower() == ("Engineer").ToLower())
                            //    {
                            //        engineerLicenseType = "Yes";
                            //    }
                            //    else if (licenceTypeNumber.ToLower() == ("Architect").ToLower())
                            //    {
                            //        architectLicenseType = "Yes";
                            //    }
                            //}
                            Address address = Common.GetContactAddressForJobDocument(jobContact);
                            applicantCompanyAddress = address != null ? address.Address1 + " " + address.Address2 : string.Empty;
                            applicantCompanyCity = address != null ? address.City : string.Empty;
                            applicantCompanyState = address != null && address.State != null ? " " + address.State.Acronym : string.Empty;
                            applicantCompanyPhone = Common.GetContactPhoneNumberForJobDocument(jobContact);
                            applicantCompanyZip = address != null ? address.ZipCode : string.Empty;

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? " | Applicant: " + applicantName : string.Empty);
                            //documentDescription = "Applicant: " + applicantName;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicantName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicantName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Short Description")
                        {
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(frontendFields.Value) ? " | " : string.Empty) + (!string.IsNullOrEmpty(frontendFields.Value) ? "Optional Description: " + frontendFields.Value : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();

                    }
                }
            }
            jobDocument.DocumentDescription = documentDescription;
            // jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateJobDocument(idJobDocument);
        }

        public static void EditZoningResolutionDeterminationApplication(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {

            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();
                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();

                string applicantLastName = string.Empty;
                string applicantFirstName = string.Empty;
                string applicantMiddelName = string.Empty;
                string applicantCompanyName = string.Empty;
                string applicantCompanyPhone = string.Empty;
                string applicantCompanyAddress = string.Empty;
                string applicantCompanyCity = string.Empty;
                string applicantCompanyState = string.Empty;
                string applicantCompanyZip = string.Empty;
                string applicantMobile = string.Empty;
                string applicantEmail = string.Empty;
                string applicantLicenseNumber = string.Empty;
                string engineerLicenseType = string.Empty;
                string architectLicenseType = string.Empty;

                string fillingRepresentativeLastName = string.Empty;
                string fillingRepresentativeFirstName = string.Empty;
                string fillingRepresentativeMiddelName = string.Empty;
                string fillingRepresentativeCompanyName = string.Empty;
                string fillingRepresentativeCompanyPhone = string.Empty;
                string fillingRepresentativeCompanyAddress = string.Empty;
                string fillingRepresentativeCompanyCity = string.Empty;
                string fillingRepresentativeCompanyState = string.Empty;
                string fillingRepresentativeCompanyZip = string.Empty;
                string fillingRepresentativeMobile = string.Empty;
                string fillingRepresentativeEmail = string.Empty;
                string fillingRepresentativeLicenseNumber = string.Empty;
                string jobdocumenttype = string.Empty;
                string documentnumber = string.Empty;

                string applicationNumber = string.Empty;


                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "HouseNo")
                        {
                            string houseNo = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = houseNo,
                                    ActualValue = houseNo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = houseNo;
                                updateJobDocumentField.ActualValue = houseNo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }


                        else if (item.Field.FieldName == "JobFileInfo")
                        {
                            // JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            string jobFileInfo = job != null ? job.JobNumber + " - ZRD1-76626.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Street")
                        {
                            string street = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = street,
                                    ActualValue = street
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = street;
                                updateJobDocumentField.ActualValue = street;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Boro")
                        {
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Block")
                        {
                            string block = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = block,
                                    ActualValue = block
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = block;
                                updateJobDocumentField.ActualValue = block;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            string lot = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lot,
                                    ActualValue = lot
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = lot;
                                updateJobDocumentField.ActualValue = lot;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BIN")
                        {
                            string bin = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = bin,
                                    ActualValue = bin
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = bin;
                                updateJobDocumentField.ActualValue = bin;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CB")
                        {
                            string comunityBoardNumber = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = comunityBoardNumber,
                                    ActualValue = comunityBoardNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = comunityBoardNumber;
                                updateJobDocumentField.ActualValue = comunityBoardNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Last")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantLastName,
                                    ActualValue = applicantLastName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantLastName;
                                updateJobDocumentField.ActualValue = applicantLastName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "First")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantFirstName,
                                    ActualValue = applicantFirstName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantFirstName;
                                updateJobDocumentField.ActualValue = applicantFirstName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "MI")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantMiddelName,
                                    ActualValue = applicantMiddelName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantMiddelName;
                                updateJobDocumentField.ActualValue = applicantMiddelName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Company")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyName,
                                    ActualValue = applicantCompanyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyName;
                                updateJobDocumentField.ActualValue = applicantCompanyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Phone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyPhone,
                                    ActualValue = applicantCompanyPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyPhone;
                                updateJobDocumentField.ActualValue = applicantCompanyPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyAddress,
                                    ActualValue = applicantCompanyAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyAddress;
                                updateJobDocumentField.ActualValue = applicantCompanyAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "City")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyCity,
                                    ActualValue = applicantCompanyCity
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyCity;
                                updateJobDocumentField.ActualValue = applicantCompanyCity;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "State")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyState,
                                    ActualValue = applicantCompanyState
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyState;
                                updateJobDocumentField.ActualValue = applicantCompanyState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Zip")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyZip,
                                    ActualValue = applicantCompanyZip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyZip;
                                updateJobDocumentField.ActualValue = applicantCompanyZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "MobilePhone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantMobile,
                                    ActualValue = applicantMobile
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantMobile;
                                updateJobDocumentField.ActualValue = applicantMobile;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "EMail")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantEmail,
                                    ActualValue = applicantEmail
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantEmail;
                                updateJobDocumentField.ActualValue = applicantEmail;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lic_No")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantLicenseNumber,
                                    ActualValue = applicantLicenseNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantLicenseNumber;
                                updateJobDocumentField.ActualValue = applicantLicenseNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "chkE")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = engineerLicenseType,
                                    ActualValue = engineerLicenseType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = engineerLicenseType;
                                updateJobDocumentField.ActualValue = engineerLicenseType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "chkA")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = architectLicenseType,
                                    ActualValue = architectLicenseType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = architectLicenseType;
                                updateJobDocumentField.ActualValue = architectLicenseType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "chkFilRep")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "Yes",
                                    ActualValue = "Yes"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = "Yes";
                                updateJobDocumentField.ActualValue = "Yes";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_Last")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeLastName,
                                    ActualValue = fillingRepresentativeLastName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = fillingRepresentativeLastName;
                                updateJobDocumentField.ActualValue = fillingRepresentativeLastName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_First")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeFirstName,
                                    ActualValue = fillingRepresentativeFirstName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = fillingRepresentativeFirstName;
                                updateJobDocumentField.ActualValue = fillingRepresentativeFirstName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_MI")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeMiddelName,
                                    ActualValue = fillingRepresentativeMiddelName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = fillingRepresentativeMiddelName;
                                updateJobDocumentField.ActualValue = fillingRepresentativeMiddelName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_Company")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeCompanyName,
                                    ActualValue = fillingRepresentativeCompanyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = fillingRepresentativeCompanyName;
                                updateJobDocumentField.ActualValue = fillingRepresentativeCompanyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_Phone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeCompanyPhone,
                                    ActualValue = fillingRepresentativeCompanyPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = fillingRepresentativeCompanyPhone;
                                updateJobDocumentField.ActualValue = fillingRepresentativeCompanyPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeCompanyAddress,
                                    ActualValue = fillingRepresentativeCompanyAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = fillingRepresentativeCompanyAddress;
                                updateJobDocumentField.ActualValue = fillingRepresentativeCompanyAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "FR_City")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeCompanyCity,
                                    ActualValue = fillingRepresentativeCompanyCity
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = fillingRepresentativeCompanyCity;
                                updateJobDocumentField.ActualValue = fillingRepresentativeCompanyCity;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_State")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeCompanyState,
                                    ActualValue = fillingRepresentativeCompanyState
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = fillingRepresentativeCompanyState;
                                updateJobDocumentField.ActualValue = fillingRepresentativeCompanyState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_Zip")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeCompanyZip,
                                    ActualValue = fillingRepresentativeCompanyZip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = fillingRepresentativeCompanyZip;
                                updateJobDocumentField.ActualValue = fillingRepresentativeCompanyZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_MobilePhone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeMobile,
                                    ActualValue = fillingRepresentativeMobile
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = fillingRepresentativeMobile;
                                updateJobDocumentField.ActualValue = fillingRepresentativeMobile;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_EMail")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeEmail,
                                    ActualValue = fillingRepresentativeEmail
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = fillingRepresentativeEmail;
                                updateJobDocumentField.ActualValue = fillingRepresentativeEmail;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FR_RegNo")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = fillingRepresentativeLicenseNumber,
                                    ActualValue = fillingRepresentativeLicenseNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = fillingRepresentativeLicenseNumber;
                                updateJobDocumentField.ActualValue = fillingRepresentativeLicenseNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "chkdBC")
                        {
                            string BoroughCommissioner = string.Empty;
                            if (jobdocumenttype == "Borough Commisioner's Office")
                            {
                                BoroughCommissioner = "Yes";
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = BoroughCommissioner,
                                    ActualValue = BoroughCommissioner
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = BoroughCommissioner;
                                updateJobDocumentField.ActualValue = BoroughCommissioner;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "chkdTA")
                        {
                            string technicalaffairs = string.Empty;
                            if (jobdocumenttype == "Technical Affairs")
                            {
                                technicalaffairs = "Yes";
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = technicalaffairs,
                                    ActualValue = technicalaffairs
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = technicalaffairs;
                                updateJobDocumentField.ActualValue = technicalaffairs;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "chkJobNo_Yes")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = "Yes",
                                    ActualValue = "Yes"
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = "Yes";
                                updateJobDocumentField.ActualValue = "Yes";
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "JobNo")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicationNumber,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicationNumber;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        //else if (item.Field.FieldName == "DocNo")
                        //{
                        //    if (updateJobDocumentField == null)
                        //    {
                        //        JobDocumentField JobDocumentField = new JobDocumentField
                        //        {
                        //            IdJobDocument = idJobDocument,
                        //            IdDocumentField = Convert.ToInt32(item.Id),
                        //            Value = string.Empty,
                        //            ActualValue = string.Empty
                        //        };
                        //        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        //    }
                        //    else
                        //    {
                        //        updateJobDocumentField.Value = string.Empty;
                        //        updateJobDocumentField.ActualValue = string.Empty;
                        //        rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                        //        rpoContext.SaveChanges();
                        //    }
                        //}

                        else if (item.Field.FieldName == "Examiner")
                        {
                            string examiner = "* UNSPECIFIED*";
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = examiner,
                                    ActualValue = examiner
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = examiner;
                                updateJobDocumentField.ActualValue = examiner;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Zone_Dist")
                        {
                            string zoning = job != null && job.RfpAddress != null ? job.RfpAddress.ZoneDistrict : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = zoning,
                                    ActualValue = zoning
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = zoning;
                                updateJobDocumentField.ActualValue = zoning;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Overlay")
                        {
                            string overlay = job != null && job.RfpAddress != null ? job.RfpAddress.Overlay : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = overlay,
                                    ActualValue = overlay
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = overlay;
                                updateJobDocumentField.ActualValue = overlay;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Sp_Dist")
                        {
                            string specialDistrict = job != null && job.RfpAddress != null ? job.RfpAddress.SpecialDistrict : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = specialDistrict,
                                    ActualValue = specialDistrict
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = specialDistrict;
                                updateJobDocumentField.ActualValue = specialDistrict;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });

                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int jobApplicantId = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.FirstOrDefault(x => x.Id == jobApplicantId);

                            applicationNumber = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Filling Representative")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            Employee employee_RPO = Common.GetEmployeeInformation(applicantId);
                            Employee employee = rpoContext.Employees.FirstOrDefault(x => x.Id == applicantId);

                            string fillingRepresentative = employee != null ? employee.FirstName + " " + employee.LastName : string.Empty;

                            fillingRepresentativeFirstName = employee != null ? employee.FirstName : string.Empty;
                            fillingRepresentativeLastName = employee != null ? employee.LastName : string.Empty;
                            //fillingRepresentativeMiddelName = employee != null ? employee.MiddleName : string.Empty;

                            fillingRepresentativeCompanyName = "RPO INC";
                            fillingRepresentativeMobile = employee != null ? employee.MobilePhone : string.Empty;
                            fillingRepresentativeEmail = employee != null ? employee.Email : string.Empty;

                            //AgentCertificate agentCertificate = rpoContext.AgentCertificates
                            //.Include("DocumentType").FirstOrDefault(x => x.IdEmployee == applicantId && x.DocumentType.Name.Equals("DOB Filing Representative"));

                            AgentCertificate agentCertificateEng = rpoContext.AgentCertificates
                            .Include("DocumentType").FirstOrDefault(x => x.IdEmployee == applicantId && x.DocumentType.Name.Equals("Professional Engineer"));


                            AgentCertificate agentCertificateArchi = rpoContext.AgentCertificates
                           .Include("DocumentType").FirstOrDefault(x => x.IdEmployee == applicantId && x.DocumentType.Name.Equals("Registered Architect"));

                            if (agentCertificateEng != null)
                            {
                                fillingRepresentativeLicenseNumber = agentCertificateEng != null ? agentCertificateEng.NumberId : string.Empty;
                            }
                            else if (agentCertificateArchi != null)
                            {
                                fillingRepresentativeLicenseNumber = agentCertificateArchi != null ? agentCertificateArchi.NumberId : string.Empty;
                            }


                            string Name = fillingRepresentativeFirstName + " " + fillingRepresentativeLastName;
                            //fillingRepresentativeCompanyAddress = employee != null ? employee.Address1 + " " + employee.Address2 : string.Empty;
                            fillingRepresentativeCompanyAddress = employee_RPO != null ? employee_RPO.Address1 : string.Empty;
                            fillingRepresentativeCompanyCity = employee != null ? employee_RPO.City : string.Empty;
                            fillingRepresentativeCompanyState = employee != null && employee_RPO.State != null ? " " + employee_RPO.State.Acronym : string.Empty;
                            fillingRepresentativeCompanyPhone = employee != null ? employee_RPO.WorkPhone : string.Empty;
                            fillingRepresentativeCompanyZip = employee != null ? employee_RPO.ZipCode : string.Empty;


                            documentDescription = documentDescription + (!string.IsNullOrEmpty(Name) ? " | Filling Representative: " + Name : string.Empty);
                            //Contact contact = rpoContext.Contacts.FirstOrDefault(x => x.Id == applicantId);

                            //string fillingRepresentative = contact != null ? contact.FirstName + " " + contact.LastName : string.Empty;

                            //fillingRepresentativeFirstName = contact != null ? contact.FirstName : string.Empty;
                            //fillingRepresentativeLastName = contact != null ? contact.LastName : string.Empty;
                            //fillingRepresentativeMiddelName = contact != null ? contact.MiddleName : string.Empty;

                            //fillingRepresentativeCompanyName = contact != null && contact.Company != null ? contact.Company.Name : string.Empty;
                            //fillingRepresentativeMobile = contact != null ? contact.MobilePhone : string.Empty;
                            //fillingRepresentativeEmail = contact != null ? contact.Email : string.Empty;
                            //fillingRepresentativeLicenseNumber = contact != null && contact.ContactLicenses != null ? contact.ContactLicenses.Select(x => x.Number).FirstOrDefault() : string.Empty;

                            //Address address = Common.GetContactAddressForJobDocument(contact);
                            //fillingRepresentativeCompanyAddress = address != null ? address.Address1 + " " + address.Address2 : string.Empty;
                            //fillingRepresentativeCompanyCity = address != null ? address.City : string.Empty;
                            //fillingRepresentativeCompanyState = address != null && address.State != null ? " " + address.State.Acronym : string.Empty;
                            //fillingRepresentativeCompanyPhone = Common.GetContactPhoneNumberForJobDocument(contact);
                            //fillingRepresentativeCompanyZip = address != null ? address.ZipCode : string.Empty;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = fillingRepresentative
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = fillingRepresentative;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Type")
                        {

                            int certifierid = Convert.ToInt32(frontendFields.Value);
                            JobDocumentType jobDocumentType = rpoContext.JobDocumentTypes.FirstOrDefault(x => x.Id == certifierid);
                            jobdocumenttype = jobDocumentType != null ? jobDocumentType.Type : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(jobdocumenttype) ? "Type: " + jobdocumenttype : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "DocNo")
                        {
                            documentnumber = Convert.ToString(frontendFields.Value);
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentnumber) ? " | DocNo: " + documentnumber : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });

                                rpoContext.SaveChanges();
                            }
                        }


                        else if (item.Field.FieldName == "Applicant")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == applicantId);

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;

                            applicantFirstName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName : string.Empty;
                            applicantLastName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.LastName : string.Empty;
                            applicantMiddelName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MiddleName : string.Empty;

                            applicantCompanyName = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;
                            applicantMobile = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MobilePhone : string.Empty;
                            applicantEmail = jobContact != null && jobContact.Contact != null ? jobContact.Contact.Email : string.Empty;


                            string licenceTypeNumber = string.Empty;

                            var test = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                                 jobContact.Contact.ContactLicenses.Select(x => x).ToList() : null;
                            string permitTypecode = string.Empty;
                            string test1 = string.Empty;
                            if (test != null)
                            {
                                foreach (var item1 in test)
                                {

                                    permitTypecode += item1.ContactLicenseType != null ? item1.ContactLicenseType.Name + "," : string.Empty;

                                }
                            }
                            string[] permitTypecodeArr = new string[20];
                            permitTypecodeArr = permitTypecode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("Engineer"));

                            if (permitTypecodeArr.Contains("Engineer"))
                            {
                                string licenceTypeNumber1 = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            jobContact.Contact.ContactLicenses.Where(x => x.ContactLicenseType.Name == "Engineer").Select(x => x.Number).FirstOrDefault() : string.Empty;
                                engineerLicenseType = "Yes";
                                applicantLicenseNumber = licenceTypeNumber1;

                            }
                            else if (permitTypecodeArr.Contains("Architect"))
                            {
                                string licenceTypeNumber1 = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            jobContact.Contact.ContactLicenses.Where(x => x.ContactLicenseType.Name == "Architect").Select(x => x.Number).FirstOrDefault() : string.Empty;
                                architectLicenseType = "Yes";
                                applicantLicenseNumber = licenceTypeNumber1;

                            }


                            //string licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            //jobContact.Contact.ContactLicenses.Select(x => x.Number).FirstOrDefault() : string.Empty;
                            //if (!string.IsNullOrEmpty(licenceTypeNumber))
                            //{
                            //    ContactLicense contactLicenseType = rpoContext.ContactLicenses.Where(a => a.Number == licenceTypeNumber).FirstOrDefault();
                            //    ContactLicenseType LicenseType = rpoContext.ContactLicenseTypes.Where(b => b.Id == contactLicenseType.IdContactLicenseType).FirstOrDefault();
                            //    if (LicenseType.Name.ToLower() == ("Engineer").ToLower())
                            //    {
                            //        engineerLicenseType = "Yes";
                            //        applicantLicenseNumber = licenceTypeNumber;
                            //    }
                            //    else if (LicenseType.Name.ToLower() == ("Architect").ToLower())
                            //    {
                            //        architectLicenseType = "Yes";
                            //        applicantLicenseNumber = licenceTypeNumber;
                            //    }
                            //}
                            //else
                            //{
                            //    licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            //    jobContact.Contact.ContactLicenses.Select(x => x.ContactLicenseType.Name).FirstOrDefault() : string.Empty;

                            //    if (licenceTypeNumber.ToLower() == ("Engineer").ToLower())
                            //    {
                            //        engineerLicenseType = "Yes";
                            //    }
                            //    else if (licenceTypeNumber.ToLower() == ("Architect").ToLower())
                            //    {
                            //        architectLicenseType = "Yes";
                            //    }
                            //}
                            Address address = Common.GetContactAddressForJobDocument(jobContact);
                            applicantCompanyAddress = address != null ? address.Address1 + " " + address.Address2 : string.Empty;
                            applicantCompanyCity = address != null ? address.City : string.Empty;
                            applicantCompanyState = address != null && address.State != null ? " " + address.State.Acronym : string.Empty;
                            applicantCompanyPhone = Common.GetContactPhoneNumberForJobDocument(jobContact);
                            applicantCompanyZip = address != null ? address.ZipCode : string.Empty;

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? " | Applicant: " + applicantName : string.Empty);
                            //documentDescription = "Applicant: " + applicantName;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicantName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField && x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicantName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Short Description")
                        {
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(frontendFields.Value) ? " | " : string.Empty) + (!string.IsNullOrEmpty(frontendFields.Value) ? "Optional Description: " + frontendFields.Value : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();

                    }
                }
            }
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument.DocumentDescription = documentDescription;
            // jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateEditedJobDocumentForZRD1(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
            //GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }

        public static void GenerateTechnicalReportEnergyProgressInspections(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {

            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            JobDocumentType jobDocumentType = new JobDocumentType();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;
            JobContact jobContact = new JobContact();

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();

                string applicantLastName = string.Empty;
                string applicantFirstName = string.Empty;
                string applicantMiddelName = string.Empty;
                string applicantCompanyName = string.Empty;
                string applicantCompanyPhone = string.Empty;
                string applicantCompanyAddress = string.Empty;
                string applicantCompanyCity = string.Empty;
                string applicantCompanyState = string.Empty;
                string applicantCompanyZip = string.Empty;
                string applicantMobile = string.Empty;
                string floorWorkingOn = string.Empty;
                string applicantLicenseNumber = string.Empty;

                string opgPOFI = string.Empty;
                string opgIPAR = string.Empty;
                string opgFUPR = string.Empty;
                string opgFALK = string.Empty;
                string opgFNAR = string.Empty;
                string opgASIV = string.Empty;
                string opgASIT = string.Empty;
                string opgLDWS = string.Empty;
                string opgVEST = string.Empty;
                string opgFRPL = string.Empty;
                string opgSHTD = string.Empty;
                string opgHVEQ = string.Empty;
                string opgHVSC = string.Empty;
                string opgHVIS = string.Empty;
                string opgDLKT = string.Empty;
                string opgEENC = string.Empty;
                string opgLIDU = string.Empty;
                string opgILPW = string.Empty;
                string opgELPW = string.Empty;
                string opgLTCT = string.Empty;
                string opgELMO = string.Empty;
                string opgMNTI = string.Empty;
                string opgPMCT = string.Empty;
                string opgSLRR = string.Empty;
                string engineerLicenseType = string.Empty;
                string architectLicenseType = string.Empty;
                string applicantName = string.Empty;
                string applicantDAName = string.Empty;
                string chkDA = string.Empty;
                string chkPIA = string.Empty;
                string chkCompletion = string.Empty;
                string chkCompletion_All = string.Empty;
                string applicantName2 = string.Empty;
                string chkWithdrawal = string.Empty;
                string chkProgressInspections = string.Empty;
                string reidentification = string.Empty;
                string chkChangeApplication = string.Empty;

                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "Reident")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = reidentification,
                                    ActualValue = reidentification
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = reidentification;
                                updateJobDocumentField.ActualValue = reidentification;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "JobFileInfo")
                        {
                            string jobFileInfo = job != null ? job.JobNumber + " - TR8-76628.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "Job")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "HouseNo")
                        {
                            string houseNo = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = houseNo,
                                    ActualValue = houseNo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = houseNo;
                                updateJobDocumentField.ActualValue = houseNo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street")
                        {
                            string street = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = street,
                                    ActualValue = street
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = street;
                                updateJobDocumentField.ActualValue = street;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Floors")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = floorWorkingOn,
                                    ActualValue = floorWorkingOn
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = floorWorkingOn;
                                updateJobDocumentField.ActualValue = floorWorkingOn;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "DA")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = chkDA,
                                    ActualValue = chkDA
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = chkDA;
                                updateJobDocumentField.ActualValue = chkDA;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PIA")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = chkPIA,
                                    ActualValue = chkPIA
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = chkPIA;
                                updateJobDocumentField.ActualValue = chkPIA;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "txtIName2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantName2,
                                    ActualValue = applicantName2
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantName2;
                                updateJobDocumentField.ActualValue = applicantName2;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "txtIName")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantName,
                                    ActualValue = applicantName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantName;
                                updateJobDocumentField.ActualValue = applicantName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "First Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantFirstName,
                                    ActualValue = applicantFirstName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantFirstName;
                                updateJobDocumentField.ActualValue = applicantFirstName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Middle Initial")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantMiddelName,
                                    ActualValue = applicantMiddelName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantMiddelName;
                                updateJobDocumentField.ActualValue = applicantMiddelName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Company")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyName,
                                    ActualValue = applicantCompanyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyName;
                                updateJobDocumentField.ActualValue = applicantCompanyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Phone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyPhone,
                                    ActualValue = applicantCompanyPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyPhone;
                                updateJobDocumentField.ActualValue = applicantCompanyPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyAddress,
                                    ActualValue = applicantCompanyAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyAddress;
                                updateJobDocumentField.ActualValue = applicantCompanyAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Fax")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "City")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyCity,
                                    ActualValue = applicantCompanyCity
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyCity;
                                updateJobDocumentField.ActualValue = applicantCompanyCity;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "State")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyState,
                                    ActualValue = applicantCompanyState
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyState;
                                updateJobDocumentField.ActualValue = applicantCompanyState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Zip")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyZip,
                                    ActualValue = applicantCompanyZip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyZip;
                                updateJobDocumentField.ActualValue = applicantCompanyZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Mobile Phone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantMobile,
                                    ActualValue = applicantMobile
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantMobile;
                                updateJobDocumentField.ActualValue = applicantMobile;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PE")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = engineerLicenseType,
                                    ActualValue = engineerLicenseType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = engineerLicenseType;
                                updateJobDocumentField.ActualValue = engineerLicenseType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "RA")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = architectLicenseType,
                                    ActualValue = architectLicenseType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = architectLicenseType;
                                updateJobDocumentField.ActualValue = architectLicenseType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Licence No")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantLicenseNumber,
                                    ActualValue = applicantLicenseNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantLicenseNumber;
                                updateJobDocumentField.ActualValue = applicantLicenseNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "POFI")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgPOFI,
                                    ActualValue = opgPOFI
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgPOFI;
                                updateJobDocumentField.ActualValue = opgPOFI;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "IPAR")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgIPAR,
                                    ActualValue = opgIPAR
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgIPAR;
                                updateJobDocumentField.ActualValue = opgIPAR;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FUPR")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgFUPR,
                                    ActualValue = opgFUPR
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgFUPR;
                                updateJobDocumentField.ActualValue = opgFUPR;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FALK")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgFALK,
                                    ActualValue = opgFALK
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgFALK;
                                updateJobDocumentField.ActualValue = opgFALK;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FNAR")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgFNAR,
                                    ActualValue = opgFNAR
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgFNAR;
                                updateJobDocumentField.ActualValue = opgFNAR;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ASIV")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgASIV,
                                    ActualValue = opgASIV
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgASIV;
                                updateJobDocumentField.ActualValue = opgASIV;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ASIT")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgASIT,
                                    ActualValue = opgASIT
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgASIT;
                                updateJobDocumentField.ActualValue = opgASIT;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "LDWS")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgLDWS,
                                    ActualValue = opgLDWS
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgLDWS;
                                updateJobDocumentField.ActualValue = opgLDWS;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "VEST")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgVEST,
                                    ActualValue = opgVEST
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgVEST;
                                updateJobDocumentField.ActualValue = opgVEST;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FRPL")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgFRPL,
                                    ActualValue = opgFRPL
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgFRPL;
                                updateJobDocumentField.ActualValue = opgFRPL;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SHTD")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgSHTD,
                                    ActualValue = opgSHTD
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgSHTD;
                                updateJobDocumentField.ActualValue = opgSHTD;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "HVEQ")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgHVEQ,
                                    ActualValue = opgHVEQ
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgHVEQ;
                                updateJobDocumentField.ActualValue = opgHVEQ;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "HVSC")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgHVSC,
                                    ActualValue = opgHVSC
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgHVSC;
                                updateJobDocumentField.ActualValue = opgHVSC;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "HVIS")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgHVIS,
                                    ActualValue = opgHVIS
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgHVIS;
                                updateJobDocumentField.ActualValue = opgHVIS;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "DLKT")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgDLKT,
                                    ActualValue = opgDLKT
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgDLKT;
                                updateJobDocumentField.ActualValue = opgDLKT;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "EENC")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgEENC,
                                    ActualValue = opgEENC
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgEENC;
                                updateJobDocumentField.ActualValue = opgEENC;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "LIDU")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgLIDU,
                                    ActualValue = opgLIDU
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgLIDU;
                                updateJobDocumentField.ActualValue = opgLIDU;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ILPW")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgILPW,
                                    ActualValue = opgILPW
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgILPW;
                                updateJobDocumentField.ActualValue = opgILPW;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ELPW")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgELPW,
                                    ActualValue = opgELPW
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgELPW;
                                updateJobDocumentField.ActualValue = opgELPW;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "LTCT")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgLTCT,
                                    ActualValue = opgLTCT
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgLTCT;
                                updateJobDocumentField.ActualValue = opgLTCT;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ELMO")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgELMO,
                                    ActualValue = opgELMO
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgELMO;
                                updateJobDocumentField.ActualValue = opgELMO;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "MNTI")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgMNTI,
                                    ActualValue = opgMNTI
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgMNTI;
                                updateJobDocumentField.ActualValue = opgMNTI;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PMCT")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgPMCT,
                                    ActualValue = opgPMCT
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgPMCT;
                                updateJobDocumentField.ActualValue = opgPMCT;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SLRR")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgSLRR,
                                    ActualValue = opgSLRR
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = opgSLRR;
                                updateJobDocumentField.ActualValue = opgSLRR;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "DADate")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Commisioning Yes")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "chkCommisioning No")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Progress Inspections")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = chkProgressInspections,
                                    ActualValue = chkProgressInspections
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = chkProgressInspections;
                                updateJobDocumentField.ActualValue = chkProgressInspections;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Change")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = chkChangeApplication,
                                    ActualValue = chkChangeApplication
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = chkChangeApplication;
                                updateJobDocumentField.ActualValue = chkChangeApplication;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "None")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Some")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "IDate")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Completion")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = chkCompletion,
                                    ActualValue = chkCompletion
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = chkCompletion;
                                updateJobDocumentField.ActualValue = chkCompletion;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Completion All")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = chkCompletion_All,
                                    ActualValue = chkCompletion_All
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = chkCompletion_All;
                                updateJobDocumentField.ActualValue = chkCompletion_All;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Completion Except")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Withdrawal")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = chkWithdrawal,
                                    ActualValue = chkWithdrawal
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = chkWithdrawal;
                                updateJobDocumentField.ActualValue = chkWithdrawal;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "IDate2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int jobApplicantId = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.FirstOrDefault(x => x.Id == jobApplicantId);

                            string applicationNumber = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                            floorWorkingOn = jobApplication != null ? jobApplication.FloorWorking : string.Empty;

                            if (string.IsNullOrEmpty(floorWorkingOn))
                            {
                                floorWorkingOn = job != null ? job.FloorNumber : string.Empty;
                            }

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "InspectionType")
                        {

                            string ItemName = string.Empty;

                            opgPOFI = "2";
                            opgIPAR = "2";
                            opgFUPR = "2";
                            opgFALK = "2";
                            opgFNAR = "2";
                            opgASIV = "2";
                            opgASIT = "2";
                            opgLDWS = "2";
                            opgVEST = "2";
                            opgFRPL = "2";
                            opgSHTD = "2";
                            opgHVEQ = "2";
                            opgHVSC = "2";
                            opgHVIS = "2";
                            opgDLKT = "2";
                            opgEENC = "2";
                            opgLIDU = "2";
                            opgILPW = "2";
                            opgELPW = "2";
                            opgLTCT = "2";
                            opgELMO = "2";
                            opgMNTI = "2";
                            opgPMCT = "2";
                            opgSLRR = "2";
                            foreach (string inspectionType in frontendFields.Value.Split(','))
                            {

                                switch (inspectionType)
                                {
                                    case "opgPOFI": opgPOFI = "1"; break;
                                    case "opgIPAR": opgIPAR = "1"; break;
                                    case "opgFUPR": opgFUPR = "1"; break;
                                    case "opgFALK": opgFALK = "1"; break;
                                    case "opgFNAR": opgFNAR = "1"; break;
                                    case "opgASIV": opgASIV = "1"; break;
                                    case "opgASIT": opgASIT = "1"; break;
                                    case "opgLDWS": opgLDWS = "1"; break;
                                    case "opgVEST": opgVEST = "1"; break;
                                    case "opgFRPL": opgFRPL = "1"; break;
                                    case "opgSHTD": opgSHTD = "1"; break;
                                    case "opgHVEQ": opgHVEQ = "1"; break;
                                    case "opgHVSC": opgHVSC = "1"; break;
                                    case "opgHVIS": opgHVIS = "1"; break;
                                    case "opgDLKT": opgDLKT = "1"; break;
                                    case "opgEENC": opgEENC = "1"; break;
                                    case "opgLIDU": opgLIDU = "1"; break;
                                    case "opgILPW": opgILPW = "1"; break;
                                    case "opgELPW": opgELPW = "1"; break;
                                    case "opgLTCT": opgLTCT = "1"; break;
                                    case "opgELMO": opgELMO = "1"; break;
                                    case "opgMNTI": opgMNTI = "1"; break;
                                    case "opgPMCT": opgPMCT = "1"; break;
                                    case "opgSLRR": opgSLRR = "1"; break;

                                    default:
                                        break;
                                }
                            }
                            foreach (string inspectionType in frontendFields.Value.Split(','))
                            {

                                switch (inspectionType)
                                {
                                    case "opgPOFI": ItemName += "Protection of exposed foundation insulation" + ", "; break;
                                    case "opgIPAR": ItemName += "Insulation placement and R values" + ", "; break;
                                    case "opgFUPR": ItemName += "Fenestration u-factor and product rating" + ", "; break;
                                    case "opgFALK": ItemName += "Fenestration air leakage" + ", "; break;
                                    case "opgFNAR": ItemName += "Fenestration areas" + ", "; break;
                                    case "opgASIV": ItemName += "Air sealing and insulation — visual" + ", "; break;
                                    case "opgASIT": ItemName += "Air sealing and insulation — testing" + ", "; break;
                                    case "opgLDWS": ItemName += "Loading deck weather seals" + ", "; break;
                                    case "opgVEST": ItemName += "Vestibules" + ", "; break;
                                    case "opgFRPL": ItemName += "Fireplaces" + ", "; break;
                                    case "opgSHTD": ItemName += "Shutoff dampers" + ", "; break;
                                    case "opgHVEQ": ItemName += "HVAC and service water heating equipment" + ", "; break;
                                    case "opgHVSC": ItemName += "HVAC and service water heating system controls" + ", "; break;
                                    case "opgHVIS": ItemName += "HVAC insulation and sealing" + ", "; break;
                                    case "opgDLKT": ItemName += "Duct leakage testing" + ", "; break;
                                    case "opgEENC": ItemName += "Electrical energy consumption" + ", "; break;
                                    case "opgLIDU": ItemName += "Lighting in dwelling units" + ", "; break;
                                    case "opgILPW": ItemName += "Interior lighting power" + ", "; break;
                                    case "opgELPW": ItemName += "Exterior lighting power" + ", "; break;
                                    case "opgLTCT": ItemName += "Lighting controls" + ", "; break;
                                    case "opgELMO": ItemName += "Electrical motors" + ", "; break;
                                    case "opgMNTI": ItemName += "Maintenance information" + ", "; break;
                                    case "opgPMCT": ItemName += "Permanent certificate" + ", "; break;
                                    case "opgSLRR": ItemName += "Solar Ready Requirements" + ", "; break;

                                    default:
                                        break;
                                }
                            }

                            if (ItemName.Length > 2)
                            {
                                ItemName = ItemName.Remove(ItemName.Length - 2);
                            }

                            documentDescription = documentDescription + " | " + "InspectionType: " + ItemName;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Applicant")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == applicantId);

                            applicantFirstName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName : string.Empty;
                            applicantLastName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.LastName : string.Empty;
                            applicantMiddelName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MiddleName : string.Empty;

                            applicantCompanyName = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;
                            applicantMobile = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MobilePhone : string.Empty;
                            Address address = Common.GetContactAddressForJobDocument(jobContact);

                            applicantCompanyAddress = address != null ? address.Address1 + " " + address.Address2 : string.Empty;
                            applicantCompanyCity = address != null ? address.City : string.Empty;
                            applicantCompanyState = address != null && address.State != null ? " " + address.State.Acronym : string.Empty;
                            applicantCompanyPhone = Common.GetContactPhoneNumberForJobDocument(jobContact);  //address != null ? address.Phone : string.Empty;
                            applicantCompanyZip = address != null ? address.ZipCode : string.Empty;

                            string applicantfullname = applicantFirstName + " " + applicantLastName;

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantfullname) ? " | Applicant: " + applicantfullname : string.Empty);

                            string licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                                   jobContact.Contact.ContactLicenses.Select(x => x.Number).FirstOrDefault() : string.Empty;
                            if (!string.IsNullOrEmpty(licenceTypeNumber))
                            {
                                ContactLicense contactLicenseType = rpoContext.ContactLicenses.Where(a => a.Number == licenceTypeNumber).FirstOrDefault();
                                ContactLicenseType LicenseType = rpoContext.ContactLicenseTypes.Where(b => b.Id == contactLicenseType.IdContactLicenseType).FirstOrDefault();
                                if (LicenseType.Name.ToLower() == ("Engineer").ToLower())
                                {
                                    engineerLicenseType = "Yes";
                                    applicantLicenseNumber = licenceTypeNumber;
                                }
                                else if (LicenseType.Name.ToLower() == ("Architect").ToLower())
                                {
                                    architectLicenseType = "Yes";
                                    applicantLicenseNumber = licenceTypeNumber;
                                }
                            }
                            else
                            {
                                licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                                jobContact.Contact.ContactLicenses.Select(x => x.ContactLicenseType.Name).FirstOrDefault() : string.Empty;
                                if (licenceTypeNumber.ToLower() == ("Engineer").ToLower())
                                {
                                    engineerLicenseType = "Yes";
                                }
                                else if (licenceTypeNumber.ToLower() == ("Architect").ToLower())
                                {
                                    architectLicenseType = "Yes";
                                }
                            }
                            if (jobDocumentType.Type.ToLower() == ("Design Applicant Initial Identification").ToLower())
                            {
                                chkDA = "Yes";
                                chkPIA = string.Empty;
                                applicantDAName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            }
                            else if (jobDocumentType.Type.ToLower() == ("Design Applicant Reidentification").ToLower())
                            {
                                chkDA = "Yes";
                                chkPIA = string.Empty;
                                reidentification = "Reidentification";
                                applicantDAName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            }
                            else if (jobDocumentType.Type.ToLower() == ("Design/Inspector Initial Identification").ToLower())
                            {
                                chkDA = "Yes"; chkPIA = "Yes";
                                chkProgressInspections = "Yes";
                                applicantDAName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                                applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            }
                            else if (jobDocumentType.Type.ToLower() == ("Inspector Initial Identification").ToLower())
                            {
                                chkDA = string.Empty; chkPIA = "Yes";
                                chkProgressInspections = "Yes";
                                applicantDAName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                                applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            }
                            else if (jobDocumentType.Type.ToLower() == ("Certification").ToLower())
                            {
                                chkPIA = "Yes";
                                chkDA = string.Empty;
                                chkCompletion = "Yes";
                                chkCompletion_All = "Yes";
                                applicantName2 = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            }
                            else if (jobDocumentType.Type.ToLower() == ("Withdrawal").ToLower())
                            {
                                chkPIA = "Yes";
                                chkDA = string.Empty;
                                chkWithdrawal = "Yes";
                                applicantName2 = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicantLastName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicantLastName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Type")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            jobDocumentType = rpoContext.JobDocumentTypes.FirstOrDefault(x => x.Id == applicantId);
                            documentDescription = "Type: " + jobDocumentType.Type;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Responsible for Plans")
                        {
                            string docuementType = jobDocumentType != null ? jobDocumentType.Type : string.Empty;
                            JobContact jobContact2 = new JobContact();
                            if (docuementType.ToLower() == ("Inspector Initial Identification").ToLower())
                            {
                                int applicantId = Convert.ToInt32(frontendFields.Value);
                                jobContact2 = rpoContext.JobContacts.FirstOrDefault(x => x.Id == applicantId);
                                applicantDAName = jobContact2 != null && jobContact2.Contact != null ? jobContact2.Contact.FirstName + " " + jobContact2.Contact.LastName : string.Empty;
                                applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                                chkDA = string.Empty; chkPIA = "Yes";
                                chkProgressInspections = "Yes";
                            }
                            else if (docuementType.ToLower() == ("Inspector Reidentification").ToLower())
                            {
                                int applicantId = Convert.ToInt32(frontendFields.Value);
                                jobContact2 = rpoContext.JobContacts.FirstOrDefault(x => x.Id == applicantId);
                                applicantDAName = jobContact2 != null && jobContact2.Contact != null ? jobContact2.Contact.FirstName + " " + jobContact2.Contact.LastName : string.Empty;
                                applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                                chkDA = string.Empty; chkPIA = "Yes";
                                chkProgressInspections = "Yes";
                                chkChangeApplication = "Yes";
                            }

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantDAName) ? " | Responsible for Plans: " + applicantDAName : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicantDAName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicantDAName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Optional Description")
                        {
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(frontendFields.Value) ? " | " : string.Empty) + (!string.IsNullOrEmpty(frontendFields.Value) ? "Optional Description: " + frontendFields.Value : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                }
            }
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateJobDocument(idJobDocument);
        }
        public static void EditTechnicalReportEnergyProgressInspections(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {

            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            JobDocumentType jobDocumentType = new JobDocumentType();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;
            JobContact jobContact = new JobContact();
            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();

                string applicantLastName = string.Empty;
                string applicantFirstName = string.Empty;
                string applicantMiddelName = string.Empty;
                string applicantCompanyName = string.Empty;
                string applicantCompanyPhone = string.Empty;
                string applicantCompanyAddress = string.Empty;
                string applicantCompanyCity = string.Empty;
                string applicantCompanyState = string.Empty;
                string applicantCompanyZip = string.Empty;
                string applicantMobile = string.Empty;
                string floorWorkingOn = string.Empty;
                string applicantLicenseNumber = string.Empty;

                string opgPOFI = string.Empty;
                string opgIPAR = string.Empty;
                string opgFUPR = string.Empty;
                string opgFALK = string.Empty;
                string opgFNAR = string.Empty;
                string opgASIV = string.Empty;
                string opgASIT = string.Empty;
                string opgLDWS = string.Empty;
                string opgVEST = string.Empty;
                string opgFRPL = string.Empty;
                string opgSHTD = string.Empty;
                string opgHVEQ = string.Empty;
                string opgHVSC = string.Empty;
                string opgHVIS = string.Empty;
                string opgDLKT = string.Empty;
                string opgEENC = string.Empty;
                string opgLIDU = string.Empty;
                string opgILPW = string.Empty;
                string opgELPW = string.Empty;
                string opgLTCT = string.Empty;
                string opgELMO = string.Empty;
                string opgMNTI = string.Empty;
                string opgPMCT = string.Empty;
                string opgSLRR = string.Empty;
                string engineerLicenseType = string.Empty;
                string architectLicenseType = string.Empty;
                string applicantName = string.Empty;
                string applicantDAName = string.Empty;
                string chkDA = string.Empty;
                string chkPIA = string.Empty;
                string chkCompletion = string.Empty;
                string chkCompletion_All = string.Empty;
                string applicantName2 = string.Empty;
                string chkWithdrawal = string.Empty;
                string chkProgressInspections = string.Empty;
                string reidentification = string.Empty;
                string chkChangeApplication = string.Empty;

                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "Reident")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = reidentification,
                                    ActualValue = reidentification
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = reidentification;
                                updateJobDocumentField.ActualValue = reidentification;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "JobFileInfo")
                        {
                            string jobFileInfo = job != null ? job.JobNumber + " - TR8-76628.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "HouseNo")
                        {
                            string houseNo = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = houseNo,
                                    ActualValue = houseNo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = houseNo;
                                updateJobDocumentField.ActualValue = houseNo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street")
                        {
                            string street = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = street,
                                    ActualValue = street
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = street;
                                updateJobDocumentField.ActualValue = street;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Floors")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = floorWorkingOn,
                                    ActualValue = floorWorkingOn
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = floorWorkingOn;
                                updateJobDocumentField.ActualValue = floorWorkingOn;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "DA")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = chkDA,
                                    ActualValue = chkDA
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = chkDA;
                                updateJobDocumentField.ActualValue = chkDA;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PIA")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = chkPIA,
                                    ActualValue = chkPIA
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = chkPIA;
                                updateJobDocumentField.ActualValue = chkPIA;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "txtIName2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantName2,
                                    ActualValue = applicantName2
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantName2;
                                updateJobDocumentField.ActualValue = applicantName2;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "txtIName")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantName,
                                    ActualValue = applicantName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantName;
                                updateJobDocumentField.ActualValue = applicantName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "First Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantFirstName,
                                    ActualValue = applicantFirstName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantFirstName;
                                updateJobDocumentField.ActualValue = applicantFirstName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Middle Initial")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantMiddelName,
                                    ActualValue = applicantMiddelName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantMiddelName;
                                updateJobDocumentField.ActualValue = applicantMiddelName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Company")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyName,
                                    ActualValue = applicantCompanyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyName;
                                updateJobDocumentField.ActualValue = applicantCompanyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Phone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyPhone,
                                    ActualValue = applicantCompanyPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyPhone;
                                updateJobDocumentField.ActualValue = applicantCompanyPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyAddress,
                                    ActualValue = applicantCompanyAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyAddress;
                                updateJobDocumentField.ActualValue = applicantCompanyAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "City")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyCity,
                                    ActualValue = applicantCompanyCity
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyCity;
                                updateJobDocumentField.ActualValue = applicantCompanyCity;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "State")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyState,
                                    ActualValue = applicantCompanyState
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyState;
                                updateJobDocumentField.ActualValue = applicantCompanyState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Zip")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyZip,
                                    ActualValue = applicantCompanyZip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyZip;
                                updateJobDocumentField.ActualValue = applicantCompanyZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Mobile Phone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantMobile,
                                    ActualValue = applicantMobile
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantMobile;
                                updateJobDocumentField.ActualValue = applicantMobile;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PE")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = engineerLicenseType,
                                    ActualValue = engineerLicenseType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = engineerLicenseType;
                                updateJobDocumentField.ActualValue = engineerLicenseType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "RA")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = architectLicenseType,
                                    ActualValue = architectLicenseType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = architectLicenseType;
                                updateJobDocumentField.ActualValue = architectLicenseType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Licence No")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantLicenseNumber,
                                    ActualValue = applicantLicenseNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantLicenseNumber;
                                updateJobDocumentField.ActualValue = applicantLicenseNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "POFI")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgPOFI,
                                    ActualValue = opgPOFI
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgPOFI;
                                updateJobDocumentField.ActualValue = opgPOFI;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "IPAR")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgIPAR,
                                    ActualValue = opgIPAR
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgIPAR;
                                updateJobDocumentField.ActualValue = opgIPAR;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FUPR")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgFUPR,
                                    ActualValue = opgFUPR
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgFUPR;
                                updateJobDocumentField.ActualValue = opgFUPR;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FALK")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgFALK,
                                    ActualValue = opgFALK
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgFALK;
                                updateJobDocumentField.ActualValue = opgFALK;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FNAR")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgFNAR,
                                    ActualValue = opgFNAR
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgFNAR;
                                updateJobDocumentField.ActualValue = opgFNAR;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ASIV")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgASIV,
                                    ActualValue = opgASIV
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgASIV;
                                updateJobDocumentField.ActualValue = opgASIV;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ASIT")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgASIT,
                                    ActualValue = opgASIT
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgASIT;
                                updateJobDocumentField.ActualValue = opgASIT;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "LDWS")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgLDWS,
                                    ActualValue = opgLDWS
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgLDWS;
                                updateJobDocumentField.ActualValue = opgLDWS;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "VEST")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgVEST,
                                    ActualValue = opgVEST
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgVEST;
                                updateJobDocumentField.ActualValue = opgVEST;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "FRPL")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgFRPL,
                                    ActualValue = opgFRPL
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgFRPL;
                                updateJobDocumentField.ActualValue = opgFRPL;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SHTD")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgSHTD,
                                    ActualValue = opgSHTD
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgSHTD;
                                updateJobDocumentField.ActualValue = opgSHTD;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "HVEQ")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgHVEQ,
                                    ActualValue = opgHVEQ
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgHVEQ;
                                updateJobDocumentField.ActualValue = opgHVEQ;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "HVSC")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgHVSC,
                                    ActualValue = opgHVSC
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgHVSC;
                                updateJobDocumentField.ActualValue = opgHVSC;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "HVIS")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgHVIS,
                                    ActualValue = opgHVIS
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgHVIS;
                                updateJobDocumentField.ActualValue = opgHVIS;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "DLKT")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgDLKT,
                                    ActualValue = opgDLKT
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgDLKT;
                                updateJobDocumentField.ActualValue = opgDLKT;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "EENC")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgEENC,
                                    ActualValue = opgEENC
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgEENC;
                                updateJobDocumentField.ActualValue = opgEENC;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "LIDU")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgLIDU,
                                    ActualValue = opgLIDU
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgLIDU;
                                updateJobDocumentField.ActualValue = opgLIDU;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ILPW")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgILPW,
                                    ActualValue = opgILPW
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgILPW;
                                updateJobDocumentField.ActualValue = opgILPW;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ELPW")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgELPW,
                                    ActualValue = opgELPW
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgELPW;
                                updateJobDocumentField.ActualValue = opgELPW;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "LTCT")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgLTCT,
                                    ActualValue = opgLTCT
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgLTCT;
                                updateJobDocumentField.ActualValue = opgLTCT;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ELMO")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgELMO,
                                    ActualValue = opgELMO
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgELMO;
                                updateJobDocumentField.ActualValue = opgELMO;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "MNTI")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgMNTI,
                                    ActualValue = opgMNTI
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgMNTI;
                                updateJobDocumentField.ActualValue = opgMNTI;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PMCT")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgPMCT,
                                    ActualValue = opgPMCT
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgPMCT;
                                updateJobDocumentField.ActualValue = opgPMCT;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SLRR")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = opgSLRR,
                                    ActualValue = opgSLRR
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = opgSLRR;
                                updateJobDocumentField.ActualValue = opgSLRR;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Progress Inspections")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = chkProgressInspections,
                                    ActualValue = chkProgressInspections
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = chkProgressInspections;
                                updateJobDocumentField.ActualValue = chkProgressInspections;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Change")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = chkChangeApplication,
                                    ActualValue = chkChangeApplication
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = chkChangeApplication;
                                updateJobDocumentField.ActualValue = chkChangeApplication;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Completion")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = chkCompletion,
                                    ActualValue = chkCompletion
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = chkCompletion;
                                updateJobDocumentField.ActualValue = chkCompletion;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Completion All")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = chkCompletion_All,
                                    ActualValue = chkCompletion_All
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = chkCompletion_All;
                                updateJobDocumentField.ActualValue = chkCompletion_All;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Withdrawal")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = chkWithdrawal,
                                    ActualValue = chkWithdrawal
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = chkWithdrawal;
                                updateJobDocumentField.ActualValue = chkWithdrawal;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int jobApplicantId = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.FirstOrDefault(x => x.Id == jobApplicantId);

                            string applicationNumber = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                            floorWorkingOn = jobApplication != null ? jobApplication.FloorWorking : string.Empty;

                            if (string.IsNullOrEmpty(floorWorkingOn))
                            {
                                floorWorkingOn = job != null ? job.FloorNumber : string.Empty;
                            }

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "InspectionType")
                        {
                            string ItemName = string.Empty;
                            opgPOFI = "2";
                            opgIPAR = "2";
                            opgFUPR = "2";
                            opgFALK = "2";
                            opgFNAR = "2";
                            opgASIV = "2";
                            opgASIT = "2";
                            opgLDWS = "2";
                            opgVEST = "2";
                            opgFRPL = "2";
                            opgSHTD = "2";
                            opgHVEQ = "2";
                            opgHVSC = "2";
                            opgHVIS = "2";
                            opgDLKT = "2";
                            opgEENC = "2";
                            opgLIDU = "2";
                            opgILPW = "2";
                            opgELPW = "2";
                            opgLTCT = "2";
                            opgELMO = "2";
                            opgMNTI = "2";
                            opgPMCT = "2";
                            opgSLRR = "2";
                            foreach (string inspectionType in frontendFields.Value.Split(','))
                            {

                                switch (inspectionType)
                                {
                                    case "opgPOFI": opgPOFI = "1"; break;
                                    case "opgIPAR": opgIPAR = "1"; break;
                                    case "opgFUPR": opgFUPR = "1"; break;
                                    case "opgFALK": opgFALK = "1"; break;
                                    case "opgFNAR": opgFNAR = "1"; break;
                                    case "opgASIV": opgASIV = "1"; break;
                                    case "opgASIT": opgASIT = "1"; break;
                                    case "opgLDWS": opgLDWS = "1"; break;
                                    case "opgVEST": opgVEST = "1"; break;
                                    case "opgFRPL": opgFRPL = "1"; break;
                                    case "opgSHTD": opgSHTD = "1"; break;
                                    case "opgHVEQ": opgHVEQ = "1"; break;
                                    case "opgHVSC": opgHVSC = "1"; break;
                                    case "opgHVIS": opgHVIS = "1"; break;
                                    case "opgDLKT": opgDLKT = "1"; break;
                                    case "opgEENC": opgEENC = "1"; break;
                                    case "opgLIDU": opgLIDU = "1"; break;
                                    case "opgILPW": opgILPW = "1"; break;
                                    case "opgELPW": opgELPW = "1"; break;
                                    case "opgLTCT": opgLTCT = "1"; break;
                                    case "opgELMO": opgELMO = "1"; break;
                                    case "opgMNTI": opgMNTI = "1"; break;
                                    case "opgPMCT": opgPMCT = "1"; break;
                                    case "opgSLRR": opgSLRR = "1"; break;

                                    default:
                                        break;
                                }
                            }

                            foreach (string inspectionType in frontendFields.Value.Split(','))
                            {

                                switch (inspectionType)
                                {
                                    case "opgPOFI": ItemName += "Protection of exposed foundation insulation" + ", "; break;
                                    case "opgIPAR": ItemName += "Insulation placement and R values" + ", "; break;
                                    case "opgFUPR": ItemName += "Fenestration u-factor and product rating" + ", "; break;
                                    case "opgFALK": ItemName += "Fenestration air leakage" + ", "; break;
                                    case "opgFNAR": ItemName += "Fenestration areas" + ", "; break;
                                    case "opgASIV": ItemName += "Air sealing and insulation — visual" + ", "; break;
                                    case "opgASIT": ItemName += "Air sealing and insulation — testing" + ", "; break;
                                    case "opgLDWS": ItemName += "Loading deck weather seals" + ", "; break;
                                    case "opgVEST": ItemName += "Vestibules" + ", "; break;
                                    case "opgFRPL": ItemName += "Fireplaces" + ", "; break;
                                    case "opgSHTD": ItemName += "Shutoff dampers" + ", "; break;
                                    case "opgHVEQ": ItemName += "HVAC and service water heating equipment" + ", "; break;
                                    case "opgHVSC": ItemName += "HVAC and service water heating system controls" + ", "; break;
                                    case "opgHVIS": ItemName += "HVAC insulation and sealing" + ", "; break;
                                    case "opgDLKT": ItemName += "Duct leakage testing" + ", "; break;
                                    case "opgEENC": ItemName += "Electrical energy consumption" + ", "; break;
                                    case "opgLIDU": ItemName += "Lighting in dwelling units" + ", "; break;
                                    case "opgILPW": ItemName += "Interior lighting power" + ", "; break;
                                    case "opgELPW": ItemName += "Exterior lighting power" + ", "; break;
                                    case "opgLTCT": ItemName += "Lighting controls" + ", "; break;
                                    case "opgELMO": ItemName += "Electrical motors" + ", "; break;
                                    case "opgMNTI": ItemName += "Maintenance information" + ", "; break;
                                    case "opgPMCT": ItemName += "Permanent certificate" + ", "; break;
                                    case "opgSLRR": ItemName += "Solar Ready Requirements" + ", "; break;

                                    default:
                                        break;
                                }
                            }

                            if (ItemName.Length > 2)
                            {
                                ItemName = ItemName.Remove(ItemName.Length - 2);
                            }

                            documentDescription = documentDescription + " | " + "InspectionType: " + ItemName;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Applicant")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == applicantId);

                            applicantFirstName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName : string.Empty;
                            applicantLastName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.LastName : string.Empty;
                            applicantMiddelName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MiddleName : string.Empty;

                            applicantCompanyName = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;
                            applicantMobile = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MobilePhone : string.Empty;
                            Address address = Common.GetContactAddressForJobDocument(jobContact);

                            applicantCompanyAddress = address != null ? address.Address1 + " " + address.Address2 : string.Empty;
                            applicantCompanyCity = address != null ? address.City : string.Empty;
                            applicantCompanyState = address != null && address.State != null ? " " + address.State.Acronym : string.Empty;
                            applicantCompanyPhone = Common.GetContactPhoneNumberForJobDocument(jobContact);  //address != null ? address.Phone : string.Empty;
                            applicantCompanyZip = address != null ? address.ZipCode : string.Empty;

                            string applicantfullname = applicantFirstName + " " + applicantLastName;

                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantfullname) ? " | Applicant: " + applicantfullname : string.Empty);

                            string licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                                   jobContact.Contact.ContactLicenses.Select(x => x.Number).FirstOrDefault() : string.Empty;
                            if (!string.IsNullOrEmpty(licenceTypeNumber))
                            {
                                ContactLicense contactLicenseType = rpoContext.ContactLicenses.Where(a => a.Number == licenceTypeNumber).FirstOrDefault();
                                ContactLicenseType LicenseType = rpoContext.ContactLicenseTypes.Where(b => b.Id == contactLicenseType.IdContactLicenseType).FirstOrDefault();
                                if (LicenseType.Name.ToLower() == ("Engineer").ToLower())
                                {
                                    engineerLicenseType = "Yes";
                                    applicantLicenseNumber = licenceTypeNumber;
                                }
                                else if (LicenseType.Name.ToLower() == ("Architect").ToLower())
                                {
                                    architectLicenseType = "Yes";
                                    applicantLicenseNumber = licenceTypeNumber;
                                }
                            }
                            else
                            {
                                licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                                jobContact.Contact.ContactLicenses.Select(x => x.ContactLicenseType.Name).FirstOrDefault() : string.Empty;
                                if (licenceTypeNumber.ToLower() == ("Engineer").ToLower())
                                {
                                    engineerLicenseType = "Yes";
                                }
                                else if (licenceTypeNumber.ToLower() == ("Architect").ToLower())
                                {
                                    architectLicenseType = "Yes";
                                }
                            }
                            if (jobDocumentType.Type.ToLower() == ("Design Applicant Initial Identification").ToLower())
                            {
                                chkDA = "Yes";
                                chkPIA = string.Empty;
                                applicantDAName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            }
                            else if (jobDocumentType.Type.ToLower() == ("Design Applicant Reidentification").ToLower())
                            {
                                chkDA = "Yes";
                                chkPIA = string.Empty;
                                reidentification = "Reidentification";
                                applicantDAName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            }
                            else if (jobDocumentType.Type.ToLower() == ("Design/Inspector Initial Identification").ToLower())
                            {
                                chkDA = "Yes"; chkPIA = "Yes";
                                chkProgressInspections = "Yes";
                                applicantDAName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                                applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            }
                            else if (jobDocumentType.Type.ToLower() == ("Inspector Initial Identification").ToLower())
                            {
                                chkDA = string.Empty; chkPIA = "Yes";
                                chkProgressInspections = "Yes";
                                applicantDAName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                                applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            }
                            else if (jobDocumentType.Type.ToLower() == ("Certification").ToLower())
                            {
                                chkPIA = "Yes";
                                chkDA = string.Empty;
                                chkCompletion = "Yes";
                                chkCompletion_All = "Yes";
                                applicantName2 = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            }
                            else if (jobDocumentType.Type.ToLower() == ("Withdrawal").ToLower())
                            {
                                chkPIA = "Yes";
                                chkDA = string.Empty;
                                chkWithdrawal = "Yes";
                                applicantName2 = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicantLastName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicantLastName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Type")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            jobDocumentType = rpoContext.JobDocumentTypes.FirstOrDefault(x => x.Id == applicantId);
                            documentDescription = "Type: " + jobDocumentType.Type;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Responsible for Plans")
                        {
                            string docuementType = jobDocumentType != null ? jobDocumentType.Type : string.Empty;
                            JobContact jobContact2 = new JobContact();
                            if (docuementType.ToLower() == ("Inspector Initial Identification").ToLower())
                            {
                                int applicantId = Convert.ToInt32(frontendFields.Value);
                                jobContact2 = rpoContext.JobContacts.FirstOrDefault(x => x.Id == applicantId);
                                applicantDAName = jobContact2 != null && jobContact2.Contact != null ? jobContact2.Contact.FirstName + " " + jobContact2.Contact.LastName : string.Empty;
                                applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                                chkDA = string.Empty; chkPIA = "Yes";
                                chkProgressInspections = "Yes";
                            }
                            else if (docuementType.ToLower() == ("Inspector Reidentification").ToLower())
                            {
                                int applicantId = Convert.ToInt32(frontendFields.Value);
                                jobContact2 = rpoContext.JobContacts.FirstOrDefault(x => x.Id == applicantId);
                                applicantDAName = jobContact2 != null && jobContact2.Contact != null ? jobContact2.Contact.FirstName + " " + jobContact2.Contact.LastName : string.Empty;
                                applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;
                                chkDA = string.Empty; chkPIA = "Yes";
                                chkProgressInspections = "Yes";
                                chkChangeApplication = "Yes";
                            }
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantDAName) ? " | Responsible for Plans: " + applicantDAName : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicantDAName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicantDAName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Optional Description")
                        {
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(frontendFields.Value) ? " | " : string.Empty) + (!string.IsNullOrEmpty(frontendFields.Value) ? "Optional Description: " + frontendFields.Value : string.Empty);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                }
            }
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }

        public static void GenerateTechnicalReportLuminousExitMarkings(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {

            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;
            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();

                string applicantLastName = string.Empty;
                string applicantFirstName = string.Empty;
                string applicantMiddelName = string.Empty;
                string applicantCompanyName = string.Empty;
                string applicantCompanyPhone = string.Empty;
                string applicantCompanyAddress = string.Empty;
                string applicantCompanyCity = string.Empty;
                string applicantCompanyState = string.Empty;
                string applicantCompanyZip = string.Empty;
                string applicantMobile = string.Empty;
                string applicantEmail = string.Empty;
                string applicantLicenseNumber = string.Empty;
                string applicationNumber = string.Empty;
                string engineerLicenseType = string.Empty;
                string architectLicenseType = string.Empty;
                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobNo")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicationNumber,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicationNumber;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "JobFileInfo")
                        {
                            string jobFileInfo = job != null ? job.JobNumber + " - TR7-76629.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "HouseNo")
                        {
                            string houseNo = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = houseNo,
                                    ActualValue = houseNo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = houseNo;
                                updateJobDocumentField.ActualValue = houseNo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street")
                        {
                            string street = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = street,
                                    ActualValue = street
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = street;
                                updateJobDocumentField.ActualValue = street;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Boro")
                        {
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Block")
                        {
                            string block = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = block,
                                    ActualValue = block
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = block;
                                updateJobDocumentField.ActualValue = block;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            string lot = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lot,
                                    ActualValue = lot
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = lot;
                                updateJobDocumentField.ActualValue = lot;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BIN")
                        {
                            string bin = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = bin,
                                    ActualValue = bin
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = bin;
                                updateJobDocumentField.ActualValue = bin;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CB")
                        {
                            string comunityBoardNumber = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = comunityBoardNumber,
                                    ActualValue = comunityBoardNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = comunityBoardNumber;
                                updateJobDocumentField.ActualValue = comunityBoardNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Stories")
                        {
                            string stories = job != null && job.RfpAddress != null ? Convert.ToString(job.RfpAddress.Stories) : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = stories,
                                    ActualValue = stories
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = stories;
                                updateJobDocumentField.ActualValue = stories;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Height")
                        {
                            string buildingHeight = job != null && job.RfpAddress != null ? Convert.ToString(job.RfpAddress.Feet) : null;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = buildingHeight,
                                    ActualValue = buildingHeight
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = buildingHeight;
                                updateJobDocumentField.ActualValue = buildingHeight;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Last Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantLastName,
                                    ActualValue = applicantLastName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantLastName;
                                updateJobDocumentField.ActualValue = applicantLastName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "First Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantFirstName,
                                    ActualValue = applicantFirstName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantFirstName;
                                updateJobDocumentField.ActualValue = applicantFirstName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Middle Initial")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantMiddelName,
                                    ActualValue = applicantMiddelName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantMiddelName;
                                updateJobDocumentField.ActualValue = applicantMiddelName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Company")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyName,
                                    ActualValue = applicantCompanyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyName;
                                updateJobDocumentField.ActualValue = applicantCompanyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Phone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyPhone,
                                    ActualValue = applicantCompanyPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyPhone;
                                updateJobDocumentField.ActualValue = applicantCompanyPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyAddress,
                                    ActualValue = applicantCompanyAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyAddress;
                                updateJobDocumentField.ActualValue = applicantCompanyAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Fax")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "City")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyCity,
                                    ActualValue = applicantCompanyCity
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyCity;
                                updateJobDocumentField.ActualValue = applicantCompanyCity;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "State")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyState,
                                    ActualValue = applicantCompanyState
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyState;
                                updateJobDocumentField.ActualValue = applicantCompanyState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Zip")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyZip,
                                    ActualValue = applicantCompanyZip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyZip;
                                updateJobDocumentField.ActualValue = applicantCompanyZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "MobilePhone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantMobile,
                                    ActualValue = applicantMobile
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantMobile;
                                updateJobDocumentField.ActualValue = applicantMobile;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "EMail")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantEmail,
                                    ActualValue = applicantEmail
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantEmail;
                                updateJobDocumentField.ActualValue = applicantEmail;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "P.E")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = engineerLicenseType,
                                    ActualValue = engineerLicenseType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = engineerLicenseType;
                                updateJobDocumentField.ActualValue = engineerLicenseType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "R.A")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = architectLicenseType,
                                    ActualValue = architectLicenseType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = architectLicenseType;
                                updateJobDocumentField.ActualValue = architectLicenseType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "License Number")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantLicenseNumber,
                                    ActualValue = applicantLicenseNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantLicenseNumber;
                                updateJobDocumentField.ActualValue = applicantLicenseNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "SIAgency Number")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "1_ReleventCategory")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "1_PaintswereUsed")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "1_Manufacturer")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "1_TradeName Product Id")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "1_TestedBy")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "1_UL1994OrASTME 2073")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "2_ReleventCategory")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "2_PaintswereUsed")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "2_Manufacturer")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "2_TradeName Product Id")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "2_TestedBy")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "2_UL1994OrASTME 2073")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "3_ReleventCategory")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "3_PaintswereUsed")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "3_Manufacturer")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "3_TradeName Product Id")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "3_TestedBy")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "3_UL1994OrASTME 2073")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "4_ReleventCategory")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "4_PaintswereUsed")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "4_Manufacturer")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "4_TradeName Product Id")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "4_TestedBy")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "4_UL1994OrASTME 2073")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "5_ReleventCategory")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "5_PaintswereUsed")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "5_Manufacturer")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "5_TradeName Product Id")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "5_TestedBy")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "5_UL1994OrASTME 2073")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "6_ReleventCategory")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "6_PaintswereUsed")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "6_Manufacturer")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "6_TradeName Product Id")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "6_TestedBy")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "6_UL1994OrASTME 2073")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "7_ReleventCategory")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "7_PaintswereUsed")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "7_Manufacturer")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "7_TradeName Product Id")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "7_TestedBy")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "7_UL1994OrASTME 2073")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "8_ReleventCategory")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "8_PaintswereUsed")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "8_Manufacturer")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "8_TradeName Product Id")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "8_TestedBy")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "8_UL1994OrASTME 2073")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "9_ReleventCategory")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "9_PaintswereUsed")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "9_Manufacturer")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "9_TradeName Product Id")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "9_TestedBy")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "9_UL1994OrASTME 2073")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "10_ReleventCategory")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "10_PaintswereUsed")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "10_Manufacturer")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "10_TradeName Product Id")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "10_TestedBy")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "10_UL1994OrASTME 2073")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "11_ReleventCategory")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "11_PaintswereUsed")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "11_Manufacturer")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "11_TradeName Product Id")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "11_TestedBy")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "11_UL1994OrASTME 2073")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Date")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }


                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int jobApplicantId = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.FirstOrDefault(x => x.Id == jobApplicantId);

                            applicationNumber = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Applicant")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == applicantId);

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;

                            applicantFirstName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName : string.Empty;
                            applicantLastName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.LastName : string.Empty;
                            applicantMiddelName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MiddleName : string.Empty;

                            applicantCompanyName = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;
                            applicantMobile = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MobilePhone : string.Empty;
                            applicantEmail = jobContact != null && jobContact.Contact != null ? jobContact.Contact.Email : string.Empty;
                            //   applicantLicenseNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null ? jobContact.Contact.ContactLicenses.Select(x => x.Number).FirstOrDefault() : string.Empty;

                            //  Address address = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null && jobContact.Contact.Company.Addresses != null ? jobContact.Contact.Company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;

                            Address address = Common.GetContactAddressForJobDocument(jobContact);
                            applicantCompanyAddress = address != null ? address.Address1 + " " + address.Address2 : string.Empty;
                            applicantCompanyCity = address != null ? address.City : string.Empty;
                            applicantCompanyState = address != null && address.State != null ? " " + address.State.Acronym : string.Empty;
                            //   applicantCompanyPhone = address != null ? address.Phone : string.Empty;
                            applicantCompanyPhone = Common.GetContactPhoneNumberForJobDocument(jobContact);

                            applicantCompanyZip = address != null ? address.ZipCode : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);




                            string licenceTypeNumber = string.Empty;

                            var test = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                                 jobContact.Contact.ContactLicenses.Select(x => x).ToList() : null;
                            string permitTypecode = string.Empty;
                            string test1 = string.Empty;
                            if (test != null)
                            {
                                foreach (var item1 in test)
                                {

                                    permitTypecode += item1.ContactLicenseType != null ? item1.ContactLicenseType.Name + "," : string.Empty;

                                }
                            }
                            string[] permitTypecodeArr = new string[20];
                            permitTypecodeArr = permitTypecode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("Engineer"));

                            if (permitTypecodeArr.Contains("Engineer"))
                            {
                                string licenceTypeNumber1 = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            jobContact.Contact.ContactLicenses.Where(x => x.ContactLicenseType.Name == "Engineer").Select(x => x.Number).FirstOrDefault() : string.Empty;
                                engineerLicenseType = "Yes";
                                applicantLicenseNumber = licenceTypeNumber1;
                            }
                            else if (permitTypecodeArr.Contains("Architect"))
                            {
                                string licenceTypeNumber1 = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            jobContact.Contact.ContactLicenses.Where(x => x.ContactLicenseType.Name == "Architect").Select(x => x.Number).FirstOrDefault() : string.Empty;
                                architectLicenseType = "Yes";
                                applicantLicenseNumber = licenceTypeNumber1;
                            }




                            //string licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            // jobContact.Contact.ContactLicenses.Select(x => x.Number).FirstOrDefault() : string.Empty;
                            //if (!string.IsNullOrEmpty(licenceTypeNumber))
                            //{
                            //    ContactLicense contactLicenseType = rpoContext.ContactLicenses.Where(a => a.Number == licenceTypeNumber).FirstOrDefault();
                            //    ContactLicenseType LicenseType = rpoContext.ContactLicenseTypes.Where(b => b.Id == contactLicenseType.IdContactLicenseType).FirstOrDefault();
                            //    if (LicenseType.Name.ToLower() == ("Engineer").ToLower())
                            //    {
                            //        engineerLicenseType = "Yes";
                            //        applicantLicenseNumber = licenceTypeNumber;
                            //    }
                            //    else if (LicenseType.Name.ToLower() == ("Architect").ToLower())
                            //    {
                            //        architectLicenseType = "Yes";
                            //        applicantLicenseNumber = licenceTypeNumber;
                            //    }
                            //}
                            //else
                            //{
                            //    licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            //    jobContact.Contact.ContactLicenses.Select(x => x.ContactLicenseType.Name).FirstOrDefault() : string.Empty;
                            //    if (licenceTypeNumber.ToLower() == ("Engineer").ToLower())
                            //    {
                            //        engineerLicenseType = "Yes";
                            //    }
                            //    else if (licenceTypeNumber.ToLower() == ("Architect").ToLower())
                            //    {
                            //        architectLicenseType = "Yes";
                            //    }
                            //}

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicantName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicantName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                }
            }
            jobDocument.DocumentDescription = documentDescription;

            rpoContext.SaveChanges();
            GenerateJobDocument(idJobDocument);
        }

        public static void EditTechnicalReportLuminousExitMarkings(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {

            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;
            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();

                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();

                string applicantLastName = string.Empty;
                string applicantFirstName = string.Empty;
                string applicantMiddelName = string.Empty;
                string applicantCompanyName = string.Empty;
                string applicantCompanyPhone = string.Empty;
                string applicantCompanyAddress = string.Empty;
                string applicantCompanyCity = string.Empty;
                string applicantCompanyState = string.Empty;
                string applicantCompanyZip = string.Empty;
                string applicantMobile = string.Empty;
                string applicantEmail = string.Empty;
                string applicantLicenseNumber = string.Empty;
                string applicationNumber = string.Empty;
                string engineerLicenseType = string.Empty;
                string architectLicenseType = string.Empty;
                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                        if (item.Field.FieldName == "JobNo")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicationNumber,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicationNumber;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "JobFileInfo")
                        {
                            string jobFileInfo = job != null ? job.JobNumber + " - TR7-76629.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }

                        }
                        else if (item.Field.FieldName == "HouseNo")
                        {
                            string houseNo = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = houseNo,
                                    ActualValue = houseNo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = houseNo;
                                updateJobDocumentField.ActualValue = houseNo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street")
                        {
                            string street = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = street,
                                    ActualValue = street
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = street;
                                updateJobDocumentField.ActualValue = street;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Boro")
                        {
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Block")
                        {
                            string block = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = block,
                                    ActualValue = block
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = block;
                                updateJobDocumentField.ActualValue = block;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            string lot = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lot,
                                    ActualValue = lot
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = lot;
                                updateJobDocumentField.ActualValue = lot;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BIN")
                        {
                            string bin = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = bin,
                                    ActualValue = bin
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = bin;
                                updateJobDocumentField.ActualValue = bin;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CB")
                        {
                            string comunityBoardNumber = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = comunityBoardNumber,
                                    ActualValue = comunityBoardNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = comunityBoardNumber;
                                updateJobDocumentField.ActualValue = comunityBoardNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Stories")
                        {
                            string stories = job != null && job.RfpAddress != null ? Convert.ToString(job.RfpAddress.Stories) : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = stories,
                                    ActualValue = stories
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = stories;
                                updateJobDocumentField.ActualValue = stories;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Height")
                        {
                            string buildingHeight = job != null && job.RfpAddress != null ? Convert.ToString(job.RfpAddress.Feet) : null;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = buildingHeight,
                                    ActualValue = buildingHeight
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = buildingHeight;
                                updateJobDocumentField.ActualValue = buildingHeight;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Last Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantLastName,
                                    ActualValue = applicantLastName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantLastName;
                                updateJobDocumentField.ActualValue = applicantLastName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "First Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantFirstName,
                                    ActualValue = applicantFirstName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantFirstName;
                                updateJobDocumentField.ActualValue = applicantFirstName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Middle Initial")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantMiddelName,
                                    ActualValue = applicantMiddelName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantMiddelName;
                                updateJobDocumentField.ActualValue = applicantMiddelName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Company")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyName,
                                    ActualValue = applicantCompanyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyName;
                                updateJobDocumentField.ActualValue = applicantCompanyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Phone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyPhone,
                                    ActualValue = applicantCompanyPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyPhone;
                                updateJobDocumentField.ActualValue = applicantCompanyPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyAddress,
                                    ActualValue = applicantCompanyAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyAddress;
                                updateJobDocumentField.ActualValue = applicantCompanyAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "City")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyCity,
                                    ActualValue = applicantCompanyCity
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyCity;
                                updateJobDocumentField.ActualValue = applicantCompanyCity;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "State")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyState,
                                    ActualValue = applicantCompanyState
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyState;
                                updateJobDocumentField.ActualValue = applicantCompanyState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Zip")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyZip,
                                    ActualValue = applicantCompanyZip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyZip;
                                updateJobDocumentField.ActualValue = applicantCompanyZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "MobilePhone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantMobile,
                                    ActualValue = applicantMobile
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantMobile;
                                updateJobDocumentField.ActualValue = applicantMobile;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "EMail")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantEmail,
                                    ActualValue = applicantEmail
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantEmail;
                                updateJobDocumentField.ActualValue = applicantEmail;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "P.E")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = engineerLicenseType,
                                    ActualValue = engineerLicenseType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = engineerLicenseType;
                                updateJobDocumentField.ActualValue = engineerLicenseType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "R.A")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = architectLicenseType,
                                    ActualValue = architectLicenseType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = architectLicenseType;
                                updateJobDocumentField.ActualValue = architectLicenseType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "License Number")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantLicenseNumber,
                                    ActualValue = applicantLicenseNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantLicenseNumber;
                                updateJobDocumentField.ActualValue = applicantLicenseNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int jobApplicantId = Convert.ToInt32(frontendFields.Value);
                            JobApplication jobApplication = rpoContext.JobApplications.FirstOrDefault(x => x.Id == jobApplicantId);

                            applicationNumber = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicationNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicationNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Applicant")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == applicantId);

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;

                            applicantFirstName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName : string.Empty;
                            applicantLastName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.LastName : string.Empty;
                            applicantMiddelName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MiddleName : string.Empty;

                            applicantCompanyName = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;
                            applicantMobile = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MobilePhone : string.Empty;
                            applicantEmail = jobContact != null && jobContact.Contact != null ? jobContact.Contact.Email : string.Empty;
                            //   applicantLicenseNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null ? jobContact.Contact.ContactLicenses.Select(x => x.Number).FirstOrDefault() : string.Empty;

                            //  Address address = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null && jobContact.Contact.Company.Addresses != null ? jobContact.Contact.Company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;

                            Address address = Common.GetContactAddressForJobDocument(jobContact);
                            applicantCompanyAddress = address != null ? address.Address1 + " " + address.Address2 : string.Empty;
                            applicantCompanyCity = address != null ? address.City : string.Empty;
                            applicantCompanyState = address != null && address.State != null ? " " + address.State.Acronym : string.Empty;
                            //   applicantCompanyPhone = address != null ? address.Phone : string.Empty;
                            applicantCompanyPhone = Common.GetContactPhoneNumberForJobDocument(jobContact);

                            applicantCompanyZip = address != null ? address.ZipCode : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);




                            string licenceTypeNumber = string.Empty;

                            var test = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                                 jobContact.Contact.ContactLicenses.Select(x => x).ToList() : null;
                            string permitTypecode = string.Empty;
                            string test1 = string.Empty;
                            if (test != null)
                            {
                                foreach (var item1 in test)
                                {

                                    permitTypecode += item1.ContactLicenseType != null ? item1.ContactLicenseType.Name + "," : string.Empty;

                                }
                            }
                            string[] permitTypecodeArr = new string[20];
                            permitTypecodeArr = permitTypecode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("Engineer"));

                            if (permitTypecodeArr.Contains("Engineer"))
                            {
                                string licenceTypeNumber1 = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            jobContact.Contact.ContactLicenses.Where(x => x.ContactLicenseType.Name == "Engineer").Select(x => x.Number).FirstOrDefault() : string.Empty;
                                engineerLicenseType = "Yes";
                                applicantLicenseNumber = licenceTypeNumber1;
                            }
                            else if (permitTypecodeArr.Contains("Architect"))
                            {
                                string licenceTypeNumber1 = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            jobContact.Contact.ContactLicenses.Where(x => x.ContactLicenseType.Name == "Architect").Select(x => x.Number).FirstOrDefault() : string.Empty;
                                architectLicenseType = "Yes";
                                applicantLicenseNumber = licenceTypeNumber1;
                            }




                            //string licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            // jobContact.Contact.ContactLicenses.Select(x => x.Number).FirstOrDefault() : string.Empty;
                            //if (!string.IsNullOrEmpty(licenceTypeNumber))
                            //{
                            //    ContactLicense contactLicenseType = rpoContext.ContactLicenses.Where(a => a.Number == licenceTypeNumber).FirstOrDefault();
                            //    ContactLicenseType LicenseType = rpoContext.ContactLicenseTypes.Where(b => b.Id == contactLicenseType.IdContactLicenseType).FirstOrDefault();
                            //    if (LicenseType.Name.ToLower() == ("Engineer").ToLower())
                            //    {
                            //        engineerLicenseType = "Yes";
                            //        applicantLicenseNumber = licenceTypeNumber;
                            //    }
                            //    else if (LicenseType.Name.ToLower() == ("Architect").ToLower())
                            //    {
                            //        architectLicenseType = "Yes";
                            //        applicantLicenseNumber = licenceTypeNumber;
                            //    }
                            //}
                            //else
                            //{
                            //    licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            //    jobContact.Contact.ContactLicenses.Select(x => x.ContactLicenseType.Name).FirstOrDefault() : string.Empty;
                            //    if (licenceTypeNumber.ToLower() == ("Engineer").ToLower())
                            //    {
                            //        engineerLicenseType = "Yes";
                            //    }
                            //    else if (licenceTypeNumber.ToLower() == ("Architect").ToLower())
                            //    {
                            //        architectLicenseType = "Yes";
                            //    }
                            //}

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicantName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField && x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicantName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                }
            }
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument.DocumentDescription = documentDescription;

            rpoContext.SaveChanges();
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }

        public static void GenerateTecTechnicalReportformTR6(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {

            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;
            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();
                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();

                string amendedFiling = string.Empty;
                string initialFiling = string.Empty;
                string subsequentFiling = string.Empty;

                string applicantLastName = string.Empty;
                string applicantFirstName = string.Empty;
                string applicantMiddelName = string.Empty;
                string applicantCompanyName = string.Empty;
                string applicantCompanyPhone = string.Empty;
                string applicantCompanyAddress = string.Empty;
                string applicantCompanyCity = string.Empty;
                string applicantCompanyState = string.Empty;
                string applicantCompanyZip = string.Empty;
                string applicantMobile = string.Empty;
                string applicantEmail = string.Empty;
                string applicantLicenseNumber = string.Empty;
                string engineerLicenseType = string.Empty;
                string architectLicenseType = string.Empty;
                Address ownerCompanyAddress = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null
                                 && job.RfpAddress.OwnerContact.Company != null && job.RfpAddress.OwnerContact.Company.Addresses != null ? job.RfpAddress.OwnerContact.Company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;

                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {

                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            string jobFileInfo = job != null ? job.JobNumber + " - TR6-76630.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Control")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "6IF")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = initialFiling,
                                    ActualValue = initialFiling
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = initialFiling;
                                updateJobDocumentField.ActualValue = initialFiling;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "6AF")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = amendedFiling,
                                    ActualValue = amendedFiling
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = amendedFiling;
                                updateJobDocumentField.ActualValue = amendedFiling;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "6SCF")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = subsequentFiling,
                                    ActualValue = subsequentFiling
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = subsequentFiling;
                                updateJobDocumentField.ActualValue = subsequentFiling;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Report cycle")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Report cycle 2")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Initial filing date")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Last cycle filing date")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Initial unsafe filing date")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "HouseNo")
                        {
                            string houseNo = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = houseNo,
                                    ActualValue = houseNo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = houseNo;
                                updateJobDocumentField.ActualValue = houseNo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street")
                        {
                            string street = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = street,
                                    ActualValue = street
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = street;
                                updateJobDocumentField.ActualValue = street;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Location Zip")
                        {
                            string zipCode = job != null && job.RfpAddress != null ? job.RfpAddress.ZipCode : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = zipCode,
                                    ActualValue = zipCode
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = zipCode;
                                updateJobDocumentField.ActualValue = zipCode;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CB")
                        {
                            string comunityBoardNumber = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = comunityBoardNumber,
                                    ActualValue = comunityBoardNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = comunityBoardNumber;
                                updateJobDocumentField.ActualValue = comunityBoardNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BIN")
                        {
                            string bin = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = bin,
                                    ActualValue = bin
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = bin;
                                updateJobDocumentField.ActualValue = bin;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Boro")
                        {
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "AKA")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Block")
                        {
                            string block = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = block,
                                    ActualValue = block
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = block;
                                updateJobDocumentField.ActualValue = block;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            string lot = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lot,
                                    ActualValue = lot
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = lot;
                                updateJobDocumentField.ActualValue = lot;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Last Inspection Date")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Recommanded Date")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "safe")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "safe with repair")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "unsafe")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PriorFilingCycle")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "priorfilingSafe")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "priorfilingSWARMP")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "priorfilingunsafe")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Landmark Building")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Landmark District")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Stories")
                        {
                            string stories = job != null && job.RfpAddress != null ? Convert.ToString(job.RfpAddress.Stories) : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = stories,
                                    ActualValue = stories
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = stories;
                                updateJobDocumentField.ActualValue = stories;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "ExteriorWallType")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Wall Subject Inspection")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Walls Subject to Inspection All Partial")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Last Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantLastName,
                                    ActualValue = applicantLastName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantLastName;
                                updateJobDocumentField.ActualValue = applicantLastName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "First Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantFirstName,
                                    ActualValue = applicantFirstName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantFirstName;
                                updateJobDocumentField.ActualValue = applicantFirstName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Middle Initial")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantMiddelName,
                                    ActualValue = applicantMiddelName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantMiddelName;
                                updateJobDocumentField.ActualValue = applicantMiddelName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Company")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyName,
                                    ActualValue = applicantCompanyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyName;
                                updateJobDocumentField.ActualValue = applicantCompanyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyAddress,
                                    ActualValue = applicantCompanyAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyAddress;
                                updateJobDocumentField.ActualValue = applicantCompanyAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Phone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyPhone,
                                    ActualValue = applicantCompanyPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyPhone;
                                updateJobDocumentField.ActualValue = applicantCompanyPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "City")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyCity,
                                    ActualValue = applicantCompanyCity
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyCity;
                                updateJobDocumentField.ActualValue = applicantCompanyCity;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "State")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyState,
                                    ActualValue = applicantCompanyState
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyState;
                                updateJobDocumentField.ActualValue = applicantCompanyState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Zip")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyZip,
                                    ActualValue = applicantCompanyZip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantCompanyZip;
                                updateJobDocumentField.ActualValue = applicantCompanyZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Fax")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "License No")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantLicenseNumber,
                                    ActualValue = applicantLicenseNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantLicenseNumber;
                                updateJobDocumentField.ActualValue = applicantLicenseNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PE")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = engineerLicenseType,
                                    ActualValue = engineerLicenseType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = engineerLicenseType;
                                updateJobDocumentField.ActualValue = engineerLicenseType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "RA")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = architectLicenseType,
                                    ActualValue = architectLicenseType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = architectLicenseType;
                                updateJobDocumentField.ActualValue = architectLicenseType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Mobile Phone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantMobile,
                                    ActualValue = applicantMobile
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantMobile;
                                updateJobDocumentField.ActualValue = applicantMobile;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Email")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantEmail,
                                    ActualValue = applicantEmail
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = applicantEmail;
                                updateJobDocumentField.ActualValue = applicantEmail;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Last Name")
                        {
                            string ownerLastName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.LastName : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerLastName,
                                    ActualValue = ownerLastName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerLastName;
                                updateJobDocumentField.ActualValue = ownerLastName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner First Name")
                        {
                            string ownerFirstName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerFirstName,
                                    ActualValue = ownerFirstName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerFirstName;
                                updateJobDocumentField.ActualValue = ownerFirstName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Middle Initial")
                        {
                            string ownerMiddleName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.MiddleName : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerMiddleName,
                                    ActualValue = ownerMiddleName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerMiddleName;
                                updateJobDocumentField.ActualValue = ownerMiddleName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Company")
                        {
                            string ownerCompany = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null
                                 && job.RfpAddress.OwnerContact.Company != null ? job.RfpAddress.OwnerContact.Company.Name : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerCompany,
                                    ActualValue = ownerCompany
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerCompany;
                                updateJobDocumentField.ActualValue = ownerCompany;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Address")
                        {


                            string companyAddress = ownerCompanyAddress != null ? ownerCompanyAddress.Address1 + " " + ownerCompanyAddress.Address2 : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyAddress,
                                    ActualValue = companyAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = companyAddress;
                                updateJobDocumentField.ActualValue = companyAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Phone")
                        {
                            string ownerPhone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null
                                 ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;
                            if (string.IsNullOrEmpty(ownerPhone))
                            {
                                ownerPhone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null
                                 ? job.RfpAddress.OwnerContact.MobilePhone : string.Empty;
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerPhone,
                                    ActualValue = ownerPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerPhone;
                                updateJobDocumentField.ActualValue = ownerPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner City")
                        {
                            string companyCity = ownerCompanyAddress != null ? ownerCompanyAddress.City : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyCity,
                                    ActualValue = companyCity
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = companyCity;
                                updateJobDocumentField.ActualValue = companyCity;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner State")
                        {
                            string companyState = ownerCompanyAddress != null && ownerCompanyAddress.State != null ? ownerCompanyAddress.State.Acronym : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyState,
                                    ActualValue = companyState
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = companyState;
                                updateJobDocumentField.ActualValue = companyState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Zip")
                        {
                            string companyZip = ownerCompanyAddress != null ? ownerCompanyAddress.ZipCode : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyZip,
                                    ActualValue = companyZip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = companyZip;
                                updateJobDocumentField.ActualValue = companyZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Fax")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner EMail")
                        {
                            string companyEMail = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyEMail,
                                    ActualValue = companyEMail
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = companyEMail;
                                updateJobDocumentField.ActualValue = companyEMail;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner MobilePhone")
                        {
                            string ownerMobilePhone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.MobilePhone : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerMobilePhone,
                                    ActualValue = ownerMobilePhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerMobilePhone;
                                updateJobDocumentField.ActualValue = ownerMobilePhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Date")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Name")
                        {
                            string ownerName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerName,
                                    ActualValue = ownerName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerName;
                                updateJobDocumentField.ActualValue = ownerName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Title")
                        {
                            //  string ownerTitle = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.ContactTitle != null ? job.RfpAddress.OwnerContact.ContactTitle.Name : string.Empty;
                            string ownerTitle = string.Empty;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerTitle,
                                    ActualValue = ownerTitle
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerTitle;
                                updateJobDocumentField.ActualValue = ownerTitle;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Phone7")
                        {
                            string ownerPhone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerPhone,
                                    ActualValue = ownerPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerPhone;
                                updateJobDocumentField.ActualValue = ownerPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner EMail7")
                        {
                            string ownerEmail = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerEmail,
                                    ActualValue = ownerEmail
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = ownerEmail;
                                updateJobDocumentField.ActualValue = ownerEmail;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Date")
                        {
                            //  DateTime date = DateTime.Today;
                            // string format = "MMM d yyyy";
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = string.Empty,
                                    ActualValue = string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = string.Empty;
                                updateJobDocumentField.ActualValue = string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }


                        rpoContext.SaveChanges();
                    }
                    else
                    {

                        if (item.Field.FieldName == "Type")
                        {
                            int jobDocumentTypeId = Convert.ToInt32(frontendFields.Value);
                            JobDocumentType jobDocumentType = rpoContext.JobDocumentTypes.FirstOrDefault(x => x.Id == jobDocumentTypeId);

                            string docuementType = jobDocumentType != null ? jobDocumentType.Type : string.Empty;
                            if (docuementType.ToLower() == ("Amended Filing").ToLower())
                            {
                                amendedFiling = "Yes";

                                documentDescription = documentDescription + "Type: " + "Amended Filing";
                            }
                            else if (docuementType.ToLower() == ("Initial Filing").ToLower())
                            {
                                initialFiling = "Yes";
                                documentDescription = documentDescription + "Type: " + "Initial Filing";
                            }
                            else if (docuementType.ToLower() == ("Subsequent Filing").ToLower())
                            {
                                subsequentFiling = "Yes";
                                documentDescription = documentDescription + "Type: " + "Subsequent Filing";
                            }

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = subsequentFiling
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = subsequentFiling;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Exterior Wall Inspector")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == applicantId);

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;

                            applicantFirstName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName : string.Empty;
                            applicantLastName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.LastName : string.Empty;
                            applicantMiddelName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MiddleName : string.Empty;

                            applicantCompanyName = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;
                            applicantMobile = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MobilePhone : string.Empty;
                            applicantEmail = jobContact != null && jobContact.Contact != null ? jobContact.Contact.Email : string.Empty;


                            string licenceTypeNumber = string.Empty;

                            var test = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                                 jobContact.Contact.ContactLicenses.Select(x => x).ToList() : null;
                            string permitTypecode = string.Empty;
                            string test1 = string.Empty;
                            if (test != null)
                            {
                                foreach (var item1 in test)
                                {

                                    permitTypecode += item1.ContactLicenseType != null ? item1.ContactLicenseType.Name + "," : string.Empty;

                                }
                            }
                            string[] permitTypecodeArr = new string[20];
                            permitTypecodeArr = permitTypecode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("Engineer"));

                            if (permitTypecodeArr.Contains("Engineer"))
                            {
                                string licenceTypeNumber1 = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            jobContact.Contact.ContactLicenses.Where(x => x.ContactLicenseType.Name == "Engineer").Select(x => x.Number).FirstOrDefault() : string.Empty;
                                engineerLicenseType = "Yes";
                                applicantLicenseNumber = licenceTypeNumber1;
                            }
                            else if (permitTypecodeArr.Contains("Architect"))
                            {
                                string licenceTypeNumber1 = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            jobContact.Contact.ContactLicenses.Where(x => x.ContactLicenseType.Name == "Architect").Select(x => x.Number).FirstOrDefault() : string.Empty;
                                architectLicenseType = "Yes";
                                applicantLicenseNumber = licenceTypeNumber1;
                            }



                            //string licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            //  jobContact.Contact.ContactLicenses.Select(x => x.Number).FirstOrDefault() : string.Empty;
                            //if (!string.IsNullOrEmpty(licenceTypeNumber))
                            //{
                            //    ContactLicense contactLicenseType = rpoContext.ContactLicenses.Where(a => a.Number == licenceTypeNumber).FirstOrDefault();
                            //    ContactLicenseType LicenseType = rpoContext.ContactLicenseTypes.Where(b => b.Id == contactLicenseType.IdContactLicenseType).FirstOrDefault();
                            //    if (LicenseType.Name.ToLower() == ("Engineer").ToLower())
                            //    {
                            //        engineerLicenseType = "Yes";
                            //        applicantLicenseNumber = licenceTypeNumber;
                            //    }
                            //    else if (LicenseType.Name.ToLower() == ("Architect").ToLower())
                            //    {
                            //        architectLicenseType = "Yes";
                            //        applicantLicenseNumber = licenceTypeNumber;
                            //    }
                            //}
                            //else
                            //{
                            //    licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            //    jobContact.Contact.ContactLicenses.Select(x => x.ContactLicenseType.Name).FirstOrDefault() : string.Empty;
                            //    if (licenceTypeNumber.ToLower() == ("Engineer").ToLower())
                            //    {
                            //        engineerLicenseType = "Yes";
                            //    }
                            //    else if (licenceTypeNumber.ToLower() == ("Architect").ToLower())
                            //    {
                            //        architectLicenseType = "Yes";
                            //    }
                            //}

                            Address address = Common.GetContactAddressForJobDocument(jobContact);

                            applicantCompanyAddress = address != null ? address.Address1 + " " + address.Address2 : string.Empty;
                            applicantCompanyCity = address != null ? address.City : string.Empty;
                            applicantCompanyState = address != null && address.State != null ? " " + address.State.Acronym : string.Empty;

                            applicantCompanyPhone = Common.GetContactPhoneNumberForJobDocument(jobContact);
                            applicantCompanyZip = address != null ? address.ZipCode : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(applicantName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicantName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicantName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                }
            }
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();

            GenerateJobDocument(idJobDocument);
        }


        public static void EditTecTechnicalReportformTR6(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {

            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;
            List<IdItemName> FieldsValue = new List<IdItemName>();
            List<string> pdfFields = new List<string>();
            List<int> DocumentFieldsIds = new List<int>();
            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                Job job = rpoContext.Jobs.Include("ProjectManager").
                    Include("Contact.ContactTitle").
                    Include("RfpAddress.Borough").
                    Include("Company.Addresses.AddressType").
                    Include("Company.Addresses.State")
                    .Where(x => x.Id == jobDocumentCreateOrUpdateDTO.IdJob).FirstOrDefault();
                var jobDocumentFieldList = rpoContext.JobDocumentFields.Where(x => x.IdJobDocument == idJobDocument).ToList();

                string amendedFiling = string.Empty;
                string initialFiling = string.Empty;
                string subsequentFiling = string.Empty;

                string applicantLastName = string.Empty;
                string applicantFirstName = string.Empty;
                string applicantMiddelName = string.Empty;
                string applicantCompanyName = string.Empty;
                string applicantCompanyPhone = string.Empty;
                string applicantCompanyAddress = string.Empty;
                string applicantCompanyCity = string.Empty;
                string applicantCompanyState = string.Empty;
                string applicantCompanyZip = string.Empty;
                string applicantMobile = string.Empty;
                string applicantEmail = string.Empty;
                string applicantLicenseNumber = string.Empty;
                string engineerLicenseType = string.Empty;
                string architectLicenseType = string.Empty;
                Address ownerCompanyAddress = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null
                                 && job.RfpAddress.OwnerContact.Company != null && job.RfpAddress.OwnerContact.Company.Addresses != null ? job.RfpAddress.OwnerContact.Company.Addresses.OrderBy(x => x.AddressType.DisplayOrder).FirstOrDefault() : null;

                foreach (DocumentField item in documentFieldList)
                {
                    JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {

                        if (item.Field.FieldName == "JobFileInfo")
                        {
                            string jobFileInfo = job != null ? job.JobNumber + " - TR6-76630.pdf" : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = jobFileInfo,
                                    ActualValue = jobFileInfo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = jobFileInfo;
                                updateJobDocumentField.ActualValue = jobFileInfo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "6IF")
                        {

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = initialFiling,
                                    ActualValue = initialFiling
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = initialFiling;
                                updateJobDocumentField.ActualValue = initialFiling;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "6AF")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = amendedFiling,
                                    ActualValue = amendedFiling
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = amendedFiling;
                                updateJobDocumentField.ActualValue = amendedFiling;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "6SCF")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = subsequentFiling,
                                    ActualValue = subsequentFiling
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = subsequentFiling;
                                updateJobDocumentField.ActualValue = subsequentFiling;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "HouseNo")
                        {
                            string houseNo = job != null && job.RfpAddress != null ? job.RfpAddress.HouseNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = houseNo,
                                    ActualValue = houseNo
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = houseNo;
                                updateJobDocumentField.ActualValue = houseNo;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Street")
                        {
                            string street = job != null && job.RfpAddress != null ? job.RfpAddress.Street : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = street,
                                    ActualValue = street
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = street;
                                updateJobDocumentField.ActualValue = street;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Location Zip")
                        {
                            string zipCode = job != null && job.RfpAddress != null ? job.RfpAddress.ZipCode : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = zipCode,
                                    ActualValue = zipCode
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = zipCode;
                                updateJobDocumentField.ActualValue = zipCode;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "CB")
                        {
                            string comunityBoardNumber = job != null && job.RfpAddress != null ? job.RfpAddress.ComunityBoardNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = comunityBoardNumber,
                                    ActualValue = comunityBoardNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = comunityBoardNumber;
                                updateJobDocumentField.ActualValue = comunityBoardNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "BIN")
                        {
                            string bin = job != null && job.RfpAddress != null ? job.RfpAddress.BinNumber : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = bin,
                                    ActualValue = bin
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = bin;
                                updateJobDocumentField.ActualValue = bin;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Boro")
                        {
                            string borough = job != null && job.RfpAddress != null && job.RfpAddress.Borough != null ? job.RfpAddress.Borough.Description : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = borough,
                                    ActualValue = borough
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = borough;
                                updateJobDocumentField.ActualValue = borough;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Block")
                        {
                            string block = job != null && job.RfpAddress != null ? job.RfpAddress.Block : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = block,
                                    ActualValue = block
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = block;
                                updateJobDocumentField.ActualValue = block;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Lot")
                        {
                            string lot = job != null && job.RfpAddress != null ? job.RfpAddress.Lot : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = lot,
                                    ActualValue = lot
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = lot;
                                updateJobDocumentField.ActualValue = lot;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Stories")
                        {
                            string stories = job != null && job.RfpAddress != null ? Convert.ToString(job.RfpAddress.Stories) : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = stories,
                                    ActualValue = stories
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = stories;
                                updateJobDocumentField.ActualValue = stories;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "Last Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantLastName,
                                    ActualValue = applicantLastName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantLastName;
                                updateJobDocumentField.ActualValue = applicantLastName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "First Name")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantFirstName,
                                    ActualValue = applicantFirstName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantFirstName;
                                updateJobDocumentField.ActualValue = applicantFirstName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Middle Initial")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantMiddelName,
                                    ActualValue = applicantMiddelName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantMiddelName;
                                updateJobDocumentField.ActualValue = applicantMiddelName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Company")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyName,
                                    ActualValue = applicantCompanyName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyName;
                                updateJobDocumentField.ActualValue = applicantCompanyName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Address")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyAddress,
                                    ActualValue = applicantCompanyAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyAddress;
                                updateJobDocumentField.ActualValue = applicantCompanyAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Phone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyPhone,
                                    ActualValue = applicantCompanyPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyPhone;
                                updateJobDocumentField.ActualValue = applicantCompanyPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "City")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyCity,
                                    ActualValue = applicantCompanyCity
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyCity;
                                updateJobDocumentField.ActualValue = applicantCompanyCity;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "State")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyState,
                                    ActualValue = applicantCompanyState
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyState;
                                updateJobDocumentField.ActualValue = applicantCompanyState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Zip")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantCompanyZip,
                                    ActualValue = applicantCompanyZip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantCompanyZip;
                                updateJobDocumentField.ActualValue = applicantCompanyZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        else if (item.Field.FieldName == "License No")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantLicenseNumber,
                                    ActualValue = applicantLicenseNumber
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantLicenseNumber;
                                updateJobDocumentField.ActualValue = applicantLicenseNumber;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "PE")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = engineerLicenseType,
                                    ActualValue = engineerLicenseType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = engineerLicenseType;
                                updateJobDocumentField.ActualValue = engineerLicenseType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "RA")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = architectLicenseType,
                                    ActualValue = architectLicenseType
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = architectLicenseType;
                                updateJobDocumentField.ActualValue = architectLicenseType;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Mobile Phone")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantMobile,
                                    ActualValue = applicantMobile
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantMobile;
                                updateJobDocumentField.ActualValue = applicantMobile;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Email")
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = applicantEmail,
                                    ActualValue = applicantEmail
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = applicantEmail;
                                updateJobDocumentField.ActualValue = applicantEmail;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Last Name")
                        {
                            string ownerLastName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.LastName : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerLastName,
                                    ActualValue = ownerLastName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = ownerLastName;
                                updateJobDocumentField.ActualValue = ownerLastName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner First Name")
                        {
                            string ownerFirstName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerFirstName,
                                    ActualValue = ownerFirstName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = ownerFirstName;
                                updateJobDocumentField.ActualValue = ownerFirstName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Middle Initial")
                        {
                            string ownerMiddleName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.MiddleName : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerMiddleName,
                                    ActualValue = ownerMiddleName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = ownerMiddleName;
                                updateJobDocumentField.ActualValue = ownerMiddleName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Company")
                        {
                            string ownerCompany = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null
                                 && job.RfpAddress.OwnerContact.Company != null ? job.RfpAddress.OwnerContact.Company.Name : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerCompany,
                                    ActualValue = ownerCompany
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = ownerCompany;
                                updateJobDocumentField.ActualValue = ownerCompany;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Address")
                        {


                            string companyAddress = ownerCompanyAddress != null ? ownerCompanyAddress.Address1 + " " + ownerCompanyAddress.Address2 : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyAddress,
                                    ActualValue = companyAddress
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = companyAddress;
                                updateJobDocumentField.ActualValue = companyAddress;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });

                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Phone")
                        {
                            string ownerPhone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null
                                 ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;
                            if (string.IsNullOrEmpty(ownerPhone))
                            {
                                ownerPhone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null
                                 ? job.RfpAddress.OwnerContact.MobilePhone : string.Empty;
                            }
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerPhone,
                                    ActualValue = ownerPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = ownerPhone;
                                updateJobDocumentField.ActualValue = ownerPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner City")
                        {
                            string companyCity = ownerCompanyAddress != null ? ownerCompanyAddress.City : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyCity,
                                    ActualValue = companyCity
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = companyCity;
                                updateJobDocumentField.ActualValue = companyCity;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner State")
                        {
                            string companyState = ownerCompanyAddress != null && ownerCompanyAddress.State != null ? ownerCompanyAddress.State.Acronym : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyState,
                                    ActualValue = companyState
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = companyState;
                                updateJobDocumentField.ActualValue = companyState;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Zip")
                        {
                            string companyZip = ownerCompanyAddress != null ? ownerCompanyAddress.ZipCode : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyZip,
                                    ActualValue = companyZip
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = companyZip;
                                updateJobDocumentField.ActualValue = companyZip;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner EMail")
                        {
                            string companyEMail = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = companyEMail,
                                    ActualValue = companyEMail
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = companyEMail;
                                updateJobDocumentField.ActualValue = companyEMail;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner MobilePhone")
                        {
                            string ownerMobilePhone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.MobilePhone : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerMobilePhone,
                                    ActualValue = ownerMobilePhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = ownerMobilePhone;
                                updateJobDocumentField.ActualValue = ownerMobilePhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }


                        else if (item.Field.FieldName == "Owner Name")
                        {
                            string ownerName = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.FirstName + " " + job.RfpAddress.OwnerContact.LastName : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerName,
                                    ActualValue = ownerName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = ownerName;
                                updateJobDocumentField.ActualValue = ownerName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Title")
                        {
                            //  string ownerTitle = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null && job.RfpAddress.OwnerContact.ContactTitle != null ? job.RfpAddress.OwnerContact.ContactTitle.Name : string.Empty;
                            string ownerTitle = string.Empty;

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerTitle,
                                    ActualValue = ownerTitle
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = ownerTitle;
                                updateJobDocumentField.ActualValue = ownerTitle;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner Phone7")
                        {
                            string ownerPhone = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.WorkPhone : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerPhone,
                                    ActualValue = ownerPhone
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = ownerPhone;
                                updateJobDocumentField.ActualValue = ownerPhone;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;

                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Owner EMail7")
                        {
                            string ownerEmail = job != null && job.RfpAddress != null && job.RfpAddress.OwnerContact != null ? job.RfpAddress.OwnerContact.Email : string.Empty;
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = ownerEmail,
                                    ActualValue = ownerEmail
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = ownerEmail;
                                updateJobDocumentField.ActualValue = ownerEmail;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }

                        rpoContext.SaveChanges();
                    }
                    else
                    {

                        if (item.Field.FieldName == "Type")
                        {
                            int jobDocumentTypeId = Convert.ToInt32(frontendFields.Value);
                            JobDocumentType jobDocumentType = rpoContext.JobDocumentTypes.FirstOrDefault(x => x.Id == jobDocumentTypeId);

                            string docuementType = jobDocumentType != null ? jobDocumentType.Type : string.Empty;
                            if (docuementType.ToLower() == ("Amended Filing").ToLower())
                            {
                                amendedFiling = "Yes";

                                documentDescription = documentDescription + "Type: " + "Amended Filing";
                            }
                            else if (docuementType.ToLower() == ("Initial Filing").ToLower())
                            {
                                initialFiling = "Yes";
                                documentDescription = documentDescription + "Type: " + "Initial Filing";
                            }
                            else if (docuementType.ToLower() == ("Subsequent Filing").ToLower())
                            {
                                subsequentFiling = "Yes";
                                documentDescription = documentDescription + "Type: " + "Subsequent Filing";
                            }

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = subsequentFiling
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = subsequentFiling;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Exterior Wall Inspector")
                        {
                            int applicantId = Convert.ToInt32(frontendFields.Value);
                            JobContact jobContact = rpoContext.JobContacts.FirstOrDefault(x => x.Id == applicantId);

                            string applicantName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName + " " + jobContact.Contact.LastName : string.Empty;

                            applicantFirstName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.FirstName : string.Empty;
                            applicantLastName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.LastName : string.Empty;
                            applicantMiddelName = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MiddleName : string.Empty;

                            applicantCompanyName = jobContact != null && jobContact.Contact != null && jobContact.Contact.Company != null ? jobContact.Contact.Company.Name : string.Empty;
                            applicantMobile = jobContact != null && jobContact.Contact != null ? jobContact.Contact.MobilePhone : string.Empty;
                            applicantEmail = jobContact != null && jobContact.Contact != null ? jobContact.Contact.Email : string.Empty;


                            string licenceTypeNumber = string.Empty;

                            var test = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                                 jobContact.Contact.ContactLicenses.Select(x => x).ToList() : null;
                            string permitTypecode = string.Empty;
                            string test1 = string.Empty;
                            if (test != null)
                            {
                                foreach (var item1 in test)
                                {

                                    permitTypecode += item1.ContactLicenseType != null ? item1.ContactLicenseType.Name + "," : string.Empty;

                                }
                            }
                            string[] permitTypecodeArr = new string[20];
                            permitTypecodeArr = permitTypecode.Split(',').ToArray();

                            var str = Array.FindAll(permitTypecodeArr, s => s.Equals("Engineer"));

                            if (permitTypecodeArr.Contains("Engineer"))
                            {
                                string licenceTypeNumber1 = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            jobContact.Contact.ContactLicenses.Where(x => x.ContactLicenseType.Name == "Engineer").Select(x => x.Number).FirstOrDefault() : string.Empty;
                                engineerLicenseType = "Yes";
                                applicantLicenseNumber = licenceTypeNumber1;
                            }
                            else if (permitTypecodeArr.Contains("Architect"))
                            {
                                string licenceTypeNumber1 = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            jobContact.Contact.ContactLicenses.Where(x => x.ContactLicenseType.Name == "Architect").Select(x => x.Number).FirstOrDefault() : string.Empty;
                                architectLicenseType = "Yes";
                                applicantLicenseNumber = licenceTypeNumber1;
                            }



                            //string licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            //  jobContact.Contact.ContactLicenses.Select(x => x.Number).FirstOrDefault() : string.Empty;
                            //if (!string.IsNullOrEmpty(licenceTypeNumber))
                            //{
                            //    ContactLicense contactLicenseType = rpoContext.ContactLicenses.Where(a => a.Number == licenceTypeNumber).FirstOrDefault();
                            //    ContactLicenseType LicenseType = rpoContext.ContactLicenseTypes.Where(b => b.Id == contactLicenseType.IdContactLicenseType).FirstOrDefault();
                            //    if (LicenseType.Name.ToLower() == ("Engineer").ToLower())
                            //    {
                            //        engineerLicenseType = "Yes";
                            //        applicantLicenseNumber = licenceTypeNumber;
                            //    }
                            //    else if (LicenseType.Name.ToLower() == ("Architect").ToLower())
                            //    {
                            //        architectLicenseType = "Yes";
                            //        applicantLicenseNumber = licenceTypeNumber;
                            //    }
                            //}
                            //else
                            //{
                            //    licenceTypeNumber = jobContact != null && jobContact.Contact != null && jobContact.Contact.ContactLicenses != null && jobContact.Contact.ContactLicenses.Count > 0 ?
                            //    jobContact.Contact.ContactLicenses.Select(x => x.ContactLicenseType.Name).FirstOrDefault() : string.Empty;
                            //    if (licenceTypeNumber.ToLower() == ("Engineer").ToLower())
                            //    {
                            //        engineerLicenseType = "Yes";
                            //    }
                            //    else if (licenceTypeNumber.ToLower() == ("Architect").ToLower())
                            //    {
                            //        architectLicenseType = "Yes";
                            //    }
                            //}

                            Address address = Common.GetContactAddressForJobDocument(jobContact);

                            applicantCompanyAddress = address != null ? address.Address1 + " " + address.Address2 : string.Empty;
                            applicantCompanyCity = address != null ? address.City : string.Empty;
                            applicantCompanyState = address != null && address.State != null ? " " + address.State.Acronym : string.Empty;

                            applicantCompanyPhone = Common.GetContactPhoneNumberForJobDocument(jobContact);
                            applicantCompanyZip = address != null ? address.ZipCode : string.Empty;
                            documentDescription = documentDescription + (!string.IsNullOrEmpty(documentDescription) && !string.IsNullOrEmpty(applicantName) ? " | " : string.Empty) + (!string.IsNullOrEmpty(applicantName) ? "Applicant: " + applicantName : string.Empty);

                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = Convert.ToInt32(item.Id),
                                    Value = frontendFields.Value,
                                    ActualValue = applicantName
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                            }
                            else
                            {
                                string pdffield = rpoContext.DocumentFields.Where(x => x.IdField == item.IdField).Select(x => x.PdfFields).FirstOrDefault();
                                pdfFields.Add(pdffield);
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = applicantName;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                FieldsValue.Add(new IdItemName
                                {
                                    Id = pdffield,
                                    ItemName = updateJobDocumentField.ActualValue
                                });
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        rpoContext.SaveChanges();
                    }
                }
            }
            List<string> newpdfString = pdfFields;
            List<int> newDocumentFieldId = DocumentFieldsIds;
            jobDocument.DocumentDescription = documentDescription;
            jobDocument.JobDocumentFor = jobDocumentFor;
            rpoContext.SaveChanges();
            GenerateEditedJobDocument(idJobDocument, pdfFields, newDocumentFieldId, FieldsValue);
        }


        public static void GenerateVarianceAfterHoursPermit(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.
                Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                    }
                    else
                    {
                        JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                        if (updateJobDocumentField == null)
                        {
                            JobDocumentField JobDocumentField = new JobDocumentField
                            {
                                IdJobDocument = idJobDocument,
                                IdDocumentField = frontendFields.IdDocumentField,
                                Value = frontendFields.Value,
                                ActualValue = frontendFields.Value
                            };
                            rpoContext.JobDocumentFields.Add(JobDocumentField);
                            rpoContext.SaveChanges();
                        }
                        else
                        {
                            updateJobDocumentField.Value = frontendFields.Value;
                            updateJobDocumentField.ActualValue = frontendFields.Value;
                            rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                            rpoContext.SaveChanges();
                        }
                    }

                    if (item.Field.FieldName == "Variance Permit")
                    {
                        JobDocument objdocuments = rpoContext.JobDocuments.Where(d => d.Id == idJobDocument).FirstOrDefault();
                        if (objdocuments != null && !string.IsNullOrEmpty(frontendFields.Value))
                        {
                            int frontid = int.Parse(frontendFields.Value);
                            string Description = string.Empty;
                            var objdescription = (from d in rpoContext.JobDocuments where d.Id == frontid orderby d.Id descending select d.DocumentDescription).FirstOrDefault();
                            if (objdescription != null)
                            {
                                Description = objdescription;
                            }

                            string Documentpath = string.Empty;
                            var objdocpath = (from d in rpoContext.JobDocuments where d.Id == frontid orderby d.Id descending select d.DocumentPath).FirstOrDefault();
                            if (objdocpath != null)
                            {
                                Documentpath = objdocpath;
                            }
                            objdocuments.IdJobApplication = (from d in rpoContext.JobDocuments where d.Id == frontid orderby d.Id descending select d.IdJobApplication).FirstOrDefault();
                            //objdocuments.IdParent = (from d in rpoContext.JobDocuments where d.Id == frontid && d.IdParent != null orderby d.Id descending select d.IdParent).FirstOrDefault();
                            objdocuments.IdParent = Convert.ToInt32(frontendFields.Value);
                            objdocuments.DocumentDescription = Description;
                            //objdocuments.DocumentPath = Documentpath;
                            rpoContext.SaveChanges();
                        }
                    }
                }


            }
        }

        [STAThread]
        /// <summary>
        /// Generate JobDocument
        /// </summary>
        public static void GenerateJobDocument(int idJobDocument)
        {
            /// <summary>
            /// The database.
            /// </summary>
            RpoContext rpoContext = new RpoContext();
            var path = HttpRuntime.AppDomainAppPath;
            string directoryName = string.Empty;
            string newFileDirectoryName = string.Empty;
            string fileName = string.Empty;
            string idJob = string.Empty;
            string documentName = string.Empty;
            JobDocument jobDocument = new JobDocument();

            List<JobDocumentField> jobDocumentField = rpoContext.JobDocumentFields
                    .Include("JobDocument.DocumentMaster")
                    .Include("DocumentField.Field")
                    .Where(x => x.IdJobDocument == idJobDocument).ToList();

            var jobApplications = rpoContext.JobApplications.Include("JobApplicationType").Include("ApplicationStatus").Include("CreatedByEmployee")
               .Include("LastModifiedByEmployee").AsQueryable();

            //  jobApplications = jobApplications.Where(c => c.JobApplicationType.IdParent == dataTableParameters.IdJobApplicationType);

            Job job = new Job();

            if (jobDocumentField != null && jobDocumentField.Count > 0)
            {
                fileName = jobDocumentField.Select(x => x.JobDocument.DocumentMaster.Path).FirstOrDefault();
                idJob = jobDocumentField.Select(x => Convert.ToString(x.JobDocument.IdJob)).FirstOrDefault();
                documentName = jobDocumentField.Select(x => x.JobDocument.DocumentMaster.DocumentName).FirstOrDefault();

                jobDocument = rpoContext.JobDocuments.Where(x => x.Id == idJobDocument).FirstOrDefault();

                directoryName = Path.Combine(path, Properties.Settings.Default.JobDocumentTemplatePath);
                newFileDirectoryName = Path.Combine(path, Properties.Settings.Default.JobDocumentExportPath);

                int JobId = jobDocumentField.Select(x => x.JobDocument.IdJob).FirstOrDefault();

                var pdf_filename = directoryName + fileName;
                PdfReader.unethicalreading = true;
                using (var reader = new PdfReader(pdf_filename))
                {
                    var fields = reader.AcroFields.Fields;

                    string folderDirectory = Path.Combine(newFileDirectoryName, Convert.ToString(idJob));
                    string oldFilePath = Path.Combine(folderDirectory, Convert.ToString(idJobDocument) + "_" + jobDocument.DocumentPath);

                    if (File.Exists(oldFilePath))
                    {
                        File.Delete(oldFilePath);
                    }

                    if (!Directory.Exists(newFileDirectoryName + idJob))
                    {
                        Directory.CreateDirectory(newFileDirectoryName + idJob);
                    }
                    string newfile = newFileDirectoryName + idJob + "\\" + Convert.ToString(idJobDocument) + "_" + documentName + ".pdf";

                    var pdfStamper = new PdfStamper(reader, new FileStream(newfile, FileMode.Create));


                    var field = pdfStamper.AcroFields;

                    string paragraph = string.Empty;

                    var jobDocField =
                            (from c in rpoContext.DocumentFields
                             join p in rpoContext.JobDocumentFields on c.Id equals p.IdDocumentField into ps
                             from p in ps.DefaultIfEmpty()
                             select new { DocumentField = c, JobDocumentFields = p }).ToList();

                    foreach (var item in jobDocumentField)
                    {
                        if (item.DocumentField != null && item.DocumentField.PdfFields != null)
                        {
                            string[] fieldsList = item.DocumentField.PdfFields.Split(',');

                            if (fieldsList != null && fieldsList.Count() > 0)
                            {
                                foreach (string pdfField in fieldsList)
                                {
                                    //if (jobDocument.IdDocument == Document.TenDAYN62395.GetHashCode())
                                    //{
                                    //    field.SetFieldRichValue(pdfField, string.Empty);
                                    //    field.SetFieldRichValue(pdfField, !string.IsNullOrEmpty(item.ActualValue) ? item.ActualValue : string.Empty);
                                    //}
                                    //else
                                    //{
                                    //    field.SetField(pdfField, string.Empty);
                                    //    field.SetField(pdfField, !string.IsNullOrEmpty(item.ActualValue) ? item.ActualValue : string.Empty);
                                    //}
                                    field.SetField(pdfField, string.Empty);
                                    field.SetField(pdfField, !string.IsNullOrEmpty(item.ActualValue) ? item.ActualValue : string.Empty);
                                    field.GenerateAppearances = false;
                                }
                            }
                        }
                    }

                    jobDocument.DocumentPath = documentName + ".pdf";
                    //  jobDocument.DocumentPath =Uri.EscapeDataString((documentName) + ".pdf");

                    rpoContext.SaveChanges();

                    pdfStamper.Close();

                    var instance = new DropboxIntegration();
                    string uploadFilePath = Properties.Settings.Default.DropboxFolderPath + Convert.ToString(jobDocument.IdJob);
                    string dropBoxFileName = Convert.ToString(jobDocument.Id) + "_" + jobDocument.DocumentPath;
                    string filepath = newfile;
                    var task = instance.RunUpload(uploadFilePath, dropBoxFileName, filepath);

                    string thisFileName1 = string.Empty;

                    if (documentName.Contains('#'))
                    {
                        thisFileName1 = Uri.EscapeDataString(documentName + ".pdf");
                    }
                    else
                    {
                        thisFileName1 = documentName + ".pdf";
                    }

                    jobDocument.DocumentPath = thisFileName1;

                    rpoContext.SaveChanges();
                }
            }
        }


        [STAThread]
        /// <summary>
        /// Generate JobDocument
        /// </summary>
        public static void GenerateEditedJobDocument(int idJobDocument, List<string> pdfFields, List<int> newDocumentFieldId, List<IdItemName> newList)
        {
            /// <summary>
            /// The database.
            /// </summary>
            RpoContext rpoContext = new RpoContext();
            var path = HttpRuntime.AppDomainAppPath;
            string directoryName = string.Empty;
            string newFileDirectoryName = string.Empty;
            string fileName = string.Empty;
            string idJob = string.Empty;
            string documentName = string.Empty;
            JobDocument jobDocument = new JobDocument();

            List<JobDocumentField> jobDocumentField = rpoContext.JobDocumentFields
                    .Include("JobDocument.DocumentMaster")
                    .Include("DocumentField.Field")
                    .Where(x => x.IdJobDocument == idJobDocument).ToList();

            Job job = new Job();

            if (jobDocumentField != null && jobDocumentField.Count > 0)
            {
                fileName = jobDocumentField.Select(x => x.JobDocument.DocumentMaster.Path).FirstOrDefault();
                idJob = jobDocumentField.Select(x => Convert.ToString(x.JobDocument.IdJob)).FirstOrDefault();
                documentName = jobDocumentField.Select(x => x.JobDocument.DocumentMaster.DocumentName).FirstOrDefault();

                jobDocument = rpoContext.JobDocuments.Where(x => x.Id == idJobDocument).FirstOrDefault();

                directoryName = System.IO.Path.Combine(path, Properties.Settings.Default.JobDocumentTemplatePath);
                newFileDirectoryName = System.IO.Path.Combine(path, Properties.Settings.Default.JobDocumentExportPath);

                int JobId = jobDocumentField.Select(x => x.JobDocument.IdJob).FirstOrDefault();

                var pdf_filename = directoryName + fileName;
                PdfReader.unethicalreading = true;



                string folderDirectory = System.IO.Path.Combine(newFileDirectoryName, Convert.ToString(idJob));
                string oldFilePath = System.IO.Path.Combine(folderDirectory, Convert.ToString(idJobDocument) + "_" + jobDocument.DocumentPath);




                string newfile = newFileDirectoryName + idJob + "\\" + Convert.ToString(idJobDocument) + "_" + documentName + ".pdf";


                #region DownloadFileFromDropBox
                path = HttpRuntime.AppDomainAppPath;
                string jobDocumentDirectoryName = System.IO.Path.Combine(path, Convert.ToString(Properties.Settings.Default.JobDocumentExportPath));
                jobDocumentDirectoryName = System.IO.Path.Combine(jobDocumentDirectoryName, Convert.ToString(jobDocument.IdJob));
                string jobDocumentFileName = System.IO.Path.Combine(jobDocumentDirectoryName, jobDocument.Id + "_temp" + jobDocument.DocumentPath);
                var instance = new DropboxIntegration();
                string dropBoxFilePath = Properties.Settings.Default.DropboxFolderPath + Convert.ToString(jobDocument.IdJob);
                string dropBoxFileName = Convert.ToString(jobDocument.Id) + "_" + jobDocument.DocumentPath;

                string sourceFileName = dropBoxFilePath + "/" + dropBoxFileName;

                if (!System.IO.Directory.Exists(newFileDirectoryName + idJob))
                {
                    System.IO.Directory.CreateDirectory(newFileDirectoryName + idJob);
                }

                if (System.IO.File.Exists(oldFilePath))
                {
                    System.IO.File.Delete(oldFilePath);
                }

                if (System.IO.File.Exists(jobDocumentFileName))
                {
                    System.IO.File.Delete(jobDocumentFileName);
                }



                var task = instance.RunDownload(sourceFileName, jobDocumentFileName);

                #endregion

                using (var reader1 = new PdfReader(jobDocumentFileName))
                {
                    var pdfStamper = new PdfStamper(reader1, new System.IO.FileStream(newfile, System.IO.FileMode.Create));
                    // pdfStamper.FormFlattening = false;
                    var field = pdfStamper.AcroFields;
                    string paragraph = string.Empty;

                    foreach (var item in newList)
                    {
                        if (item.Id.Contains(','))
                        {
                            string[] fieldsList = item.Id.Split(',');
                            foreach (var item2 in fieldsList)
                            {
                                field.SetField(item2, string.Empty);
                                field.SetField(item2, !string.IsNullOrEmpty(item.ItemName) ? item.ItemName : string.Empty);
                                field.GenerateAppearances = false;
                            }
                        }
                        else
                        {
                            field.SetField(item.Id, string.Empty);
                            field.SetField(item.Id, !string.IsNullOrEmpty(item.ItemName) ? item.ItemName : string.Empty);
                            field.GenerateAppearances = false;
                        }
                    }
                    jobDocument.DocumentPath = documentName + ".pdf";
                    rpoContext.SaveChanges();
                    pdfStamper.Close();

                }

                var instance1 = new DropboxIntegration();
                string uploadFilePath = Properties.Settings.Default.DropboxFolderPath + Convert.ToString(jobDocument.IdJob);
                string dropBoxFileName1 = Convert.ToString(jobDocument.Id) + "_" + jobDocument.DocumentPath;
                string filepath = newfile;
                var task1 = instance.RunUpload(uploadFilePath, dropBoxFileName, filepath);

            }
        }



        public static void GenerateEditedJobDocumentPW1A(int idJobDocument, List<string> pdfFields, List<int> newDocumentFieldId, List<IdItemName> newList)
        {
            /// <summary>
            /// The database.
            /// </summary>
            RpoContext rpoContext = new RpoContext();
            var path = HttpRuntime.AppDomainAppPath;
            string directoryName = string.Empty;
            string newFileDirectoryName = string.Empty;
            string fileName = string.Empty;
            string idJob = string.Empty;
            string documentName = string.Empty;
            JobDocument jobDocument = new JobDocument();

            List<JobDocumentField> jobDocumentField = rpoContext.JobDocumentFields
                    .Include("JobDocument.DocumentMaster")
                    .Include("DocumentField.Field")
                    .Where(x => x.IdJobDocument == idJobDocument).ToList();

            Job job = new Job();

            if (jobDocumentField != null && jobDocumentField.Count > 0)
            {
                fileName = jobDocumentField.Select(x => x.JobDocument.DocumentMaster.Path).FirstOrDefault();
                idJob = jobDocumentField.Select(x => Convert.ToString(x.JobDocument.IdJob)).FirstOrDefault();
                documentName = jobDocumentField.Select(x => x.JobDocument.DocumentMaster.DocumentName).FirstOrDefault();

                jobDocument = rpoContext.JobDocuments.Where(x => x.Id == idJobDocument).FirstOrDefault();

                directoryName = System.IO.Path.Combine(path, Properties.Settings.Default.JobDocumentTemplatePath);
                newFileDirectoryName = System.IO.Path.Combine(path, Properties.Settings.Default.JobDocumentExportPath);

                int JobId = jobDocumentField.Select(x => x.JobDocument.IdJob).FirstOrDefault();

                var pdf_filename = directoryName + fileName;
                PdfReader.unethicalreading = true;



                string folderDirectory = System.IO.Path.Combine(newFileDirectoryName, Convert.ToString(idJob));
                string oldFilePath = System.IO.Path.Combine(folderDirectory, Convert.ToString(idJobDocument) + "_" + jobDocument.DocumentPath);




                string newfile = newFileDirectoryName + idJob + "\\" + Convert.ToString(idJobDocument) + "_" + documentName + ".pdf";


                #region DownloadFileFromDropBox
                path = HttpRuntime.AppDomainAppPath;
                string jobDocumentDirectoryName = System.IO.Path.Combine(path, Convert.ToString(Properties.Settings.Default.JobDocumentExportPath));
                jobDocumentDirectoryName = System.IO.Path.Combine(jobDocumentDirectoryName, Convert.ToString(jobDocument.IdJob));
                string jobDocumentFileName = System.IO.Path.Combine(jobDocumentDirectoryName, jobDocument.Id + "_temp" + jobDocument.DocumentPath);
                var instance = new DropboxIntegration();
                string dropBoxFilePath = Properties.Settings.Default.DropboxFolderPath + Convert.ToString(jobDocument.IdJob);
                string dropBoxFileName = Convert.ToString(jobDocument.Id) + "_" + jobDocument.DocumentPath;

                string sourceFileName = dropBoxFilePath + "/" + dropBoxFileName;

                if (!System.IO.Directory.Exists(newFileDirectoryName + idJob))
                {
                    System.IO.Directory.CreateDirectory(newFileDirectoryName + idJob);
                }

                if (System.IO.File.Exists(oldFilePath))
                {
                    System.IO.File.Delete(oldFilePath);
                }

                if (System.IO.File.Exists(jobDocumentFileName))
                {
                    System.IO.File.Delete(jobDocumentFileName);
                }



                var task = instance.RunDownload(sourceFileName, jobDocumentFileName);





                PdfReader.unethicalreading = true;
                var reader = new PdfReader(jobDocumentFileName);
                string path1 = System.IO.Path.Combine(jobDocumentDirectoryName, jobDocument.Id + jobDocument.DocumentPath);

                var pdfStamper1 = new PdfStamper(reader, new FileStream(path1, FileMode.Create));
                var field1 = pdfStamper1.AcroFields;
                var reader_JobDocument = new PdfReader(jobDocumentFileName);
                int numberofPages = reader_JobDocument.NumberOfPages;

                JobDocument jobDocumentResponse = rpoContext.JobDocuments.Include("DocumentMaster").Include("JobDocumentFields.DocumentField.Field").Include("JobApplication.JobApplicationType.Parent").
                                                   Include("CreatedByEmployee").
                                                   Include("LastModifiedByEmployee")
                                                   .FirstOrDefault(x => x.Id == jobDocument.Id);

                JobDocumentField df = jobDocumentResponse.JobDocumentFields.Where(x => x.DocumentField.PdfFields == "txtName").FirstOrDefault();


                field1.SetField("txtPageCount_0", Convert.ToString(numberofPages + 1));
                field1.SetField("txtPageCount_1", Convert.ToString(numberofPages + 1));
                field1.SetField("txtDescription ", string.Empty);
                field1.SetField("txtApplicant", string.Empty);
                field1.SetField("txtDate", string.Empty);

                field1.RenameField("txtPageCount_0", "Page" + Convert.ToString(numberofPages + 1) + "_txtPageCount_0");
                field1.RenameField("txtPageCount_1", "Page" + Convert.ToString(numberofPages + 1) + "_txtPageCount_1");
                field1.RenameField("txtDescription", "Page" + Convert.ToString(numberofPages + 1) + "_txtDescription");
                field1.RenameField("txtApplicant", "Page" + Convert.ToString(numberofPages + 1) + "_txtApplicant");
                field1.RenameField("txtDate", "Page" + Convert.ToString(numberofPages + 1) + "_txtDate");

                string applicantname = string.Empty;

                if (df != null)
                {
                    applicantname = df.ActualValue;
                }



                #endregion


                using (var reader1 = new PdfReader(jobDocumentFileName))
                {
                    numberofPages = reader1.NumberOfPages;
                    var pdfStamper = new PdfStamper(reader1, new System.IO.FileStream(newfile, System.IO.FileMode.Create));

                    // pdfStamper.FormFlattening = false;
                    var field = pdfStamper.AcroFields;
                    string paragraph = string.Empty;

                    foreach (var item in newList)
                    {
                        if (item.Id.Contains(','))
                        {
                            string[] fieldsList = item.Id.Split(',');
                            foreach (var item2 in fieldsList)
                            {
                                field.SetField(item2, string.Empty);
                                field.SetField(item2, !string.IsNullOrEmpty(item.ItemName) ? item.ItemName : string.Empty);
                                field.GenerateAppearances = false;
                            }
                        }
                        else
                        {
                            field.SetField(item.Id, string.Empty);
                            field.SetField(item.Id, !string.IsNullOrEmpty(item.ItemName) ? item.ItemName : string.Empty);
                            field.GenerateAppearances = false;
                        }

                    }
                    for (int i = 1; i <= numberofPages; i++)
                    {
                        field.SetField("Page" + Convert.ToString(2 + i) + "_txtPageCount_1", Convert.ToString(numberofPages));
                        field.SetField("Page" + (2 + i) + "_txtApplicant", Convert.ToString(field.GetField("txtApplicant")));
                    }
                    field.SetField("txtPageCount", Convert.ToString(numberofPages));
                    jobDocument.DocumentPath = documentName + ".pdf";
                    rpoContext.SaveChanges();
                    pdfStamper.Close();

                }

                var instance1 = new DropboxIntegration();
                string uploadFilePath = Properties.Settings.Default.DropboxFolderPath + Convert.ToString(jobDocument.IdJob);
                string dropBoxFileName1 = Convert.ToString(jobDocument.Id) + "_" + jobDocument.DocumentPath;
                string filepath = newfile;
                var task1 = instance.RunUpload(uploadFilePath, dropBoxFileName, filepath);

            }
        }


        public static void GenerateEditedJobDocumentZD1(int idJobDocument, List<string> pdfFields, List<int> newDocumentFieldId, List<IdItemName> newList)
        {
            /// <summary>
            /// The database.
            /// </summary>
            RpoContext rpoContext = new RpoContext();
            var path = HttpRuntime.AppDomainAppPath;
            string directoryName = string.Empty;
            string newFileDirectoryName = string.Empty;
            string fileName = string.Empty;
            string idJob = string.Empty;
            string documentName = string.Empty;
            JobDocument jobDocument = new JobDocument();

            List<JobDocumentField> jobDocumentField = rpoContext.JobDocumentFields
                    .Include("JobDocument.DocumentMaster")
                    .Include("DocumentField.Field")
                    .Where(x => x.IdJobDocument == idJobDocument).ToList();

            Job job = new Job();

            if (jobDocumentField != null && jobDocumentField.Count > 0)
            {
                fileName = jobDocumentField.Select(x => x.JobDocument.DocumentMaster.Path).FirstOrDefault();
                idJob = jobDocumentField.Select(x => Convert.ToString(x.JobDocument.IdJob)).FirstOrDefault();
                documentName = jobDocumentField.Select(x => x.JobDocument.DocumentMaster.DocumentName).FirstOrDefault();

                jobDocument = rpoContext.JobDocuments.Where(x => x.Id == idJobDocument).FirstOrDefault();

                directoryName = System.IO.Path.Combine(path, Properties.Settings.Default.JobDocumentTemplatePath);
                newFileDirectoryName = System.IO.Path.Combine(path, Properties.Settings.Default.JobDocumentExportPath);

                int JobId = jobDocumentField.Select(x => x.JobDocument.IdJob).FirstOrDefault();

                var pdf_filename = directoryName + fileName;
                PdfReader.unethicalreading = true;



                string folderDirectory = System.IO.Path.Combine(newFileDirectoryName, Convert.ToString(idJob));
                string oldFilePath = System.IO.Path.Combine(folderDirectory, Convert.ToString(idJobDocument) + "_" + jobDocument.DocumentPath);




                string newfile = newFileDirectoryName + idJob + "\\" + Convert.ToString(idJobDocument) + "_" + documentName + ".pdf";


                #region DownloadFileFromDropBox
                path = HttpRuntime.AppDomainAppPath;
                string jobDocumentDirectoryName = System.IO.Path.Combine(path, Convert.ToString(Properties.Settings.Default.JobDocumentExportPath));
                jobDocumentDirectoryName = System.IO.Path.Combine(jobDocumentDirectoryName, Convert.ToString(jobDocument.IdJob));
                string jobDocumentFileName = System.IO.Path.Combine(jobDocumentDirectoryName, jobDocument.Id + "_temp" + jobDocument.DocumentPath);
                var instance = new DropboxIntegration();
                string dropBoxFilePath = Properties.Settings.Default.DropboxFolderPath + Convert.ToString(jobDocument.IdJob);
                string dropBoxFileName = Convert.ToString(jobDocument.Id) + "_" + jobDocument.DocumentPath;

                string sourceFileName = dropBoxFilePath + "/" + dropBoxFileName;

                if (!System.IO.Directory.Exists(newFileDirectoryName + idJob))
                {
                    System.IO.Directory.CreateDirectory(newFileDirectoryName + idJob);
                }

                if (System.IO.File.Exists(oldFilePath))
                {
                    System.IO.File.Delete(oldFilePath);
                }

                if (System.IO.File.Exists(jobDocumentFileName))
                {
                    System.IO.File.Delete(jobDocumentFileName);
                }



                var task = instance.RunDownload(sourceFileName, jobDocumentFileName);

                #endregion

                int numberofPages = 0;
                using (var reader1 = new PdfReader(jobDocumentFileName))
                {
                    numberofPages = reader1.NumberOfPages;
                    var pdfStamper = new PdfStamper(reader1, new System.IO.FileStream(newfile, System.IO.FileMode.Create));

                    // pdfStamper.FormFlattening = false;
                    var field = pdfStamper.AcroFields;
                    string paragraph = string.Empty;

                    foreach (var item in newList)
                    {
                        if (item.Id.Contains(','))
                        {
                            string[] fieldsList = item.Id.Split(',');
                            foreach (var item2 in fieldsList)
                            {
                                field.SetField(item2, string.Empty);
                                field.SetField(item2, !string.IsNullOrEmpty(item.ItemName) ? item.ItemName : string.Empty);
                                field.GenerateAppearances = false;
                            }
                        }
                        else
                        {
                            field.SetField(item.Id, string.Empty);
                            field.SetField(item.Id, !string.IsNullOrEmpty(item.ItemName) ? item.ItemName : string.Empty);
                            field.GenerateAppearances = false;
                        }

                    }
                    field.SetField("txtNumSheets", Convert.ToString(numberofPages - 1));
                    jobDocument.DocumentPath = documentName + ".pdf";
                    rpoContext.SaveChanges();
                    pdfStamper.Close();

                }

                var instance1 = new DropboxIntegration();
                string uploadFilePath = Properties.Settings.Default.DropboxFolderPath + Convert.ToString(jobDocument.IdJob);
                string dropBoxFileName1 = Convert.ToString(jobDocument.Id) + "_" + jobDocument.DocumentPath;
                string filepath = newfile;
                var task1 = instance.RunUpload(uploadFilePath, dropBoxFileName, filepath);

            }
        }
        public static void GenerateEditedJobDocumentForCCD1(int idJobDocument, List<string> pdfFields, List<int> newDocumentFieldId, List<IdItemName> newList)
        {
            /// <summary>
            /// The database.
            /// </summary>
            RpoContext rpoContext = new RpoContext();
            var path = HttpRuntime.AppDomainAppPath;
            string directoryName = string.Empty;
            string newFileDirectoryName = string.Empty;
            string fileName = string.Empty;
            string idJob = string.Empty;
            string documentName = string.Empty;
            JobDocument jobDocument = new JobDocument();

            List<JobDocumentField> jobDocumentField = rpoContext.JobDocumentFields
                    .Include("JobDocument.DocumentMaster")
                    .Include("DocumentField.Field")
                    .Where(x => x.IdJobDocument == idJobDocument).ToList();

            Job job = new Job();

            if (jobDocumentField != null && jobDocumentField.Count > 0)
            {
                fileName = jobDocumentField.Select(x => x.JobDocument.DocumentMaster.Path).FirstOrDefault();
                idJob = jobDocumentField.Select(x => Convert.ToString(x.JobDocument.IdJob)).FirstOrDefault();
                documentName = jobDocumentField.Select(x => x.JobDocument.DocumentMaster.DocumentName).FirstOrDefault();

                jobDocument = rpoContext.JobDocuments.Where(x => x.Id == idJobDocument).FirstOrDefault();

                directoryName = System.IO.Path.Combine(path, Properties.Settings.Default.JobDocumentTemplatePath);
                newFileDirectoryName = System.IO.Path.Combine(path, Properties.Settings.Default.JobDocumentExportPath);

                int JobId = jobDocumentField.Select(x => x.JobDocument.IdJob).FirstOrDefault();

                var pdf_filename = directoryName + fileName;
                PdfReader.unethicalreading = true;



                string folderDirectory = System.IO.Path.Combine(newFileDirectoryName, Convert.ToString(idJob));
                string oldFilePath = System.IO.Path.Combine(folderDirectory, Convert.ToString(idJobDocument) + "_" + jobDocument.DocumentPath);




                string newfile = newFileDirectoryName + idJob + "\\" + Convert.ToString(idJobDocument) + "_" + documentName + ".pdf";


                #region DownloadFileFromDropBox
                path = HttpRuntime.AppDomainAppPath;
                string jobDocumentDirectoryName = System.IO.Path.Combine(path, Convert.ToString(Properties.Settings.Default.JobDocumentExportPath));
                jobDocumentDirectoryName = System.IO.Path.Combine(jobDocumentDirectoryName, Convert.ToString(jobDocument.IdJob));
                string jobDocumentFileName = System.IO.Path.Combine(jobDocumentDirectoryName, jobDocument.Id + "_temp" + jobDocument.DocumentPath);
                var instance = new DropboxIntegration();
                string dropBoxFilePath = Properties.Settings.Default.DropboxFolderPath + Convert.ToString(jobDocument.IdJob);
                string dropBoxFileName = Convert.ToString(jobDocument.Id) + "_" + jobDocument.DocumentPath;

                string sourceFileName = dropBoxFilePath + "/" + dropBoxFileName;

                if (!System.IO.Directory.Exists(newFileDirectoryName + idJob))
                {
                    System.IO.Directory.CreateDirectory(newFileDirectoryName + idJob);
                }

                if (System.IO.File.Exists(oldFilePath))
                {
                    System.IO.File.Delete(oldFilePath);
                }

                if (System.IO.File.Exists(jobDocumentFileName))
                {
                    System.IO.File.Delete(jobDocumentFileName);
                }



                var task = instance.RunDownload(sourceFileName, jobDocumentFileName);

                PdfReader.unethicalreading = true;
                var reader = new PdfReader(jobDocumentFileName);
                string path1 = System.IO.Path.Combine(jobDocumentDirectoryName, jobDocument.Id + jobDocument.DocumentPath);

                var pdfStamper1 = new PdfStamper(reader, new FileStream(path1, FileMode.Create));
                var field1 = pdfStamper1.AcroFields;
                var reader_JobDocument = new PdfReader(jobDocumentFileName);
                int numberofPages = reader_JobDocument.NumberOfPages;

                JobDocument jobDocumentResponse = rpoContext.JobDocuments.Include("DocumentMaster").Include("JobDocumentFields.DocumentField.Field").Include("JobApplication.JobApplicationType.Parent").
                                                   Include("CreatedByEmployee").
                                                   Include("LastModifiedByEmployee")
                                                   .FirstOrDefault(x => x.Id == jobDocument.Id);

                JobDocumentField df = jobDocumentResponse.JobDocumentFields.Where(x => x.DocumentField.PdfFields == "txtName").FirstOrDefault();

                string applicantname = string.Empty;

                if (df != null)
                {
                    applicantname = df.ActualValue;
                }



                field1.SetField("txtPage", Convert.ToString(numberofPages + 1));
                field1.SetField("txtDescription ", string.Empty);
                field1.SetField("txtName", applicantname);
                field1.SetField("txtDate", string.Empty);

                field1.RenameField("txtPage", "Page" + Convert.ToString(numberofPages + 1) + "_txtPage");
                field1.RenameField("txtDescription", "Page" + Convert.ToString(numberofPages + 1) + "_txtDescription");
                field1.RenameField("txtName", "Page" + Convert.ToString(numberofPages + 1) + "_txtName");
                field1.RenameField("txtDate", "Page" + Convert.ToString(numberofPages + 1) + "_txtDate");

                for (int i = 4; i < numberofPages; i++)
                {
                    string pagename = "Page" + Convert.ToString(i) + "_txtName";
                    field1.SetField(pagename, applicantname);
                }

                field1.GenerateAppearances = false;
                pdfStamper1.Close();
                reader.Close();
                reader_JobDocument.Close();


                #endregion

                using (var reader1 = new PdfReader(jobDocumentFileName))
                {
                    var pdfStamper = new PdfStamper(reader1, new System.IO.FileStream(newfile, System.IO.FileMode.Create));
                    // pdfStamper.FormFlattening = false;
                    var field = pdfStamper.AcroFields;
                    string paragraph = string.Empty;

                    foreach (var item in newList)
                    {
                        if (item.Id.Contains(','))
                        {
                            string[] fieldsList = item.Id.Split(',');
                            foreach (var item2 in fieldsList)
                            {
                                field.SetField(item2, string.Empty);
                                field.SetField(item2, !string.IsNullOrEmpty(item.ItemName) ? item.ItemName : string.Empty);
                                field.GenerateAppearances = false;
                            }
                        }
                        else
                        {
                            field.SetField(item.Id, string.Empty);
                            field.SetField(item.Id, !string.IsNullOrEmpty(item.ItemName) ? item.ItemName : string.Empty);
                            field.GenerateAppearances = false;
                        }
                    }

                    for (int i = 4; i <= numberofPages; i++)
                    {
                        string pagename = "Page" + Convert.ToString(i) + "_txtName";
                        field.SetField(pagename, applicantname);
                        field.GenerateAppearances = false;
                    }
                    jobDocument.DocumentPath = documentName + ".pdf";
                    rpoContext.SaveChanges();
                    pdfStamper.Close();

                }

                var instance1 = new DropboxIntegration();
                string uploadFilePath = Properties.Settings.Default.DropboxFolderPath + Convert.ToString(jobDocument.IdJob);
                string dropBoxFileName1 = Convert.ToString(jobDocument.Id) + "_" + jobDocument.DocumentPath;
                string filepath = newfile;
                var task1 = instance.RunUpload(uploadFilePath, dropBoxFileName, filepath);

            }
        }



        public static void GenerateEditedJobDocumentForZRD1(int idJobDocument, List<string> pdfFields, List<int> newDocumentFieldId, List<IdItemName> newList)
        {
            /// <summary>
            /// The database.
            /// </summary>
            RpoContext rpoContext = new RpoContext();
            var path = HttpRuntime.AppDomainAppPath;
            string directoryName = string.Empty;
            string newFileDirectoryName = string.Empty;
            string fileName = string.Empty;
            string idJob = string.Empty;
            string documentName = string.Empty;
            JobDocument jobDocument = new JobDocument();

            List<JobDocumentField> jobDocumentField = rpoContext.JobDocumentFields
                    .Include("JobDocument.DocumentMaster")
                    .Include("DocumentField.Field")
                    .Where(x => x.IdJobDocument == idJobDocument).ToList();

            Job job = new Job();

            if (jobDocumentField != null && jobDocumentField.Count > 0)
            {
                fileName = jobDocumentField.Select(x => x.JobDocument.DocumentMaster.Path).FirstOrDefault();
                idJob = jobDocumentField.Select(x => Convert.ToString(x.JobDocument.IdJob)).FirstOrDefault();
                documentName = jobDocumentField.Select(x => x.JobDocument.DocumentMaster.DocumentName).FirstOrDefault();

                jobDocument = rpoContext.JobDocuments.Where(x => x.Id == idJobDocument).FirstOrDefault();

                directoryName = System.IO.Path.Combine(path, Properties.Settings.Default.JobDocumentTemplatePath);
                newFileDirectoryName = System.IO.Path.Combine(path, Properties.Settings.Default.JobDocumentExportPath);

                int JobId = jobDocumentField.Select(x => x.JobDocument.IdJob).FirstOrDefault();

                var pdf_filename = directoryName + fileName;
                PdfReader.unethicalreading = true;



                string folderDirectory = System.IO.Path.Combine(newFileDirectoryName, Convert.ToString(idJob));
                string oldFilePath = System.IO.Path.Combine(folderDirectory, Convert.ToString(idJobDocument) + "_" + jobDocument.DocumentPath);




                string newfile = newFileDirectoryName + idJob + "\\" + Convert.ToString(idJobDocument) + "_" + documentName + ".pdf";


                #region DownloadFileFromDropBox
                path = HttpRuntime.AppDomainAppPath;
                string jobDocumentDirectoryName = System.IO.Path.Combine(path, Convert.ToString(Properties.Settings.Default.JobDocumentExportPath));
                jobDocumentDirectoryName = System.IO.Path.Combine(jobDocumentDirectoryName, Convert.ToString(jobDocument.IdJob));
                string jobDocumentFileName = System.IO.Path.Combine(jobDocumentDirectoryName, jobDocument.Id + "_temp" + jobDocument.DocumentPath);
                var instance = new DropboxIntegration();
                string dropBoxFilePath = Properties.Settings.Default.DropboxFolderPath + Convert.ToString(jobDocument.IdJob);
                string dropBoxFileName = Convert.ToString(jobDocument.Id) + "_" + jobDocument.DocumentPath;

                string sourceFileName = dropBoxFilePath + "/" + dropBoxFileName;

                if (!System.IO.Directory.Exists(newFileDirectoryName + idJob))
                {
                    System.IO.Directory.CreateDirectory(newFileDirectoryName + idJob);
                }

                if (System.IO.File.Exists(oldFilePath))
                {
                    System.IO.File.Delete(oldFilePath);
                }

                if (System.IO.File.Exists(jobDocumentFileName))
                {
                    System.IO.File.Delete(jobDocumentFileName);
                }



                var task = instance.RunDownload(sourceFileName, jobDocumentFileName);

                PdfReader.unethicalreading = true;
                var reader = new PdfReader(jobDocumentFileName);
                string path1 = System.IO.Path.Combine(jobDocumentDirectoryName, jobDocument.Id + jobDocument.DocumentPath);

                var pdfStamper1 = new PdfStamper(reader, new FileStream(path1, FileMode.Create));
                var field1 = pdfStamper1.AcroFields;
                var reader_JobDocument = new PdfReader(jobDocumentFileName);
                int numberofPages = reader_JobDocument.NumberOfPages;

                JobDocument jobDocumentResponse = rpoContext.JobDocuments.Include("DocumentMaster").Include("JobDocumentFields.DocumentField.Field").Include("JobApplication.JobApplicationType.Parent").
                                                   Include("CreatedByEmployee").
                                                   Include("LastModifiedByEmployee")
                                                   .FirstOrDefault(x => x.Id == jobDocument.Id);

                JobDocumentField df = jobDocumentResponse.JobDocumentFields.Where(x => x.DocumentField.PdfFields == "txtName").FirstOrDefault();

                field1.SetField("txtPage", Convert.ToString(numberofPages + 1));
                field1.SetField("txtDescription", string.Empty);

                string applicantname = string.Empty;

                if (df != null)
                {
                    applicantname = df.ActualValue;
                }



                field1.SetField("txtName", applicantname);
                field1.SetField("txtDate", string.Empty);

                field1.RenameField("txtPage", "Page" + Convert.ToString(numberofPages + 1) + "_txtPage");
                field1.RenameField("txtDescription", "Page" + Convert.ToString(numberofPages + 1) + "_txtDescription");
                field1.RenameField("txtName", "Page" + Convert.ToString(numberofPages + 1) + "_txtName");
                field1.RenameField("txtDate", "Page" + Convert.ToString(numberofPages + 1) + "_txtDate");


                field1.GenerateAppearances = false;
                pdfStamper1.Close();
                reader.Close();
                reader_JobDocument.Close();


                #endregion

                using (var reader1 = new PdfReader(jobDocumentFileName))
                {
                    var pdfStamper = new PdfStamper(reader1, new System.IO.FileStream(newfile, System.IO.FileMode.Create));
                    // pdfStamper.FormFlattening = false;
                    var field = pdfStamper.AcroFields;
                    string paragraph = string.Empty;

                    foreach (var item in newList)
                    {
                        if (item.Id.Contains(','))
                        {
                            string[] fieldsList = item.Id.Split(',');
                            foreach (var item2 in fieldsList)
                            {
                                field.SetField(item2, string.Empty);
                                field.SetField(item2, !string.IsNullOrEmpty(item.ItemName) ? item.ItemName : string.Empty);
                                field.GenerateAppearances = false;
                            }
                        }
                        else
                        {
                            field.SetField(item.Id, string.Empty);
                            field.SetField(item.Id, !string.IsNullOrEmpty(item.ItemName) ? item.ItemName : string.Empty);
                            field.GenerateAppearances = false;
                        }
                    }

                    for (int i = 4; i <= numberofPages; i++)
                    {
                        string pagename = "Page" + Convert.ToString(i) + "_txtName";
                        field.SetField(pagename, applicantname);
                        field.GenerateAppearances = false;
                    }
                    jobDocument.DocumentPath = documentName + ".pdf";
                    rpoContext.SaveChanges();
                    pdfStamper.Close();

                }

                var instance1 = new DropboxIntegration();
                string uploadFilePath = Properties.Settings.Default.DropboxFolderPath + Convert.ToString(jobDocument.IdJob);
                string dropBoxFileName1 = Convert.ToString(jobDocument.Id) + "_" + jobDocument.DocumentPath;
                string filepath = newfile;
                var task1 = instance.RunUpload(uploadFilePath, dropBoxFileName, filepath);

            }
        }

        /// Generates the support document for ten days notice.
        /// </summary>
        /// <param name="idJobDocument">The identifier job document.</param>
        /// <param name="idJob">The identifier job.</param>
        /// <param name="idDocument">The identifier document.</param>
        /// <param name="employee">The employee.</param>
        public static void GenerateSupportDocumentForTenDaysNotice(int idJobDocument, int idJob, int idemployee, string documentName, int? idJobapplication, string recipient)
        {
            RpoContext rpoContext = new RpoContext();
            int idDocument = Document.TenDayNoticeScannedSigned.GetHashCode();
            DocumentMaster documentMaster = rpoContext.DocumentMasters.FirstOrDefault(x => x.Id == idDocument);
            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.IdParent == idJobDocument);

            if (jobDocument == null)
            {
                jobDocument = new JobDocument
                {
                    IdJob = idJob,
                    IdDocument = idDocument,
                    DocumentName = documentMaster.DocumentName,
                    DocumentDescription = documentName,
                    IsArchived = false,
                    IdParent = idJobDocument,
                    IdJobApplication = idJobapplication != null ? Convert.ToInt32(idJobapplication) : 0
                };
                jobDocument.CreatedDate = DateTime.UtcNow;
                jobDocument.LastModifiedDate = DateTime.UtcNow;
                jobDocument.CreatedBy = idemployee;
                jobDocument.LastModifiedBy = idemployee;

                rpoContext.JobDocuments.Add(jobDocument);
                rpoContext.SaveChanges();

                var documentFieldList = rpoContext.DocumentFields.Include("Field").Where(x => x.IdDocument == idDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

                foreach (var item in documentFieldList)
                {
                    if (item.Field.FieldName == "10 Day Notice")
                    {


                        JobDocumentField JobDocumentField = new JobDocumentField
                        {
                            IdJobDocument = jobDocument.Id,
                            IdDocumentField = item.Id,
                            Value = recipient,
                            ActualValue = recipient
                        };
                        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        rpoContext.SaveChanges();
                    }
                    else
                    {
                        JobDocumentField JobDocumentField = new JobDocumentField
                        {
                            IdJobDocument = jobDocument.Id,
                            IdDocumentField = item.Id,
                            Value = recipient,
                            ActualValue = recipient
                        };
                        rpoContext.JobDocumentFields.Add(JobDocumentField);
                        rpoContext.SaveChanges();
                    }
                }
            }
            else
            {
                jobDocument.DocumentDescription = documentName;
                jobDocument.LastModifiedDate = DateTime.UtcNow;
                jobDocument.LastModifiedBy = idemployee;
                rpoContext.SaveChanges();
            }
        }


        private static string Ordinal(int number)
        {
            const string TH = "th";
            var s = number.ToString();

            number %= 100;

            if ((number >= 11) && (number <= 13))
            {
                return s + TH;
            }

            switch (number % 10)
            {
                case 1:
                    return s + "st";
                case 2:
                    return s + "nd";
                case 3:
                    return s + "rd";
                default:
                    return s + TH;
            }
        }

        public static void GenerateCommonNewDocument(int idJobDocument, JobDocumentCreateOrUpdateDTO jobDocumentCreateOrUpdateDTO)
        {
            RpoContext rpoContext = new RpoContext();
            var documentFieldList = rpoContext.DocumentFields.
                Include("Field").Where(x => x.IdDocument == jobDocumentCreateOrUpdateDTO.IdDocument).OrderByDescending(x => x.Field.IsDisplayInFrontend).ThenBy(x => x.DisplayOrder).ToList();

            string documentName = string.Empty;
            var jobDocumentFieldList = rpoContext.JobDocumentFields.
                 Where(x => x.IdJobDocument == idJobDocument).ToList();

            JobDocument jobDocument = rpoContext.JobDocuments.FirstOrDefault(x => x.Id == idJobDocument);
            string documentDescription = string.Empty;
            string jobDocumentFor = string.Empty;

            if (documentFieldList != null && documentFieldList.Count > 0)
            {
                foreach (DocumentField item in documentFieldList)
                {
                    var frontendFields = jobDocumentCreateOrUpdateDTO.JobDocumentFields.FirstOrDefault(x => x.IdDocumentField == item.Id);
                    if (frontendFields == null)
                    {
                    }
                    else
                    {
                        if (item.Field.FieldName == "Application Type")
                        {
                            int idJobApplication = frontendFields.Value != null ? Convert.ToInt32(frontendFields.Value) : 0;
                            JobApplication jobApplication = rpoContext.JobApplications.Where(x => x.Id == idJobApplication).FirstOrDefault();
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = idJobApplication != 0 ? Convert.ToString(idJobApplication) : null,
                                    ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = idJobApplication != 0 ? Convert.ToString(idJobApplication) : null;
                                updateJobDocumentField.ActualValue = jobApplication != null ? jobApplication.ApplicationNumber : string.Empty;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "For")
                        {
                            jobDocumentFor = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }

                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else if (item.Field.FieldName == "Additional Description")
                        {
                            documentDescription = frontendFields.Value;
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                        else
                        {
                            JobDocumentField updateJobDocumentField = jobDocumentFieldList.FirstOrDefault(x => x.IdDocumentField == item.Id);
                            if (updateJobDocumentField == null)
                            {
                                JobDocumentField JobDocumentField = new JobDocumentField
                                {
                                    IdJobDocument = idJobDocument,
                                    IdDocumentField = frontendFields.IdDocumentField,
                                    Value = frontendFields.Value,
                                    ActualValue = frontendFields.Value
                                };
                                rpoContext.JobDocumentFields.Add(JobDocumentField);
                                rpoContext.SaveChanges();
                            }
                            else
                            {
                                updateJobDocumentField.Value = frontendFields.Value;
                                updateJobDocumentField.ActualValue = frontendFields.Value;
                                rpoContext.Entry(updateJobDocumentField).State = EntityState.Modified;
                                rpoContext.SaveChanges();
                            }
                        }
                    }

                }
                jobDocument.DocumentDescription = documentDescription;
                jobDocument.JobDocumentFor = jobDocumentFor;
                rpoContext.SaveChanges();
            }
        }

    }

    public class ApplicationsDetails
    {
        public string ApplicationNumber { get; set; }
        public string OnStreet { get; set; }
        public string CrossStreet1 { get; set; }
        public string CrossStreet2 { get; set; }
        public string LinearFeet { get; set; }
        public string StartDate { get; set; }
        public string EndDate { get; set; }
    }
}